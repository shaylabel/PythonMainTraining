2021-06-06 12:44:42,155 - INFO - Calling modeler on-new-snapshot for timestamp 1622972681992 ...
2021-06-06 12:44:42,357 - INFO - Calling analyzer for timestamp 1622972681992 ...
2021-06-06 12:44:45,700 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:44:45,700 - INFO - Finished triggering everything for timestamp 1622972681992 after 3.65 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_classified', 0.06), ('modeler', 0.2), ('analyzer', 3.31)]
2021-06-06 12:44:45,856 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:41:20Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:20Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-03f9a1acea8729b3d', 'routeTableId': 'rtb-0c30833a924816bb1'}, 'responseElements': {'requestId': 'f063f148-63cc-474b-b551-1a04cbc01d7e', 'newAssociationId': 'rtbassoc-0562bb1814fa743df', 'associationState': {'state': 'associated'}}, 'requestID': 'f063f148-63cc-474b-b551-1a04cbc01d7e', 'eventID': '1ba213f4-9180-4dae-9e3b-c2a973ff977e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:44:45,857 - INFO - hard-modify route_table - 
2021-06-06 12:44:45,883 - INFO - Got 0 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-0c30833a924816bb1$'}]
2021-06-06 12:44:45,883 - WARNING - nothing to scan for dependent scan {'resource': 'route_table', 'depends_on': [{'resource': 'route_table', 'attr': 'VpcId', 'inventory_attr': 'RouteTableId', 'attr_location': ['requestParameters', 'routeTableId']}]}
2021-06-06 12:44:45,912 - INFO - Get previous translated snapshot with timestamp 1622972681992 took 0.03 seconds
2021-06-06 12:44:45,916 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:44:45,916 - WARNING - Failed to handle message: tried to modify an old resource rtb-0c30833a924816bb1, but it doesn't exist.
2021-06-06 12:44:45,916 - INFO - adding message to failed events queue for retry
2021-06-06 12:44:46,065 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:40:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:40:56Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'def6324e-588d-446e-a73b-8bab42c031f0', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': '46e40562-5157-4eca-bfd0-7eeaa2f0817d', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:44:46,215 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:25Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:25Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': '8BBBB58A-A606-408B-A80B-ADF5AE8F62B7', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0287cc9b768b52519', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {'name': 'test_profile'}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_2'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '4429a918-7495-43c0-992a-659bf6889162', 'reservationId': 'r-0fabf2d8be8e2c664', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-006dab3da6b657b68', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-10-10-186.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972485000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-0794a2e17f9656258', 'vpcId': 'vpc-0f057794b5da52459', 'privateIpAddress': '10.10.10.186', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_2'}]}, 'clientToken': '8BBBB58A-A606-408B-A80B-ADF5AE8F62B7', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0287cc9b768b52519', 'subnetId': 'subnet-0794a2e17f9656258', 'vpcId': 'vpc-0f057794b5da52459', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:48:f9:35:4e:dd', 'privateIpAddress': '10.10.10.186', 'privateDnsName': 'ip-10-10-10-186.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'attachment': {'attachmentId': 'eni-attach-0737d56640d9e907e', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972485000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.10.186', 'privateDnsName': 'ip-10-10-10-186.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'id': 'AIPASBANKG2P7LQVS7PFV'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '4429a918-7495-43c0-992a-659bf6889162', 'eventID': '7f2e5d39-4b52-4ce8-bc56-ceaaaa52a68b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:44:46,230 - INFO - create instance - [{'PrivateIpAddress': '10.10.10.186', 'SourceDestCheck': True, 'InstanceId': 'i-006dab3da6b657b68', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-0794a2e17f9656258', 'VpcId': 'vpc-0f057794b5da52459', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_2', 'resource_id': 'i-006dab3da6b657b68..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-006dab3da6b657b68'}]
2021-06-06 12:44:46,230 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-006dab3da6b657b68']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:44:47,047 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0287cc9b768b52519', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.186', 'DnsName': 'ip-10-10-10-186.ec2.internal', 'MacAddress': '12:48:f9:35:4e:dd', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-006dab3da6b657b68', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0737d56640d9e907e', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.186', 'NetworkInterfaceId': 'eni-0287cc9b768b52519', 'resource_id': 'eni-0287cc9b768b52519..10.10.10.186'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_2', 'resource_id': 'eni-0287cc9b768b52519..Name'}], 'resource_id': 'eni-0287cc9b768b52519'}]}
2021-06-06 12:44:47,047 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0af2498b5cbd583f6']}]}}}
2021-06-06 12:44:47,868 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]}
2021-06-06 12:44:47,868 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-006dab3da6b657b68']}]}}}
2021-06-06 12:44:48,831 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-08493377ced3fefdd', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-006dab3da6b657b68', 'volume_attachment': [{'InstanceId': 'i-006dab3da6b657b68', 'VolumeId': 'vol-08493377ced3fefdd', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-08493377ced3fefdd..i-006dab3da6b657b68'}], 'resource_id': 'vol-08493377ced3fefdd'}]}
2021-06-06 12:44:48,861 - INFO - Get previous translated snapshot with timestamp 1622972681992 took 0.03 seconds
2021-06-06 12:44:48,874 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-0af2498b5cbd583f6', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}]} 
2021-06-06 12:44:48,879 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.10.10.186', 'SourceDestCheck': True, 'InstanceId': 'i-006dab3da6b657b68', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-0794a2e17f9656258', 'VpcId': 'vpc-0f057794b5da52459', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_2', 'resource_id': 'i-006dab3da6b657b68..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-006dab3da6b657b68'}], 'instance_volume': [{'VolumeId': 'vol-08493377ced3fefdd', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-006dab3da6b657b68', 'volume_attachment': [{'InstanceId': 'i-006dab3da6b657b68', 'VolumeId': 'vol-08493377ced3fefdd', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-08493377ced3fefdd..i-006dab3da6b657b68'}], 'resource_id': 'vol-08493377ced3fefdd'}]}, 'modified': {'network_interface': [{'AvailabilityZone': 'us-east-1a', 'DnsName': 'ip-10-10-10-186.ec2.internal', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InterfaceType': 'interface', 'MacAddress': '12:48:f9:35:4e:dd', 'NetworkInterfaceId': 'eni-0287cc9b768b52519', 'PrivateIpAddress': '10.10.10.186', 'SourceDestCheck': True, 'SubnetId': 'subnet-0794a2e17f9656258', 'VpcId': 'vpc-0f057794b5da52459', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.186', 'NetworkInterfaceId': 'eni-0287cc9b768b52519', 'resource_id': 'eni-0287cc9b768b52519..10.10.10.186'}], 'resource_id': 'eni-0287cc9b768b52519', 'tag': [{'Key': 'Name', 'Value': 'test_interface_2', 'resource_id': 'eni-0287cc9b768b52519..Name'}], 'InstanceId': 'i-006dab3da6b657b68', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0737d56640d9e907e'}]}, 'deleted': {}}}, 'previous_timestamp': 1622972681992}
2021-06-06 12:44:48,976 - INFO - Calling modeler on-new-snapshot for timestamp 1622972688831 ...
2021-06-06 12:44:49,487 - INFO - Calling analyzer for timestamp 1622972688831 ...
2021-06-06 12:44:54,573 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:44:54,573 - INFO - Finished triggering everything for timestamp 1622972688831 after 5.69 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.04), ('modeler', 0.51), ('analyzer', 5.07)]
2021-06-06 12:44:54,796 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:33.485Z, account_id: N/A, extra:{'instance-id': 'i-08e91318bdb27a3b4', 'state': 'pending'}
2021-06-06 12:44:54,958 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:41:31Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:31Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-09170f6d9bb9d8891', 'routeTableId': 'rtb-0093bf31ff3817ec1'}, 'responseElements': {'requestId': '3d63a65e-d8fa-40c7-b4d0-7f2d03d2ac59', 'newAssociationId': 'rtbassoc-02093f6858138b75c', 'associationState': {'state': 'associated'}}, 'requestID': '3d63a65e-d8fa-40c7-b4d0-7f2d03d2ac59', 'eventID': '727fd8b1-bed1-4159-ac5f-a6d787177eeb', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:44:54,958 - INFO - hard-modify route_table - 
2021-06-06 12:44:54,980 - INFO - Got 1 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-0093bf31ff3817ec1$'}]
2021-06-06 12:44:54,980 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-0bf1ce99828ae9cd2']}]}}}
2021-06-06 12:44:55,728 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-057150c434716027d', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.30.0.0/16', 'resource_id': 'rtb-057150c434716027d..10.30.0.0/16'}], 'resource_id': 'rtb-057150c434716027d'}, {'RouteTableId': 'rtb-0093bf31ff3817ec1', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.30.0.0/16', 'resource_id': 'rtb-0093bf31ff3817ec1..10.30.0.0/16'}, {'GatewayId': 'igw-0fdad6471fc678eec', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0093bf31ff3817ec1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0093bf31ff3817ec1', 'AssociationId': 'rtbassoc-02093f6858138b75c', 'Main': True, 'resource_id': 'rtb-0093bf31ff3817ec1..rtbassoc-02093f6858138b75c'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_3', 'resource_id': 'rtb-0093bf31ff3817ec1..Name'}], 'resource_id': 'rtb-0093bf31ff3817ec1'}]}
2021-06-06 12:44:55,750 - INFO - Get previous translated snapshot with timestamp 1622972688831 took 0.02 seconds
2021-06-06 12:44:55,754 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-0093bf31ff3817ec1', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'resource_id': 'rtb-0093bf31ff3817ec1', 'route': [{'DestinationCidrBlock': '10.30.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0093bf31ff3817ec1..10.30.0.0/16'}, {'DestinationCidrBlock': '0.0.0.0/0', 'GatewayId': 'igw-0fdad6471fc678eec', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0093bf31ff3817ec1..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-02093f6858138b75c', 'Main': True, 'RouteTableId': 'rtb-0093bf31ff3817ec1', 'resource_id': 'rtb-0093bf31ff3817ec1..rtbassoc-02093f6858138b75c'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_3', 'resource_id': 'rtb-0093bf31ff3817ec1..Name'}]} 
2021-06-06 12:44:55,754 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'route_table': [{'RouteTableId': 'rtb-057150c434716027d', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.30.0.0/16', 'resource_id': 'rtb-057150c434716027d..10.30.0.0/16'}], 'resource_id': 'rtb-057150c434716027d'}]}, 'deleted': {}}}, 'previous_timestamp': 1622972688831}
2021-06-06 12:44:55,829 - INFO - Calling modeler on-new-snapshot for timestamp 1622972695728 ...
2021-06-06 12:44:56,026 - INFO - Calling analyzer for timestamp 1622972695728 ...
2021-06-06 12:44:59,342 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:44:59,342 - INFO - Finished triggering everything for timestamp 1622972695728 after 3.58 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.2), ('analyzer', 3.29)]
2021-06-06 12:44:59,509 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:33Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:33Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': '82FA9677-4FD9-4DE7-9BD3-1B270E5CFF7E', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-07f52585a76316c2c', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_3'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': 'ad4b7d0a-ec64-4607-8b5c-93b734e42227', 'reservationId': 'r-0ba43d512777eab7e', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-08e91318bdb27a3b4', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-20-10-212.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972493000, 'placement': {'availabilityZone': 'us-east-1b', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-055d8dde7349f9bf0', 'vpcId': 'vpc-0a880421f072a8186', 'privateIpAddress': '10.20.10.212', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_3'}]}, 'clientToken': '82FA9677-4FD9-4DE7-9BD3-1B270E5CFF7E', 'groupSet': {'items': [{'groupId': 'sg-0de1fb53a270d5776'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-07f52585a76316c2c', 'subnetId': 'subnet-055d8dde7349f9bf0', 'vpcId': 'vpc-0a880421f072a8186', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '0a:14:c6:4c:af:f1', 'privateIpAddress': '10.20.10.212', 'privateDnsName': 'ip-10-20-10-212.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0de1fb53a270d5776'}]}, 'attachment': {'attachmentId': 'eni-attach-075feccf19b32927c', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972493000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.10.212', 'privateDnsName': 'ip-10-20-10-212.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': 'ad4b7d0a-ec64-4607-8b5c-93b734e42227', 'eventID': '3dea7b8e-3746-4b8c-bab6-354b362adfdd', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:44:59,510 - INFO - create instance - [{'PrivateIpAddress': '10.20.10.212', 'SourceDestCheck': True, 'InstanceId': 'i-08e91318bdb27a3b4', 'State': 'pending', 'SubnetId': 'subnet-055d8dde7349f9bf0', 'VpcId': 'vpc-0a880421f072a8186', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_3', 'resource_id': 'i-08e91318bdb27a3b4..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-08e91318bdb27a3b4'}]
2021-06-06 12:44:59,519 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-08e91318bdb27a3b4']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:45:00,389 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'VpcId': 'vpc-0a880421f072a8186', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-055d8dde7349f9bf0', 'PrivateIpAddress': '10.20.10.212', 'DnsName': 'ip-10-20-10-212.ec2.internal', 'MacAddress': '0a:14:c6:4c:af:f1', 'GroupId': ['sg-0de1fb53a270d5776'], 'InstanceId': 'i-08e91318bdb27a3b4', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-075feccf19b32927c', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.10.212', 'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'resource_id': 'eni-07f52585a76316c2c..10.20.10.212'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_3', 'resource_id': 'eni-07f52585a76316c2c..Name'}], 'resource_id': 'eni-07f52585a76316c2c'}]}
2021-06-06 12:45:00,389 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0de1fb53a270d5776']}]}}}
2021-06-06 12:45:01,758 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0de1fb53a270d5776', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-0a880421f072a8186', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0de1fb53a270d5776..Name'}], 'resource_id': 'sg-0de1fb53a270d5776'}]}
2021-06-06 12:45:01,758 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-08e91318bdb27a3b4']}]}}}
2021-06-06 12:45:02,777 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-0e637c77eb78e50b9', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1b', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-08e91318bdb27a3b4', 'volume_attachment': [{'InstanceId': 'i-08e91318bdb27a3b4', 'VolumeId': 'vol-0e637c77eb78e50b9', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0e637c77eb78e50b9..i-08e91318bdb27a3b4'}], 'resource_id': 'vol-0e637c77eb78e50b9'}]}
2021-06-06 12:45:02,808 - INFO - Get previous translated snapshot with timestamp 1622972695728 took 0.03 seconds
2021-06-06 12:45:02,818 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0de1fb53a270d5776', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'sg-0de1fb53a270d5776', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0de1fb53a270d5776..Name'}]} 
2021-06-06 12:45:02,820 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.20.10.212', 'SourceDestCheck': True, 'InstanceId': 'i-08e91318bdb27a3b4', 'State': 'pending', 'SubnetId': 'subnet-055d8dde7349f9bf0', 'VpcId': 'vpc-0a880421f072a8186', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_3', 'resource_id': 'i-08e91318bdb27a3b4..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-08e91318bdb27a3b4'}], 'instance_volume': [{'VolumeId': 'vol-0e637c77eb78e50b9', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1b', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-08e91318bdb27a3b4', 'volume_attachment': [{'InstanceId': 'i-08e91318bdb27a3b4', 'VolumeId': 'vol-0e637c77eb78e50b9', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0e637c77eb78e50b9..i-08e91318bdb27a3b4'}], 'resource_id': 'vol-0e637c77eb78e50b9'}], 'network_interface': [{'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'VpcId': 'vpc-0a880421f072a8186', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-055d8dde7349f9bf0', 'PrivateIpAddress': '10.20.10.212', 'DnsName': 'ip-10-20-10-212.ec2.internal', 'MacAddress': '0a:14:c6:4c:af:f1', 'GroupId': ['sg-0de1fb53a270d5776'], 'InstanceId': 'i-08e91318bdb27a3b4', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-075feccf19b32927c', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.10.212', 'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'resource_id': 'eni-07f52585a76316c2c..10.20.10.212'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_3', 'resource_id': 'eni-07f52585a76316c2c..Name'}], 'resource_id': 'eni-07f52585a76316c2c'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972695728}
2021-06-06 12:45:02,923 - INFO - Calling modeler on-new-snapshot for timestamp 1622972702777 ...
2021-06-06 12:45:03,474 - INFO - Calling analyzer for timestamp 1622972702777 ...
2021-06-06 12:45:07,563 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:07,563 - INFO - Finished triggering everything for timestamp 1622972702777 after 4.73 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('store_ct_event', 0.03), ('modeler', 0.55), ('analyzer', 4.07)]
2021-06-06 12:45:07,719 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:40.246Z, account_id: N/A, extra:{'instance-id': 'i-064cdc1e76e796802', 'state': 'pending'}
2021-06-06 12:45:07,871 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:45.774Z, account_id: N/A, extra:{'instance-id': 'i-0c07e959d87683383', 'state': 'pending'}
2021-06-06 12:45:08,817 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:49.977Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': 'ef294dff-26a6-4939-8ab3-61030cfcaac6'}
2021-06-06 12:45:08,977 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:50.719Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': '909eff31-5698-4bf1-b34d-414a4693beca'}
2021-06-06 12:45:09,286 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:49Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:49Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': '7d910572-ce18-42cd-9fb1-7c7825a7b657', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': '4e152644-21ce-4003-bfbd-0d90311fa646', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:45:09,444 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ApplySecurityGroupsToLoadBalancer in us-east-1 at 2021-06-06T09:42:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:02Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ApplySecurityGroupsToLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'securityGroups': ['sg-0af2498b5cbd583f6'], 'loadBalancerName': 'test-elb-2796885'}, 'responseElements': {'securityGroups': ['sg-0af2498b5cbd583f6']}, 'requestID': '9d437b10-89eb-4741-9bc6-b65707cac512', 'eventID': '73a95bf6-5e30-4b93-a361-b9851e515098', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:09,445 - INFO - hard-modify elb - 
2021-06-06 12:45:09,446 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:45:10,538 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:45:10,561 - INFO - Get previous translated snapshot with timestamp 1622972702777 took 0.02 seconds
2021-06-06 12:45:10,564 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:45:10,564 - WARNING - Failed to handle message: tried to modify an old resource test-elb-2796885-957413492.us-east-1.elb.amazonaws.com, but it doesn't exist.
2021-06-06 12:45:10,564 - INFO - adding message to failed events queue for retry
2021-06-06 12:45:10,718 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:42:03.818Z, account_id: N/A, extra:{'instance-id': 'i-064cdc1e76e796802', 'state': 'running'}
2021-06-06 12:45:10,868 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:42:12.979Z, account_id: N/A, extra:{'instance-id': 'i-0c07e959d87683383', 'state': 'running'}
2021-06-06 12:45:11,022 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:42:10Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:42:10Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:42:10Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-0794a2e17f9656258', 'description': 'ELB test-elb-2796885', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'ipv6AddressCount': 0}, 'responseElements': {'requestId': '39526b2b-099b-4565-a2bc-ff5649640b90', 'networkInterface': {'networkInterfaceId': 'eni-010e3367090ad550e', 'subnetId': 'subnet-0794a2e17f9656258', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1a', 'description': 'ELB test-elb-2796885', 'ownerId': '139614369439', 'requesterId': 'amazon-elb', 'requesterManaged': True, 'status': 'pending', 'macAddress': '12:50:b9:c8:9a:af', 'privateIpAddress': '10.10.10.252', 'privateDnsName': 'ip-10-10-10-252.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.10.252', 'privateDnsName': 'ip-10-10-10-252.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': '39526b2b-099b-4565-a2bc-ff5649640b90', 'eventID': 'faefc62a-592c-433f-ac01-63f854fa720b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:11,026 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-010e3367090ad550e', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.252', 'MacAddress': '12:50:b9:c8:9a:af', 'GroupId': ['sg-0af2498b5cbd583f6'], 'Description': 'ELB test-elb-2796885', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-010e3367090ad550e'}]
2021-06-06 12:45:11,026 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-010e3367090ad550e']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:45:11,822 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-010e3367090ad550e', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.252', 'DnsName': 'ip-10-10-10-252.ec2.internal', 'MacAddress': '12:50:b9:c8:9a:af', 'PublicIpAddress': '52.6.42.225', 'PublicDnsName': 'ec2-52-6-42-225.compute-1.amazonaws.com', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-005cdad935f946465', 'Description': 'ELB test-elb-2796885', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.252', 'NetworkInterfaceId': 'eni-010e3367090ad550e', 'resource_id': 'eni-010e3367090ad550e..10.10.10.252'}], 'resource_id': 'eni-010e3367090ad550e'}]}
2021-06-06 12:45:11,848 - INFO - Get previous translated snapshot with timestamp 1622972702777 took 0.03 seconds
2021-06-06 12:45:11,853 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-010e3367090ad550e', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.252', 'DnsName': 'ip-10-10-10-252.ec2.internal', 'MacAddress': '12:50:b9:c8:9a:af', 'PublicIpAddress': '52.6.42.225', 'PublicDnsName': 'ec2-52-6-42-225.compute-1.amazonaws.com', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-005cdad935f946465', 'Description': 'ELB test-elb-2796885', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.252', 'NetworkInterfaceId': 'eni-010e3367090ad550e', 'resource_id': 'eni-010e3367090ad550e..10.10.10.252'}], 'resource_id': 'eni-010e3367090ad550e'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972702777}
2021-06-06 12:45:11,926 - INFO - Calling modeler on-new-snapshot for timestamp 1622972711823 ...
2021-06-06 12:45:11,948 - INFO - Calling analyzer for timestamp 1622972711823 ...
2021-06-06 12:45:15,851 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:15,852 - INFO - Finished triggering everything for timestamp 1622972711823 after 3.99 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 3.88)]
2021-06-06 12:45:16,039 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:42:25.714Z, account_id: N/A, extra:{'instance-id': 'i-0459367d7e3bc3ba4', 'state': 'running'}
2021-06-06 12:45:16,189 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:43:33.540Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 6, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:35.373Z', 'registeredAt': '2021-06-06T09:40:32.186Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:45:16,928 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:38:59Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:59Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.50.0/24', 'availabilityZone': 'us-east-1f', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_nlb_2'}]}]}}, 'responseElements': {'requestId': '121a6f06-cff6-4982-ad40-311a55748663', 'subnet': {'subnetId': 'subnet-09fb08ae68c943ff9', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-09fb08ae68c943ff9', 'state': 'available', 'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.50.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1f', 'availabilityZoneId': 'use1-az5', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_nlb_2'}]}}}, 'requestID': '121a6f06-cff6-4982-ad40-311a55748663', 'eventID': 'de87482b-ba4a-4ae5-bb25-938e13f502da', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:16,928 - INFO - create subnet - [{'SubnetId': 'subnet-09fb08ae68c943ff9', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.50.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nlb_2', 'resource_id': 'subnet-09fb08ae68c943ff9..Name'}], 'resource_id': 'subnet-09fb08ae68c943ff9'}]
2021-06-06 12:45:16,928 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-09fb08ae68c943ff9']}]}}}
2021-06-06 12:45:18,247 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-236fae02', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'SubnetId': 'subnet-0e4cc63b267655ade', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-51824270', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'SubnetId': 'subnet-083e75a9da33deaec', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-bffb3b9e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'SubnetId': 'subnet-0fd7e25c7d54404b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-ac18d88d', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'SubnetId': 'subnet-0794a2e17f9656258', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-f9af6fd8', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'SubnetId': 'subnet-08d92349b40b0d5aa', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-65e42444', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'SubnetId': 'subnet-0fe138ba19046bb30', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-96f838b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'SubnetId': 'subnet-09fb08ae68c943ff9', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-cf11d1ee', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'SubnetId': 'subnet-0ed5e44884919419e', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-8e73b2af', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'resource_id': 'acl-087062b72f2321f96'}]}
2021-06-06 12:45:18,287 - INFO - Get previous translated snapshot with timestamp 1622972711823 took 0.04 seconds
2021-06-06 12:45:18,300 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'acl_association': [{'AssociationId': 'aclassoc-236fae02', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0b2f8d86c67729f1a', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'AssociationId': 'aclassoc-51824270', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0e4cc63b267655ade', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'AssociationId': 'aclassoc-bffb3b9e', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-083e75a9da33deaec', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'AssociationId': 'aclassoc-ac18d88d', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'AssociationId': 'aclassoc-f9af6fd8', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0794a2e17f9656258', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'AssociationId': 'aclassoc-65e42444', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'AssociationId': 'aclassoc-96f838b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fe138ba19046bb30', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'AssociationId': 'aclassoc-cf11d1ee', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'AssociationId': 'aclassoc-8e73b2af', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0ed5e44884919419e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'resource_id': 'acl-087062b72f2321f96'} 
2021-06-06 12:45:18,302 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-09fb08ae68c943ff9', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.50.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nlb_2', 'resource_id': 'subnet-09fb08ae68c943ff9..Name'}], 'resource_id': 'subnet-09fb08ae68c943ff9'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972711823}
2021-06-06 12:45:18,387 - INFO - Calling modeler on-new-snapshot for timestamp 1622972718248 ...
2021-06-06 12:45:18,958 - INFO - Calling analyzer for timestamp 1622972718248 ...
2021-06-06 12:45:22,532 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:22,532 - INFO - Finished triggering everything for timestamp 1622972718248 after 4.22 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.02), ('store_trans', 0.03), ('modeler', 0.57), ('analyzer', 3.55)]
2021-06-06 12:45:22,740 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:05.971Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 1.0, 'tags': {'Name': 'test_subnet_2'}}
2021-06-06 12:45:22,937 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:07.245Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'internet-gateway', 'version': 1.0, 'tags': {'Name': 'test_gw_3'}}
2021-06-06 12:45:23,097 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupIngress in us-east-1 at 2021-06-06T09:39:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupIngress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-08eb478817b54e9c3', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '0492d8fe-61c4-4b4d-a286-6a4afba3759c', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-08eb478817b54e9c3', 'securityGroupRuleId': 'sgr-0fe3afca4c22744f8', 'isEgress': False, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': '0492d8fe-61c4-4b4d-a286-6a4afba3759c', 'eventID': '90676f37-eb1c-4a2c-af9d-19012e14555c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:23,097 - INFO - modify security_group - [{'GroupId': 'sg-08eb478817b54e9c3', 'security_ingress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [{}], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..0..0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'DestinationGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3__egress_rule'}], 'resource_id': 'sg-08eb478817b54e9c3'}]
2021-06-06 12:45:23,097 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08eb478817b54e9c3']}]}}}
2021-06-06 12:45:24,247 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]}
2021-06-06 12:45:24,273 - INFO - Get previous translated snapshot with timestamp 1622972718248 took 0.03 seconds
2021-06-06 12:45:24,277 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:45:24,277 - WARNING - Failed to handle message: tried to modify an old resource sg-08eb478817b54e9c3, but it doesn't exist.
2021-06-06 12:45:24,277 - INFO - adding message to failed events queue for retry
2021-06-06 12:45:24,427 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:09.265Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc-endpoint', 'version': 1.0, 'tags': {'Name': 'test_vpc_endpoint_s3'}}
2021-06-06 12:45:24,578 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:09.475Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc-endpoint', 'version': 1.0, 'tags': {'Name': 'test_vpc_endpoint_dynamodb'}}
2021-06-06 12:45:24,786 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:09.929Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'security-group', 'version': 1.0, 'tags': {'Name': 'test_security_group_vpce'}}
2021-06-06 12:45:24,927 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateVpcEndpoint in us-east-1 at 2021-06-06T09:39:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:06Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateVpcEndpoint', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'CreateVpcEndpointRequest': {'PrivateDnsEnabled': False, 'RouteTableId': {'tag': 1, 'content': 'rtb-03b41e12a3709de28'}, 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ServiceName': 'com.amazonaws.us-east-1.s3', 'VpcEndpointType': 'Gateway', 'TagSpecification': {'ResourceType': 'vpc-endpoint', 'tag': 1, 'Tag': {'Value': 'test_vpc_endpoint_s3', 'tag': 1, 'Key': 'Name'}}}}, 'responseElements': {'CreateVpcEndpointResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': '410d2476-d58a-4f1a-a9d5-43b65e7f69e8', 'vpcEndpoint': {'policyDocument': '{"Version":"2008-10-17","Statement":[{"Effect":"Allow","Principal":"*","Action":"*","Resource":"*"}]}', 'routeTableIdSet': {'item': 'rtb-03b41e12a3709de28'}, 'dnsEntrySet': '', 'ownerId': 139614369439, 'privateDnsEnabled': False, 'serviceName': 'com.amazonaws.us-east-1.s3', 'groupSet': '', 'requesterManaged': False, 'vpcEndpointId': 'vpce-03050161c8e381c75', 'subnetIdSet': '', 'tagSet': {'item': {'value': 'test_vpc_endpoint_s3', 'key': 'Name'}}, 'networkInterfaceIdSet': '', 'vpcEndpointType': 'Gateway', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'creationTimestamp': '2021-06-06T09:39:05.000Z', 'state': 'available'}}}, 'requestID': '410d2476-d58a-4f1a-a9d5-43b65e7f69e8', 'eventID': '1870ae80-7874-47b7-8aae-3f3ff904877f', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:24,937 - INFO - create vpc_endpoint - [{'VpcEndpointId': 'vpce-03050161c8e381c75', 'VpcEndpointType': 'Gateway', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ServiceName': 'com.amazonaws.us-east-1.s3', 'NetworkInterfaceIds': '', 'RouteTableIds': ['rtb-03b41e12a3709de28'], 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_s3', 'resource_id': 'vpce-03050161c8e381c75..Name'}], 'resource_id': 'vpce-03050161c8e381c75'}]
2021-06-06 12:45:24,937 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-03b41e12a3709de28']}]}}}
2021-06-06 12:45:25,817 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-03b41e12a3709de28', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-03b41e12a3709de28..10.20.0.0/16'}, {'GatewayId': 'vpce-09c7006e264934178', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationPrefixListId': 'pl-02cd2c6b', 'resource_id': 'rtb-03b41e12a3709de28'}, {'GatewayId': 'vpce-03050161c8e381c75', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationPrefixListId': 'pl-63a5400a', 'resource_id': 'rtb-03b41e12a3709de28'}], 'route_table_association': [{'RouteTableId': 'rtb-03b41e12a3709de28', 'AssociationId': 'rtbassoc-0f36dbd6ae6942007', 'Main': True, 'resource_id': 'rtb-03b41e12a3709de28..rtbassoc-0f36dbd6ae6942007'}], 'resource_id': 'rtb-03b41e12a3709de28'}]}
2021-06-06 12:45:25,848 - INFO - Get previous translated snapshot with timestamp 1622972718248 took 0.03 seconds
2021-06-06 12:45:25,855 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'vpc_endpoint': [{'VpcEndpointId': 'vpce-03050161c8e381c75', 'VpcEndpointType': 'Gateway', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ServiceName': 'com.amazonaws.us-east-1.s3', 'NetworkInterfaceIds': '', 'RouteTableIds': ['rtb-03b41e12a3709de28'], 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_s3', 'resource_id': 'vpce-03050161c8e381c75..Name'}], 'resource_id': 'vpce-03050161c8e381c75'}]}, 'modified': {'route_table': [{'RouteTableId': 'rtb-03b41e12a3709de28', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'rtb-03b41e12a3709de28', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-03b41e12a3709de28..10.20.0.0/16'}, {'GatewayId': 'vpce-09c7006e264934178', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationPrefixListId': 'pl-02cd2c6b', 'resource_id': 'rtb-03b41e12a3709de28'}, {'GatewayId': 'vpce-03050161c8e381c75', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationPrefixListId': 'pl-63a5400a', 'resource_id': 'rtb-03b41e12a3709de28'}], 'route_table_association': [{'RouteTableId': 'rtb-03b41e12a3709de28', 'AssociationId': 'rtbassoc-0f36dbd6ae6942007', 'Main': True, 'resource_id': 'rtb-03b41e12a3709de28..rtbassoc-0f36dbd6ae6942007'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972718248}
2021-06-06 12:45:25,925 - INFO - Calling modeler on-new-snapshot for timestamp 1622972725817 ...
2021-06-06 12:45:26,238 - INFO - Calling analyzer for timestamp 1622972725817 ...
2021-06-06 12:45:29,606 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:29,606 - INFO - Finished triggering everything for timestamp 1622972725817 after 3.75 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.31), ('analyzer', 3.35)]
2021-06-06 12:45:29,756 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:11.666Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 1.0, 'tags': {'Name': 'test_subnet_nat'}}
2021-06-06 12:45:29,977 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateLoadBalancer in us-east-1 at 2021-06-06T09:39:09Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:09Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'CreateLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnets': ['subnet-0b2f8d86c67729f1a', 'subnet-0fe138ba19046bb30'], 'type': 'gateway', 'ipAddressType': 'ipv4', 'subnetMappings': [{'subnetId': 'subnet-0b2f8d86c67729f1a'}, {'subnetId': 'subnet-0fe138ba19046bb30'}], 'name': 'test-glb'}, 'responseElements': {'loadBalancers': [{'loadBalancerName': 'test-glb', 'state': {'code': 'provisioning'}, 'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'type': 'gateway', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZones': [{'subnetId': 'subnet-0fe138ba19046bb30', 'zoneName': 'us-east-1a'}, {'subnetId': 'subnet-0b2f8d86c67729f1a', 'zoneName': 'us-east-1b'}], 'createdTime': 'Jun 6, 2021 9:39:09 AM'}]}, 'requestID': '168b8e04-fb27-43ce-8cc5-55de6690847f', 'eventID': 'e80f3f1b-c53d-417b-a948-a5af65bfb49b', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:29,978 - INFO - create glb - [{'StateCode': 'provisioning', 'availability_zone': [{'SubnetId': 'subnet-0fe138ba19046bb30', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..subnet-0fe138ba19046bb30'}, {'SubnetId': 'subnet-0b2f8d86c67729f1a', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..subnet-0b2f8d86c67729f1a'}], 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'VpcId': 'vpc-0f057794b5da52459', 'LoadBalancerName': 'test-glb', 'Type': 'gateway', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302'}]
2021-06-06 12:45:29,978 - WARNING - nothing to scan for dependent scan {'resource': 'elb', 'depends_on': [{'resource': 'elb', 'attr': 'LoadBalancerName'}]}
2021-06-06 12:45:30,003 - INFO - Get previous translated snapshot with timestamp 1622972725817 took 0.02 seconds
2021-06-06 12:45:30,008 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'glb': [{'StateCode': 'provisioning', 'availability_zone': [{'SubnetId': 'subnet-0fe138ba19046bb30', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..subnet-0fe138ba19046bb30'}, {'SubnetId': 'subnet-0b2f8d86c67729f1a', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..subnet-0b2f8d86c67729f1a'}], 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'VpcId': 'vpc-0f057794b5da52459', 'LoadBalancerName': 'test-glb', 'Type': 'gateway', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972725817}
2021-06-06 12:45:30,078 - INFO - Calling modeler on-new-snapshot for timestamp 1622972729979 ...
2021-06-06 12:45:30,144 - INFO - Calling analyzer for timestamp 1622972729979 ...
2021-06-06 12:45:33,292 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:33,292 - INFO - Finished triggering everything for timestamp 1622972729979 after 3.29 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.07), ('analyzer', 3.13)]
2021-06-06 12:45:34,197 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:15.871Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_glb'}}
2021-06-06 12:45:34,357 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:16.774Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_rds'}}
2021-06-06 12:45:34,506 - INFO - Ignoring failed event - User N/A (application-autoscaling.amazonaws.com) performed UpdateService in us-east-1 at 2021-06-06T09:39:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'ASIAIV6W6AJPNRZBYNUQ', 'sessionContext': {'sessionIssuer': {}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:08Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'application-autoscaling.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:08Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'UpdateService', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'application-autoscaling.amazonaws.com', 'userAgent': 'application-autoscaling.amazonaws.com', 'errorCode': 'InvalidParameterException', 'errorMessage': 'Task count can not be lesser than 0', 'requestParameters': {'cluster': 'test_ecs_cluster', 'desiredCount': -1, 'forceNewDeployment': False, 'service': 'test_ecs_service'}, 'responseElements': None, 'requestID': '3a2f1e73-81aa-46e5-8678-c06bc28ea68a', 'eventID': 'efcb52a4-4298-430b-80a0-43aeb390db05', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: InvalidParameterException, message: Task count can not be lesser than 0)
2021-06-06 12:45:34,707 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateDBSubnetGroup in us-east-1 at 2021-06-06T09:39:10Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:10Z', 'eventSource': 'rds.amazonaws.com', 'eventName': 'CreateDBSubnetGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'dBSubnetGroupName': 'test_db_subnet_group', 'dBSubnetGroupDescription': 'Managed by Terraform', 'subnetIds': ['subnet-083e75a9da33deaec', 'subnet-0e4cc63b267655ade'], 'tags': [{'key': 'Name', 'value': 'test_db_subnet_group'}]}, 'responseElements': {'dBSubnetGroupName': 'test_db_subnet_group', 'dBSubnetGroupDescription': 'Managed by Terraform', 'vpcId': 'vpc-0f057794b5da52459', 'subnetGroupStatus': 'Complete', 'subnets': [{'subnetIdentifier': 'subnet-0e4cc63b267655ade', 'subnetAvailabilityZone': {'name': 'us-east-1d'}, 'subnetOutpost': {}, 'subnetStatus': 'Active'}, {'subnetIdentifier': 'subnet-083e75a9da33deaec', 'subnetAvailabilityZone': {'name': 'us-east-1c'}, 'subnetOutpost': {}, 'subnetStatus': 'Active'}], 'dBSubnetGroupArn': 'arn:aws:rds:us-east-1:139614369439:subgrp:test_db_subnet_group'}, 'requestID': '4a79dd03-8cd8-45d9-b82b-e0b6a4eba688', 'eventID': '74daab77-95a9-4e1a-ae18-91b59c7beb75', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:35,007 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:39:26.463Z, account_id: N/A, extra:{'instance-id': 'i-09bd4d3233e68e8cc', 'state': 'running'}
2021-06-06 12:45:35,240 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateLaunchConfiguration in us-east-1 at 2021-06-06T09:39:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:02Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'CreateLaunchConfiguration', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'ebsOptimized': False, 'instanceMonitoring': {'enabled': True}, 'instanceType': 't2.micro', 'associatePublicIpAddress': True, 'launchConfigurationName': 'terraform-20210606093901145000000007', 'imageId': 'ami-0f06fc190dd71269e', 'userData': '<sensitiveDataRemoved>', 'iamInstanceProfile': 'test_profile_ecs'}, 'responseElements': None, 'requestID': '4eb1c13f-4bda-4177-bdc0-61a02165e595', 'eventID': 'e7ecd8cc-15ef-471a-bc1c-fa0d724971b0', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:35,240 - INFO - create launch_configuration - []
2021-06-06 12:45:35,240 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'launch_configuration': {'filters': [{'name': 'LaunchConfigurationName', 'values': ['terraform-20210606093901145000000007']}]}}}
2021-06-06 12:45:37,417 - INFO - scanned resources: {'launch_configuration': [{'LaunchConfigurationName': 'terraform-20210606093901145000000007', 'LaunchConfigurationARN': 'arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:e8a49d5c-74c8-4456-a41c-0f91a05120aa:launchConfigurationName/terraform-20210606093901145000000007', 'ImageId': 'ami-0f06fc190dd71269e', 'InstanceType': 't2.micro', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:e8a49d5c-74c8-4456-a41c-0f91a05120aa:launchConfigurationName/terraform-20210606093901145000000007'}]}
2021-06-06 12:45:37,446 - INFO - Get previous translated snapshot with timestamp 1622972729979 took 0.03 seconds
2021-06-06 12:45:37,450 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'launch_configuration': [{'LaunchConfigurationName': 'terraform-20210606093901145000000007', 'LaunchConfigurationARN': 'arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:e8a49d5c-74c8-4456-a41c-0f91a05120aa:launchConfigurationName/terraform-20210606093901145000000007', 'ImageId': 'ami-0f06fc190dd71269e', 'InstanceType': 't2.micro', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:e8a49d5c-74c8-4456-a41c-0f91a05120aa:launchConfigurationName/terraform-20210606093901145000000007'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972729979}
2021-06-06 12:45:37,515 - INFO - Calling modeler on-new-snapshot for timestamp 1622972737417 ...
2021-06-06 12:45:37,558 - INFO - Calling analyzer for timestamp 1622972737417 ...
2021-06-06 12:45:40,505 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:40,505 - INFO - Finished triggering everything for timestamp 1622972737417 after 3.05 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 2.92)]
2021-06-06 12:45:40,747 - INFO - Invalid event id - User N/A (N/A) performed SERVICE_DEPLOYMENT_COMPLETED in N/A at 2021-06-06T09:39:38.232Z, account_id: N/A, extra:{'eventType': 'INFO', 'eventName': 'SERVICE_DEPLOYMENT_COMPLETED', 'deploymentId': 'ecs-svc/6347564329799363003', 'updatedAt': '2021-06-06T09:38:55.476Z', 'reason': 'ECS deployment ecs-svc/6347564329799363003 completed.'}
2021-06-06 12:45:40,899 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateAutoScalingGroup in us-east-1 at 2021-06-06T09:39:11Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:11Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'CreateAutoScalingGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'availabilityZones': ['us-east-1a'], 'minSize': 1, 'maxSize': 10, 'newInstancesProtectedFromScaleIn': False, 'autoScalingGroupName': 'test_autoscaling_group', 'healthCheckType': 'EC2', 'healthCheckGracePeriod': 300, 'desiredCapacity': 2, 'launchConfigurationName': 'terraform-20210606093901145000000007'}, 'responseElements': None, 'requestID': '5c328db0-867d-4b9a-a8fa-97638ee9bf1b', 'eventID': '2d00a4b1-f2d0-4e6d-a2a8-8b94b0107084', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:40,899 - INFO - create auto_scaling_group - []
2021-06-06 12:45:40,902 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'auto_scaling_group': {'filters': [{'name': 'AutoScalingGroupName', 'values': ['test_autoscaling_group']}]}}}
2021-06-06 12:45:41,717 - INFO - scanned resources: {'auto_scaling_group': [{'AutoScalingGroupName': 'test_autoscaling_group', 'AutoScalingGroupARN': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group', 'LaunchConfigurationName': 'terraform-20210606093901145000000007', 'MinSize': 1, 'MaxSize': 10, 'DefaultCooldown': 300, 'DesiredCapacity': 2, 'HealthCheckType': 'EC2', 'HealthCheckGracePeriod': 300, 'tag': [{'Key': 'AmazonECSManaged', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group..AmazonECSManaged'}], 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group'}]}
2021-06-06 12:45:41,741 - INFO - Get previous translated snapshot with timestamp 1622972737417 took 0.02 seconds
2021-06-06 12:45:41,745 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'auto_scaling_group': [{'AutoScalingGroupName': 'test_autoscaling_group', 'AutoScalingGroupARN': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group', 'LaunchConfigurationName': 'terraform-20210606093901145000000007', 'MinSize': 1, 'MaxSize': 10, 'DefaultCooldown': 300, 'DesiredCapacity': 2, 'HealthCheckType': 'EC2', 'HealthCheckGracePeriod': 300, 'tag': [{'Key': 'AmazonECSManaged', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group..AmazonECSManaged'}], 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972737417}
2021-06-06 12:45:41,808 - INFO - Calling modeler on-new-snapshot for timestamp 1622972741717 ...
2021-06-06 12:45:41,854 - INFO - Calling analyzer for timestamp 1622972741717 ...
2021-06-06 12:45:44,885 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:44,886 - INFO - Finished triggering everything for timestamp 1622972741717 after 3.15 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.05), ('analyzer', 3.01)]
2021-06-06 12:45:45,149 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateFunction20150331 in us-east-1 at 2021-06-06T09:39:14Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:14Z', 'eventSource': 'lambda.amazonaws.com', 'eventName': 'CreateFunction20150331', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'functionName': 'test_lambda_function', 'runtime': 'nodejs12.x', 'role': 'arn:aws:iam::139614369439:role/test_role_lambda', 'handler': 'index.handler', 'code': {}, 'description': '', 'timeout': 3, 'memorySize': 128, 'publish': False, 'vpcConfig': {'subnetIds': ['subnet-0794a2e17f9656258'], 'securityGroupIds': ['sg-0af2498b5cbd583f6']}, 'packageType': 'Zip', 'environment': {}}, 'responseElements': {'functionName': 'test_lambda_function', 'functionArn': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function', 'runtime': 'nodejs12.x', 'role': 'arn:aws:iam::139614369439:role/test_role_lambda', 'handler': 'index.handler', 'codeSize': 253, 'description': '', 'timeout': 3, 'memorySize': 128, 'lastModified': '2021-06-06T09:39:14.077+0000', 'codeSha256': 'PKBsYoUPnqE9VDHiiW2w5xILHHuLvgFQqkVgUi+Kj+4=', 'version': '$LATEST', 'vpcConfig': {'subnetIds': ['subnet-0794a2e17f9656258'], 'securityGroupIds': ['sg-0af2498b5cbd583f6'], 'vpcId': 'vpc-0f057794b5da52459'}, 'environment': {}, 'tracingConfig': {'mode': 'PassThrough'}, 'revisionId': '60db8f17-a6e6-480d-9bf9-e37ef2f1aed3', 'state': 'Pending', 'stateReason': 'The function is being created.', 'stateReasonCode': 'Creating', 'packageType': 'Zip'}, 'requestID': '31e2f034-9b12-4db3-8ff0-1a7ab66b740e', 'eventID': 'a5a84dce-308d-4bec-9dc1-2209da05ff9e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:45,152 - INFO - create lambda_function - [{'FunctionName': 'test_lambda_function', 'FunctionArn': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function', 'Runtime': 'nodejs12.x', 'Role': 'arn:aws:iam::139614369439:role/test_role_lambda', 'Description': '', 'VpcId': 'vpc-0f057794b5da52459', 'SubnetIds': ['subnet-0794a2e17f9656258'], 'SecurityGroupIds': ['sg-0af2498b5cbd583f6'], 'resource_id': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function'}]
2021-06-06 12:45:45,179 - INFO - Get previous translated snapshot with timestamp 1622972741717 took 0.03 seconds
2021-06-06 12:45:45,183 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'lambda_function': [{'FunctionName': 'test_lambda_function', 'FunctionArn': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function', 'Runtime': 'nodejs12.x', 'Role': 'arn:aws:iam::139614369439:role/test_role_lambda', 'Description': '', 'VpcId': 'vpc-0f057794b5da52459', 'SubnetIds': ['subnet-0794a2e17f9656258'], 'SecurityGroupIds': ['sg-0af2498b5cbd583f6'], 'resource_id': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972741717}
2021-06-06 12:45:45,252 - INFO - Calling modeler on-new-snapshot for timestamp 1622972745152 ...
2021-06-06 12:45:45,290 - INFO - Calling analyzer for timestamp 1622972745152 ...
2021-06-06 12:45:48,679 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:45:48,680 - INFO - Finished triggering everything for timestamp 1622972745152 after 3.49 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 3.36)]
2021-06-06 12:45:48,834 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:39:54.759Z, account_id: N/A, extra:{'instance-id': 'i-0bedadb3dfadfbb56', 'state': 'running'}
2021-06-06 12:45:49,860 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateRoute in us-east-1 at 2021-06-06T09:40:07Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:07Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateRoute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-0093bf31ff3817ec1', 'destinationCidrBlock': '0.0.0.0/0', 'gatewayId': 'igw-0fdad6471fc678eec'}, 'responseElements': {'requestId': '44c21e87-184b-4c69-9b88-b9a983dd2f02', '_return': True}, 'requestID': '44c21e87-184b-4c69-9b88-b9a983dd2f02', 'eventID': '6c1965e0-75b4-4ae2-aca7-b5769eddc890', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:49,860 - INFO - hard-modify route_table - 
2021-06-06 12:45:49,866 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-0093bf31ff3817ec1']}]}}}
2021-06-06 12:45:51,407 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-0093bf31ff3817ec1', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.30.0.0/16', 'resource_id': 'rtb-0093bf31ff3817ec1..10.30.0.0/16'}, {'GatewayId': 'igw-0fdad6471fc678eec', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0093bf31ff3817ec1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0093bf31ff3817ec1', 'AssociationId': 'rtbassoc-02093f6858138b75c', 'Main': True, 'resource_id': 'rtb-0093bf31ff3817ec1..rtbassoc-02093f6858138b75c'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_3', 'resource_id': 'rtb-0093bf31ff3817ec1..Name'}], 'resource_id': 'rtb-0093bf31ff3817ec1'}]}
2021-06-06 12:45:51,439 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.03 seconds
2021-06-06 12:45:51,443 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-0093bf31ff3817ec1', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'resource_id': 'rtb-0093bf31ff3817ec1', 'route': [{'DestinationCidrBlock': '10.30.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0093bf31ff3817ec1..10.30.0.0/16'}, {'DestinationCidrBlock': '0.0.0.0/0', 'GatewayId': 'igw-0fdad6471fc678eec', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0093bf31ff3817ec1..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-02093f6858138b75c', 'Main': True, 'RouteTableId': 'rtb-0093bf31ff3817ec1', 'resource_id': 'rtb-0093bf31ff3817ec1..rtbassoc-02093f6858138b75c'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_3', 'resource_id': 'rtb-0093bf31ff3817ec1..Name'}]} 
2021-06-06 12:45:51,443 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972745152}
2021-06-06 12:45:52,929 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:21.211Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_vpce_1'}}
2021-06-06 12:45:53,133 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:22.659Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 3, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:22.224Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:45:53,338 - INFO - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed DiscoverPollEndpoint in us-east-1 at 2021-06-06T09:40:21Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PTXLBH4KPM:i-07e8ed8341d35c6b0', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-07e8ed8341d35c6b0', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PUEX4ESBE', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PTXLBH4KPM', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:23Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:40:21Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DiscoverPollEndpoint', 'awsRegion': 'us-east-1', 'sourceIPAddress': '18.233.148.35', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'requestParameters': {'containerInstance': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'cluster': 'test_ecs_cluster'}, 'responseElements': {'endpoint': 'https://ecs-a-20.us-east-1.amazonaws.com/', 'telemetryEndpoint': 'https://ecs-t-20.us-east-1.amazonaws.com/'}, 'requestID': '483cba3b-5aa2-42ba-ad97-0e58b95e09be', 'eventID': '7e9f0dae-f941-4e0e-b3ba-02903f9a6f03', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:53,495 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:33.677Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 3, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:33.354Z', 'registeredAt': '2021-06-06T09:40:32.186Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:45:53,819 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:39.731Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 5, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:35.373Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:45:53,981 - INFO - User N/A (ecs.amazonaws.com) performed AttachNetworkInterface in us-east-1 at 2021-06-06T09:40:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:40:38Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:40:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AttachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-05095d1d9d13f13f3', 'instanceId': 'i-0bedadb3dfadfbb56', 'deviceIndex': 1}, 'responseElements': {'requestId': '474c47f8-3fed-41d6-82bd-5ad288932111', 'attachmentId': 'eni-attach-02770f627db5fc799'}, 'requestID': '474c47f8-3fed-41d6-82bd-5ad288932111', 'eventID': '6f02ff59-aeb1-4060-8f13-167452750595', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:53,981 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'InstanceId': 'i-0bedadb3dfadfbb56', 'resource_id': 'eni-05095d1d9d13f13f3'}]
2021-06-06 12:45:53,981 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-05095d1d9d13f13f3']}]}}}
2021-06-06 12:45:55,189 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.9.32', 'DnsName': 'ip-172-31-9-32.ec2.internal', 'MacAddress': '12:ed:f4:02:8a:4b', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02770f627db5fc799', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.9.32', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'}]}
2021-06-06 12:45:55,250 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.06 seconds
2021-06-06 12:45:55,255 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:45:55,255 - WARNING - Failed to handle message: tried to modify an old resource eni-05095d1d9d13f13f3, but it doesn't exist.
2021-06-06 12:45:55,255 - INFO - adding message to failed events queue for retry
2021-06-06 12:45:55,448 - INFO - User N/A (ecs.amazonaws.com) performed AttachNetworkInterface in us-east-1 at 2021-06-06T09:40:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:40:37Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:40:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AttachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-073e4f80decd5dd47', 'instanceId': 'i-07e8ed8341d35c6b0', 'deviceIndex': 1}, 'responseElements': {'requestId': '13bde10c-c704-4a9b-9798-0b42ef122ea6', 'attachmentId': 'eni-attach-0746963a71525a893'}, 'requestID': '13bde10c-c704-4a9b-9798-0b42ef122ea6', 'eventID': '3d48489d-4e8e-44c1-ab4d-795792401577', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:55,448 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'InstanceId': 'i-07e8ed8341d35c6b0', 'resource_id': 'eni-073e4f80decd5dd47'}]
2021-06-06 12:45:55,448 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-073e4f80decd5dd47']}]}}}
2021-06-06 12:45:56,957 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.10.113', 'DnsName': 'ip-172-31-10-113.ec2.internal', 'MacAddress': '12:85:60:3c:cb:13', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-07e8ed8341d35c6b0', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0746963a71525a893', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.10.113', 'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'resource_id': 'eni-073e4f80decd5dd47..172.31.10.113'}], 'resource_id': 'eni-073e4f80decd5dd47'}]}
2021-06-06 12:45:56,982 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.03 seconds
2021-06-06 12:45:56,986 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-0746963a71525a893', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'DeviceIndex': 1, 'DnsName': 'ip-172-31-10-113.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-07e8ed8341d35c6b0', 'InterfaceType': 'interface', 'MacAddress': '12:85:60:3c:cb:13', 'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'PrivateIpAddress': '172.31.10.113', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'PrivateIpAddress': '172.31.10.113', 'resource_id': 'eni-073e4f80decd5dd47..172.31.10.113'}], 'resource_id': 'eni-073e4f80decd5dd47'} 
2021-06-06 12:45:56,986 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972745152}
2021-06-06 12:45:57,137 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:48.482Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_sqs'}}
2021-06-06 12:45:57,309 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:54.379Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_glb'}}
2021-06-06 12:45:59,008 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed SetSecurityGroups in us-east-1 at 2021-06-06T09:41:13Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:13Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'SetSecurityGroups', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'securityGroups': ['sg-0af2498b5cbd583f6'], 'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390'}, 'responseElements': {'securityGroupIds': ['sg-0af2498b5cbd583f6']}, 'requestID': '0fb53f5e-848f-4139-ac47-d6b1bcad6ff6', 'eventID': 'd526e73c-3450-4ee0-84c1-3ebaec69a9f3', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:59,008 - INFO - modify alb - [{'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390', 'GroupId': [{'security_group_id': ['sg-0af2498b5cbd583f6']}], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390'}]
2021-06-06 12:45:59,038 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.03 seconds
2021-06-06 12:45:59,041 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-alb-988268816.us-east-1.elb.amazonaws.com', 'GroupId': [{'security_group_id': ['sg-0af2498b5cbd583f6']}], 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390', 'LoadBalancerName': 'test-alb', 'Scheme': 'internet-facing', 'StateCode': 'provisioning', 'Type': 'application', 'VpcId': 'vpc-0f057794b5da52459', 'availability_zone': [{'SubnetId': 'subnet-0ed5e44884919419e', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390..subnet-0ed5e44884919419e'}, {'SubnetId': 'subnet-0fd7e25c7d54404b7', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390..subnet-0fd7e25c7d54404b7'}], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/7af893b271c21390'} 
2021-06-06 12:45:59,042 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972745152}
2021-06-06 12:45:59,270 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'e9603872-a0ca-4093-9a98-86c6ce390c48', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': '437d0126-282b-494a-a543-2b6ac4ae60d2', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:45:59,477 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyLoadBalancerAttributes in us-east-1 at 2021-06-06T09:41:18Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:18Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ModifyLoadBalancerAttributes', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'attributes': [{'key': 'load_balancing.cross_zone.enabled', 'value': 'false'}, {'key': 'deletion_protection.enabled', 'value': 'false'}], 'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/54a3ea88b666491c'}, 'responseElements': {'attributes': [{'key': 'load_balancing.cross_zone.enabled', 'value': 'false'}, {'key': 'deletion_protection.enabled', 'value': 'false'}, {'key': 'access_logs.s3.enabled', 'value': 'false'}, {'key': 'access_logs.s3.prefix', 'value': ''}, {'key': 'access_logs.s3.bucket', 'value': ''}]}, 'requestID': '9ab4e347-46d8-452f-a87e-9025b0063318', 'eventID': 'c7ece9e3-e86d-42d7-9415-9ced9f116a21', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:59,477 - INFO - modify elb - []
2021-06-06 12:45:59,477 - WARNING - nothing to scan for dependent scan {'resource': 'elb', 'depends_on': [{'resource': 'elb', 'attr': 'LoadBalancerName'}]}
2021-06-06 12:45:59,511 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.03 seconds
2021-06-06 12:45:59,515 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972745152}
2021-06-06 12:45:59,679 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:41:18Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:18Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-09e54fc80cca51f6b', 'routeTableId': 'rtb-010d0cddf0307500d'}, 'responseElements': {'requestId': 'a338348b-2b0b-45fa-a8d0-901fc016a82e', 'newAssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'associationState': {'state': 'associated'}}, 'requestID': 'a338348b-2b0b-45fa-a8d0-901fc016a82e', 'eventID': '81ac4836-39e0-4bc3-9370-5acca944c403', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:45:59,679 - INFO - hard-modify route_table - 
2021-06-06 12:45:59,703 - INFO - Got 1 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-010d0cddf0307500d$'}]
2021-06-06 12:45:59,703 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-0a880421f072a8186']}]}}}
2021-06-06 12:46:01,221 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'route': [{'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-010d0cddf0307500d..10.10.0.0/16'}, {'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'route_table_association': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'AssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'Main': True, 'resource_id': 'rtb-010d0cddf0307500d..rtbassoc-0de0d5b1b0c53f526'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}], 'resource_id': 'rtb-010d0cddf0307500d'}, {'RouteTableId': 'rtb-05a80ba08897722ee', 'VpcId': 'vpc-0a880421f072a8186', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-05a80ba08897722ee..10.20.0.0/16'}], 'resource_id': 'rtb-05a80ba08897722ee'}]}
2021-06-06 12:46:01,247 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.03 seconds
2021-06-06 12:46:01,251 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'rtb-010d0cddf0307500d', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'resource_id': 'rtb-010d0cddf0307500d..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'Main': True, 'RouteTableId': 'rtb-010d0cddf0307500d', 'resource_id': 'rtb-010d0cddf0307500d..rtbassoc-0de0d5b1b0c53f526'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}]} 
2021-06-06 12:46:01,251 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-05a80ba08897722ee', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'rtb-05a80ba08897722ee', 'route': [{'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-05a80ba08897722ee..10.20.0.0/16'}]} 
2021-06-06 12:46:01,252 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972745152}
2021-06-06 12:46:01,520 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:29.025Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': '4429a918-7495-43c0-992a-659bf6889162'}
2021-06-06 12:46:01,730 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateListener in us-east-1 at 2021-06-06T09:41:30Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:30Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'CreateListener', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'defaultActions': [{'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1', 'order': 1, 'type': 'forward'}]}, 'responseElements': {'listeners': [{'defaultActions': [{'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1', 'type': 'forward', 'forwardConfig': {'targetGroups': [{'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1'}]}}], 'listenerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/7279773c01342302/fc609d82f2ce44cf', 'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302'}]}, 'requestID': '7437372e-8ed5-42f3-84c8-d1610d98ba15', 'eventID': 'b0d1dfac-7ef4-4f31-b24e-a51afb1b5f3c', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:01,732 - INFO - add listener_glb - [{'ListenerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/7279773c01342302/fc609d82f2ce44cf', 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/7279773c01342302/fc609d82f2ce44cf'}]
2021-06-06 12:46:01,779 - INFO - Get previous translated snapshot with timestamp 1622972745152 took 0.05 seconds
2021-06-06 12:46:01,783 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'glb': [{'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'LoadBalancerName': 'test-glb', 'StateCode': 'provisioning', 'Type': 'gateway', 'VpcId': 'vpc-0f057794b5da52459', 'availability_zone': [{'SubnetId': 'subnet-0fe138ba19046bb30', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..subnet-0fe138ba19046bb30'}, {'SubnetId': 'subnet-0b2f8d86c67729f1a', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..subnet-0b2f8d86c67729f1a'}], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'listener_glb': [{'ListenerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/7279773c01342302/fc609d82f2ce44cf', 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/7279773c01342302..arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/7279773c01342302/fc609d82f2ce44cf'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972745152}
2021-06-06 12:46:01,860 - INFO - Calling modeler on-new-snapshot for timestamp 1622972761733 ...
2021-06-06 12:46:01,922 - INFO - Calling analyzer for timestamp 1622972761733 ...
2021-06-06 12:46:04,971 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:04,971 - INFO - Finished triggering everything for timestamp 1622972761733 after 3.19 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.06), ('analyzer', 3.03)]
2021-06-06 12:46:05,208 - INFO - User N/A (AWS Internal) performed CreateOrUpdateTags in us-east-1 at 2021-06-06T09:41:36Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'ASIAIHVEMTHL3OEYZ5UQ', 'sessionContext': {'sessionIssuer': {}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:41:36Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'AWS Internal'}, 'eventTime': '2021-06-06T09:41:36Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'CreateOrUpdateTags', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'AWS Internal', 'userAgent': 'AWS Internal', 'requestParameters': {'tags': [{'propagateAtLaunch': True, 'key': 'AmazonECSManaged', 'resourceType': 'auto-scaling-group', 'resourceId': 'test_autoscaling_group'}]}, 'responseElements': None, 'requestID': '1659360d-eccf-4f0c-a82a-63a5fcb72809', 'eventID': 'e9318617-3328-4669-930e-9ae7c29e2679', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:05,232 - WARNING - Failed to handle message: handling global tags event for resource id ['test_autoscaling_group'], but it doesnt exist in inventory
2021-06-06 12:46:05,232 - INFO - adding message to failed events queue for retry
2021-06-06 12:46:05,387 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateCapacityProvider in us-east-1 at 2021-06-06T09:41:37Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:37Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'CreateCapacityProvider', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'name': 'test_ecs_capacity_provider', 'autoScalingGroupProvider': {'autoScalingGroupArn': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group'}}, 'responseElements': {'capacityProvider': {'capacityProviderArn': 'arn:aws:ecs:us-east-1:139614369439:capacity-provider/test_ecs_capacity_provider', 'name': 'test_ecs_capacity_provider', 'status': 'ACTIVE', 'autoScalingGroupProvider': {'autoScalingGroupArn': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:3494d781-f173-48ee-b2f9-c6ecac52ea95:autoScalingGroupName/test_autoscaling_group', 'managedScaling': {'status': 'DISABLED', 'targetCapacity': 100, 'minimumScalingStepSize': 1, 'maximumScalingStepSize': 10000, 'instanceWarmupPeriod': 300}, 'managedTerminationProtection': 'DISABLED'}, 'tags': []}}, 'requestID': '1e6e0eb6-fa88-4450-98aa-649ce20cd791', 'eventID': '25713b86-b297-4ad6-92c8-59ba5f8a1e88', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:05,616 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:56.806Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_sqs'}}
2021-06-06 12:46:05,970 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyLoadBalancerAttributes in us-east-1 at 2021-06-06T09:41:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:56Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ModifyLoadBalancerAttributes', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'loadBalancerAttributes': {'crossZoneLoadBalancing': {'enabled': True}, 'accessLog': {'s3BucketPrefix': '', 'enabled': True, 's3BucketName': 'll-test-bucket-2796885', 'emitInterval': 60}, 'connectionSettings': {'idleTimeout': 60}}}, 'responseElements': {'loadBalancerAttributes': {'crossZoneLoadBalancing': {'enabled': True}, 'accessLog': {'s3BucketPrefix': '', 'enabled': True, 's3BucketName': 'll-test-bucket-2796885', 'emitInterval': 60}, 'connectionSettings': {'idleTimeout': 60}}, 'loadBalancerName': 'test-elb-2796885'}, 'requestID': '9a432e16-6992-46bd-bd9b-142188a9d038', 'eventID': '8e5210a5-0ed7-41dd-b54c-d94a99defa1d', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:05,970 - INFO - modify elb - []
2021-06-06 12:46:05,970 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:46:06,920 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:46:06,946 - INFO - Get previous translated snapshot with timestamp 1622972761733 took 0.03 seconds
2021-06-06 12:46:06,950 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:46:06,950 - WARNING - Failed to handle message: tried to modify an old resource test-elb-2796885-957413492.us-east-1.elb.amazonaws.com, but it doesn't exist.
2021-06-06 12:46:06,950 - INFO - adding message to failed events queue for retry
2021-06-06 12:46:07,867 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyLoadBalancerAttributes in us-east-1 at 2021-06-06T09:41:58Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:58Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ModifyLoadBalancerAttributes', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'loadBalancerAttributes': {'connectionDraining': {'enabled': False, 'timeout': 300}}}, 'responseElements': {'loadBalancerAttributes': {'connectionDraining': {'enabled': False, 'timeout': 300}}, 'loadBalancerName': 'test-elb-2796885'}, 'requestID': '2064d17d-5a9c-4f51-b441-c3a894839ef9', 'eventID': 'd1010d5e-46b3-4bef-826b-5711e1ca1700', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:07,867 - INFO - modify elb - []
2021-06-06 12:46:07,867 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:46:09,107 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:46:09,149 - INFO - Get previous translated snapshot with timestamp 1622972761733 took 0.04 seconds
2021-06-06 12:46:09,153 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:46:09,153 - WARNING - Failed to handle message: tried to modify an old resource test-elb-2796885-957413492.us-east-1.elb.amazonaws.com, but it doesn't exist.
2021-06-06 12:46:09,153 - INFO - adding message to failed events queue for retry
2021-06-06 12:46:09,307 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AttachLoadBalancerToSubnets in us-east-1 at 2021-06-06T09:42:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:02Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'AttachLoadBalancerToSubnets', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'subnets': ['subnet-0794a2e17f9656258']}, 'responseElements': {'subnets': ['subnet-0794a2e17f9656258']}, 'requestID': 'f39cff50-65ef-448d-b60d-5fdecb1f3949', 'eventID': 'cf3ad64d-db84-43e2-b18b-6b293476058e', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:09,307 - INFO - modify elb - []
2021-06-06 12:46:09,307 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:46:11,556 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:46:11,598 - INFO - Get previous translated snapshot with timestamp 1622972761733 took 0.04 seconds
2021-06-06 12:46:11,602 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:46:11,602 - WARNING - Failed to handle message: tried to modify an old resource test-elb-2796885-957413492.us-east-1.elb.amazonaws.com, but it doesn't exist.
2021-06-06 12:46:11,602 - INFO - adding message to failed events queue for retry
2021-06-06 12:46:11,918 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RegisterTargets in us-east-1 at 2021-06-06T09:42:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:06Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'RegisterTargets', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'targets': [{'id': 'i-054b3883381a7f655', 'port': 6081}], 'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1'}, 'responseElements': None, 'requestID': 'a822a1d0-11f6-483e-9b5f-939f6966e97b', 'eventID': 'f94c327e-27a7-4b36-9ba8-1cb0a211480e', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:11,918 - INFO - add target - [{'TargetPort': 6081, 'Target': 'i-054b3883381a7f655', 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1..i-054b3883381a7f655..6081'}]
2021-06-06 12:46:11,942 - INFO - Get previous translated snapshot with timestamp 1622972761733 took 0.02 seconds
2021-06-06 12:46:11,947 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'target_group': [{'Port': 6081, 'Protocol': 'GENEVE', 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1', 'TargetGroupName': 'test-tg-glb', 'TargetType': 'instance', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1', 'target': [{'TargetPort': 6081, 'Target': 'i-054b3883381a7f655', 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00d8d1f3bc498b22b1..i-054b3883381a7f655..6081'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972761733}
2021-06-06 12:46:12,016 - INFO - Calling modeler on-new-snapshot for timestamp 1622972771919 ...
2021-06-06 12:46:12,102 - INFO - Calling analyzer for timestamp 1622972771919 ...
2021-06-06 12:46:15,125 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:15,125 - INFO - Finished triggering everything for timestamp 1622972771919 after 3.18 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.09), ('analyzer', 3.0)]
2021-06-06 12:46:16,258 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:53Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'bda92c77-24d6-49e9-ac33-d2d79408a458', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': 'f79d289b-3fe9-4dad-bd58-6ca5ef41c8f6', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:46:16,414 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:50Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:50Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'bc81c328-d179-4815-b04a-cd711a8aac12', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': '9171c824-7dda-4309-8c30-403d09390336', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:46:17,118 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AllocateAddress in us-east-1 at 2021-06-06T09:42:18Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:18Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AllocateAddress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'domain': 'vpc'}, 'responseElements': {'requestId': '6a7ac31c-9e4f-4675-9123-8cbc2ae96cb4', 'publicIp': '50.17.238.206', 'domain': 'vpc', 'allocationId': 'eipalloc-040b1d7c2d45c0746', 'publicIpv4Pool': 'amazon', 'networkBorderGroup': 'us-east-1'}, 'requestID': '6a7ac31c-9e4f-4675-9123-8cbc2ae96cb4', 'eventID': '38ffe80d-3bed-4a0a-a77f-cb1e0095aec6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:17,442 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:42:33.875Z, account_id: N/A, extra:{'instance-id': 'i-08405bcd1f1f290b2', 'state': 'running'}
2021-06-06 12:46:17,594 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:43:41.632Z, account_id: N/A, extra:{'attachments': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-05095d1d9d13f13f3'}, {'name': 'macAddress', 'value': '12:ed:f4:02:8a:4b'}, {'name': 'privateDnsName', 'value': 'ip-172-31-9-32.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.9.32'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710/454035b1-0f2b-4a6c-82da-a7dca7d542bd', 'lastStatus': 'PENDING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'networkInterfaces': [{'attachmentId': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'privateIpv4Address': '172.31.9.32'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:40:35.364Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'PENDING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'startedBy': 'ecs-svc/4959225571735023063', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'updatedAt': '2021-06-06T09:43:41.071Z', 'version': 2}
2021-06-06 12:46:17,748 - INFO - Invalid event id - User N/A (N/A) performed SERVICE_STEADY_STATE in N/A at 2021-06-06T09:43:57.672Z, account_id: N/A, extra:{'eventType': 'INFO', 'eventName': 'SERVICE_STEADY_STATE', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'createdAt': '2021-06-06T09:43:56.416Z'}
2021-06-06 12:46:20,250 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:21.591Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 2, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:21.209Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:46:20,438 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:26.560Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_kinesis'}}
2021-06-06 12:46:20,595 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:40:26Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:26Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-090cfb622a4e9acbc', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_dynamo'}]}]}}, 'responseElements': {'requestId': 'df402b01-d2f8-44b2-a2d5-3f92c683b4bf', 'networkInterface': {'networkInterfaceId': 'eni-0cda1858b7bf13a87', 'subnetId': 'subnet-090cfb622a4e9acbc', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'availabilityZone': 'us-east-1b', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '0a:7b:be:71:02:7f', 'privateIpAddress': '10.20.110.36', 'privateDnsName': 'ip-10-20-110-36.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0', 'groupName': 'test_security_group_vpce'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.110.36', 'privateDnsName': 'ip-10-20-110-36.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_dynamo'}]}}}, 'requestID': 'df402b01-d2f8-44b2-a2d5-3f92c683b4bf', 'eventID': 'eda1dd67-e0ba-421a-9ad8-d7c9d69fa9e1', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:20,596 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'PrivateIpAddress': '10.20.110.36', 'MacAddress': '0a:7b:be:71:02:7f', 'GroupId': ['sg-06513cfe251115cb0'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_dynamo', 'resource_id': 'eni-0cda1858b7bf13a87..Name'}], 'resource_id': 'eni-0cda1858b7bf13a87'}]
2021-06-06 12:46:20,596 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0cda1858b7bf13a87']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:46:21,508 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'PrivateIpAddress': '10.20.110.36', 'DnsName': 'ip-10-20-110-36.ec2.internal', 'MacAddress': '0a:7b:be:71:02:7f', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-08405bcd1f1f290b2', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-04cf9614e9b18b231', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.110.36', 'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'resource_id': 'eni-0cda1858b7bf13a87..10.20.110.36'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_dynamo', 'resource_id': 'eni-0cda1858b7bf13a87..Name'}], 'resource_id': 'eni-0cda1858b7bf13a87'}]}
2021-06-06 12:46:21,531 - INFO - Get previous translated snapshot with timestamp 1622972771919 took 0.02 seconds
2021-06-06 12:46:21,535 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'PrivateIpAddress': '10.20.110.36', 'DnsName': 'ip-10-20-110-36.ec2.internal', 'MacAddress': '0a:7b:be:71:02:7f', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-08405bcd1f1f290b2', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-04cf9614e9b18b231', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.110.36', 'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'resource_id': 'eni-0cda1858b7bf13a87..10.20.110.36'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_dynamo', 'resource_id': 'eni-0cda1858b7bf13a87..Name'}], 'resource_id': 'eni-0cda1858b7bf13a87'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972771919}
2021-06-06 12:46:21,602 - INFO - Calling modeler on-new-snapshot for timestamp 1622972781509 ...
2021-06-06 12:46:21,887 - INFO - Calling analyzer for timestamp 1622972781509 ...
2021-06-06 12:46:25,027 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:25,027 - INFO - Finished triggering everything for timestamp 1622972781509 after 3.49 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.28), ('analyzer', 3.12)]
2021-06-06 12:46:25,262 - INFO - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed RegisterContainerInstance in us-east-1 at 2021-06-06T09:40:32Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PTXLBH4KPM:i-0bedadb3dfadfbb56', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0bedadb3dfadfbb56', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2P22WQ7N5Q', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PTXLBH4KPM', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:24Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:40:32Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'RegisterContainerInstance', 'awsRegion': 'us-east-1', 'sourceIPAddress': '54.144.245.121', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'requestParameters': {'cluster': 'test_ecs_cluster', 'instanceIdentityDocument': '{\n  "accountId" : "139614369439",\n  "architecture" : "x86_64",\n  "availabilityZone" : "us-east-1a",\n  "billingProducts" : null,\n  "devpayProductCodes" : null,\n  "marketplaceProductCodes" : null,\n  "imageId" : "ami-0f06fc190dd71269e",\n  "instanceId" : "i-0bedadb3dfadfbb56",\n  "instanceType" : "t2.micro",\n  "kernelId" : null,\n  "pendingTime" : "2021-06-06T09:39:18Z",\n  "privateIp" : "172.31.11.236",\n  "ramdiskId" : null,\n  "region" : "us-east-1",\n  "version" : "2017-09-30"\n}', 'instanceIdentityDocumentSignature': 'WkzA0yaUA1UgRRlw3J2qEDKm+zuBhUzJOs4CeidoB44rkPP5ABYRUQ4V0vexjufIsKoV7uAr2Yai\nU+fUC5EVxzB56kebeNPsRIyAUxtjmEXnyFoqmk7jo0iE3kueizfnR+n8TXvcTSnK2gFvoKPFg7LS\nHlSNd/5P0838JyrKA6w=', 'totalResources': [{'name': 'CPU', 'type': 'INTEGER', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 0, 'stringSetValue': ['22', '2375', '2376', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 0, 'stringSetValue': []}], 'attributes': [{'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.full-sync'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'ecs.capability.task-eia'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.os-type', 'value': 'linux'}], 'clientToken': '96a02ad3-52e7-4695-a486-1d18d1e7bc96'}, 'responseElements': {'containerInstance': {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'version': 1, 'versionInfo': {}, 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 0, 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 0, 'stringSetValue': []}], 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 0, 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'doubleValue': 0.0, 'longValue': 0, 'integerValue': 0, 'stringSetValue': []}], 'status': 'ACTIVE', 'agentConnected': True, 'runningTasksCount': 0, 'pendingTasksCount': 0, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'registeredAt': 'Jun 6, 2021 9:40:32 AM', 'attachments': [], 'clientToken': '96a02ad3-52e7-4695-a486-1d18d1e7bc96', 'tags': []}}, 'requestID': 'ddc9f86f-1882-4af0-a097-537a5360fe63', 'eventID': 'cf844c46-a9de-42b4-8743-9e1872ea0e86', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:25,268 - INFO - add container_instance - [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'attributes': [{'value': 'a21d3a41-', 'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'value': 'ami-0f06fc190dd71269e', 'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version'}, {'value': 'us-east-1a', 'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id'}, {'value': 'x86_64', 'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'value': 'linux', 'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'value': 'vpc-3a02dc47', 'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'value': 'subnet-0e7e54192b01b1ed0', 'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'value': 't2.micro', 'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'value': '55b2ae77-2020.09.0', 'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}]
2021-06-06 12:46:25,287 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance': {'filters': [{'name': 'InstanceId', 'values': ['i-0bedadb3dfadfbb56']}]}}}
2021-06-06 12:46:26,550 - INFO - scanned resources: {'instance': [{'InstanceId': 'i-0bedadb3dfadfbb56', 'VpcId': 'vpc-3a02dc47', 'ImageId': 'ami-0f06fc190dd71269e', 'InstanceType': 't2.micro', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'State': 'running', 'SourceDestCheck': True, 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'PrivateIpAddress': '172.31.11.236', 'PublicIpAddress': '54.144.245.121', 'PublicDnsName': 'ec2-54-144-245-121.compute-1.amazonaws.com', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bedadb3dfadfbb56..aws:autoscaling:groupName'}], 'resource_id': 'i-0bedadb3dfadfbb56'}]}
2021-06-06 12:46:26,572 - INFO - Get previous translated snapshot with timestamp 1622972781509 took 0.02 seconds
2021-06-06 12:46:26,581 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'InstanceId': 'i-0bedadb3dfadfbb56', 'VpcId': 'vpc-3a02dc47', 'ImageId': 'ami-0f06fc190dd71269e', 'InstanceType': 't2.micro', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'State': 'running', 'SourceDestCheck': True, 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'PrivateIpAddress': '172.31.11.236', 'PublicIpAddress': '54.144.245.121', 'PublicDnsName': 'ec2-54-144-245-121.compute-1.amazonaws.com', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bedadb3dfadfbb56..aws:autoscaling:groupName'}], 'resource_id': 'i-0bedadb3dfadfbb56'}]}, 'modified': {'ecs': [{'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'attributes': [{'value': 'a21d3a41-', 'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'value': 'ami-0f06fc190dd71269e', 'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version'}, {'value': 'us-east-1a', 'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id'}, {'value': 'x86_64', 'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'value': 'linux', 'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'value': 'vpc-3a02dc47', 'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'value': 'subnet-0e7e54192b01b1ed0', 'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'value': 't2.micro', 'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'value': '55b2ae77-2020.09.0', 'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 2, 'failedTasks': 0, 'id': 'ecs-svc/4959225571735023063', 'launchType': 'EC2', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063', 'rolloutState': 'COMPLETED', 'runningCount': 2, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}], 'launchType': 'EC2', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'runningTasksCount': 2, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}]}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 1, 'failedTasks': 0, 'id': 'ecs-svc/6347564329799363003', 'launchType': 'FARGATE', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003', 'rolloutState': 'COMPLETED', 'runningCount': 1, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22'}], 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'runningTasksCount': 1, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}]}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'cpu': '256', 'launchType': 'FARGATE', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972781509}
2021-06-06 12:46:26,690 - INFO - Calling modeler on-new-snapshot for timestamp 1622972786551 ...
2021-06-06 12:46:26,853 - INFO - Calling analyzer for timestamp 1622972786551 ...
2021-06-06 12:46:30,290 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:30,290 - INFO - Finished triggering everything for timestamp 1622972786551 after 3.70 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_classified', 0.05), ('modeler', 0.16), ('analyzer', 3.41)]
2021-06-06 12:46:30,446 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:40:45Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:45Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0803c343c9dbf2502', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_sqs'}]}]}}, 'responseElements': {'requestId': '597d3795-b758-4224-b1d5-d2ef8b40779d', 'networkInterface': {'networkInterfaceId': 'eni-0d7b3374ec048ab52', 'subnetId': 'subnet-0803c343c9dbf2502', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'availabilityZone': 'us-east-1a', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '12:7d:54:5c:0f:35', 'privateIpAddress': '10.20.100.83', 'privateDnsName': 'ip-10-20-100-83.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0', 'groupName': 'test_security_group_vpce'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.100.83', 'privateDnsName': 'ip-10-20-100-83.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_sqs'}]}}}, 'requestID': '597d3795-b758-4224-b1d5-d2ef8b40779d', 'eventID': '36e633ae-6560-4a01-bac3-d8265a95f4ce', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:30,448 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0803c343c9dbf2502', 'PrivateIpAddress': '10.20.100.83', 'MacAddress': '12:7d:54:5c:0f:35', 'GroupId': ['sg-06513cfe251115cb0'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_sqs', 'resource_id': 'eni-0d7b3374ec048ab52..Name'}], 'resource_id': 'eni-0d7b3374ec048ab52'}]
2021-06-06 12:46:30,448 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0d7b3374ec048ab52']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:46:31,308 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0803c343c9dbf2502', 'PrivateIpAddress': '10.20.100.83', 'DnsName': 'ip-10-20-100-83.ec2.internal', 'MacAddress': '12:7d:54:5c:0f:35', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0459367d7e3bc3ba4', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0eaa76a5667b6c232', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.100.83', 'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'resource_id': 'eni-0d7b3374ec048ab52..10.20.100.83'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_sqs', 'resource_id': 'eni-0d7b3374ec048ab52..Name'}], 'resource_id': 'eni-0d7b3374ec048ab52'}]}
2021-06-06 12:46:31,339 - INFO - Get previous translated snapshot with timestamp 1622972786551 took 0.03 seconds
2021-06-06 12:46:31,343 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0803c343c9dbf2502', 'PrivateIpAddress': '10.20.100.83', 'DnsName': 'ip-10-20-100-83.ec2.internal', 'MacAddress': '12:7d:54:5c:0f:35', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0459367d7e3bc3ba4', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0eaa76a5667b6c232', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.100.83', 'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'resource_id': 'eni-0d7b3374ec048ab52..10.20.100.83'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_sqs', 'resource_id': 'eni-0d7b3374ec048ab52..Name'}], 'resource_id': 'eni-0d7b3374ec048ab52'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972786551}
2021-06-06 12:46:31,400 - INFO - Calling modeler on-new-snapshot for timestamp 1622972791308 ...
2021-06-06 12:46:31,708 - INFO - Calling analyzer for timestamp 1622972791308 ...
2021-06-06 12:46:35,197 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:35,197 - INFO - Finished triggering everything for timestamp 1622972791308 after 3.86 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.31), ('analyzer', 3.47)]
2021-06-06 12:46:35,395 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:40:53.629Z, account_id: N/A, extra:{'instance-id': 'i-054b3883381a7f655', 'state': 'pending'}
2021-06-06 12:46:35,600 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:40:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:53Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': '8F386F24-05E8-4538-977F-BF2B92EA325F', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0657d4e335bbb4065', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_glb'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '9a3107da-addd-4559-9622-5a60d41ee2b3', 'reservationId': 'r-03ff996c0b7b29a26', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-054b3883381a7f655', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-10-60-46.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972452000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-0fe138ba19046bb30', 'vpcId': 'vpc-0f057794b5da52459', 'privateIpAddress': '10.10.60.46', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_glb'}]}, 'clientToken': '8F386F24-05E8-4538-977F-BF2B92EA325F', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0657d4e335bbb4065', 'subnetId': 'subnet-0fe138ba19046bb30', 'vpcId': 'vpc-0f057794b5da52459', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:16:9e:dd:8a:07', 'privateIpAddress': '10.10.60.46', 'privateDnsName': 'ip-10-10-60-46.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'attachment': {'attachmentId': 'eni-attach-05a04e1b0165316e7', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972452000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.60.46', 'privateDnsName': 'ip-10-10-60-46.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '9a3107da-addd-4559-9622-5a60d41ee2b3', 'eventID': '4406b234-0b2e-4e16-9892-de95d7f3d93c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:35,606 - INFO - create instance - [{'PrivateIpAddress': '10.10.60.46', 'SourceDestCheck': True, 'InstanceId': 'i-054b3883381a7f655', 'State': 'pending', 'SubnetId': 'subnet-0fe138ba19046bb30', 'VpcId': 'vpc-0f057794b5da52459', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_glb', 'resource_id': 'i-054b3883381a7f655..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-054b3883381a7f655'}]
2021-06-06 12:46:35,617 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-054b3883381a7f655']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:46:37,357 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fe138ba19046bb30', 'PrivateIpAddress': '10.10.60.46', 'DnsName': 'ip-10-10-60-46.ec2.internal', 'MacAddress': '12:16:9e:dd:8a:07', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-054b3883381a7f655', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-05a04e1b0165316e7', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.60.46', 'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'resource_id': 'eni-0657d4e335bbb4065..10.10.60.46'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_glb', 'resource_id': 'eni-0657d4e335bbb4065..Name'}], 'resource_id': 'eni-0657d4e335bbb4065'}]}
2021-06-06 12:46:37,357 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0af2498b5cbd583f6']}]}}}
2021-06-06 12:46:39,126 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]}
2021-06-06 12:46:39,126 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-054b3883381a7f655']}]}}}
2021-06-06 12:46:40,416 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-0c7a2d1679a844140', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-054b3883381a7f655', 'volume_attachment': [{'InstanceId': 'i-054b3883381a7f655', 'VolumeId': 'vol-0c7a2d1679a844140', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0c7a2d1679a844140..i-054b3883381a7f655'}], 'resource_id': 'vol-0c7a2d1679a844140'}]}
2021-06-06 12:46:40,445 - INFO - Get previous translated snapshot with timestamp 1622972791308 took 0.03 seconds
2021-06-06 12:46:40,456 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-0af2498b5cbd583f6', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}]} 
2021-06-06 12:46:40,461 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.10.60.46', 'SourceDestCheck': True, 'InstanceId': 'i-054b3883381a7f655', 'State': 'pending', 'SubnetId': 'subnet-0fe138ba19046bb30', 'VpcId': 'vpc-0f057794b5da52459', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_glb', 'resource_id': 'i-054b3883381a7f655..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-054b3883381a7f655'}], 'instance_volume': [{'VolumeId': 'vol-0c7a2d1679a844140', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-054b3883381a7f655', 'volume_attachment': [{'InstanceId': 'i-054b3883381a7f655', 'VolumeId': 'vol-0c7a2d1679a844140', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0c7a2d1679a844140..i-054b3883381a7f655'}], 'resource_id': 'vol-0c7a2d1679a844140'}], 'network_interface': [{'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fe138ba19046bb30', 'PrivateIpAddress': '10.10.60.46', 'DnsName': 'ip-10-10-60-46.ec2.internal', 'MacAddress': '12:16:9e:dd:8a:07', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-054b3883381a7f655', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-05a04e1b0165316e7', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.60.46', 'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'resource_id': 'eni-0657d4e335bbb4065..10.10.60.46'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_glb', 'resource_id': 'eni-0657d4e335bbb4065..Name'}], 'resource_id': 'eni-0657d4e335bbb4065'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972791308}
2021-06-06 12:46:40,544 - INFO - Calling modeler on-new-snapshot for timestamp 1622972800417 ...
2021-06-06 12:46:40,976 - INFO - Calling analyzer for timestamp 1622972800417 ...
2021-06-06 12:46:44,790 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:44,790 - INFO - Finished triggering everything for timestamp 1622972800417 after 4.31 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.43), ('analyzer', 3.79)]
2021-06-06 12:46:45,098 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:40:57.922Z, account_id: N/A, extra:{'instance-id': 'i-0b26f2433f51be1c4', 'state': 'pending'}
2021-06-06 12:46:45,317 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:00.981Z, account_id: N/A, extra:{'instance-id': 'i-0244269d751c2a0af', 'state': 'pending'}
2021-06-06 12:46:45,477 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:00Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': 'AFCA3A14-1138-4B0E-9112-532385353364', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-086606232e57b4952', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_rds'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '002ecdb0-a040-48de-8d1e-0651239efae0', 'reservationId': 'r-0f7307f7b94a21166', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-0244269d751c2a0af', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-10-80-54.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972460000, 'placement': {'availabilityZone': 'us-east-1c', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-083e75a9da33deaec', 'vpcId': 'vpc-0f057794b5da52459', 'privateIpAddress': '10.10.80.54', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_rds'}]}, 'clientToken': 'AFCA3A14-1138-4B0E-9112-532385353364', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-086606232e57b4952', 'subnetId': 'subnet-083e75a9da33deaec', 'vpcId': 'vpc-0f057794b5da52459', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '0e:1d:a5:6b:3c:a5', 'privateIpAddress': '10.10.80.54', 'privateDnsName': 'ip-10-10-80-54.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'attachment': {'attachmentId': 'eni-attach-08c8a2b6aaedce5a7', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972460000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.80.54', 'privateDnsName': 'ip-10-10-80-54.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '002ecdb0-a040-48de-8d1e-0651239efae0', 'eventID': '7e7dfbb7-8fba-4437-9d18-1366ec47bec4', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:45,477 - INFO - create instance - [{'PrivateIpAddress': '10.10.80.54', 'SourceDestCheck': True, 'InstanceId': 'i-0244269d751c2a0af', 'State': 'pending', 'SubnetId': 'subnet-083e75a9da33deaec', 'VpcId': 'vpc-0f057794b5da52459', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_rds', 'resource_id': 'i-0244269d751c2a0af..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0244269d751c2a0af'}]
2021-06-06 12:46:45,482 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-0244269d751c2a0af']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:46:46,429 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-086606232e57b4952', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.54', 'DnsName': 'ip-10-10-80-54.ec2.internal', 'MacAddress': '0e:1d:a5:6b:3c:a5', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-0244269d751c2a0af', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-08c8a2b6aaedce5a7', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.80.54', 'NetworkInterfaceId': 'eni-086606232e57b4952', 'resource_id': 'eni-086606232e57b4952..10.10.80.54'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_rds', 'resource_id': 'eni-086606232e57b4952..Name'}], 'resource_id': 'eni-086606232e57b4952'}]}
2021-06-06 12:46:46,429 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0af2498b5cbd583f6']}]}}}
2021-06-06 12:46:47,978 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]}
2021-06-06 12:46:47,978 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-0244269d751c2a0af']}]}}}
2021-06-06 12:46:49,046 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-0557133251549a08f', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1c', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-0244269d751c2a0af', 'volume_attachment': [{'InstanceId': 'i-0244269d751c2a0af', 'VolumeId': 'vol-0557133251549a08f', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0557133251549a08f..i-0244269d751c2a0af'}], 'resource_id': 'vol-0557133251549a08f'}]}
2021-06-06 12:46:49,071 - INFO - Get previous translated snapshot with timestamp 1622972800417 took 0.03 seconds
2021-06-06 12:46:49,081 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-0af2498b5cbd583f6', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}]} 
2021-06-06 12:46:49,088 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.10.80.54', 'SourceDestCheck': True, 'InstanceId': 'i-0244269d751c2a0af', 'State': 'pending', 'SubnetId': 'subnet-083e75a9da33deaec', 'VpcId': 'vpc-0f057794b5da52459', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_rds', 'resource_id': 'i-0244269d751c2a0af..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0244269d751c2a0af'}], 'instance_volume': [{'VolumeId': 'vol-0557133251549a08f', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1c', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-0244269d751c2a0af', 'volume_attachment': [{'InstanceId': 'i-0244269d751c2a0af', 'VolumeId': 'vol-0557133251549a08f', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0557133251549a08f..i-0244269d751c2a0af'}], 'resource_id': 'vol-0557133251549a08f'}], 'network_interface': [{'NetworkInterfaceId': 'eni-086606232e57b4952', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.54', 'DnsName': 'ip-10-10-80-54.ec2.internal', 'MacAddress': '0e:1d:a5:6b:3c:a5', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-0244269d751c2a0af', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-08c8a2b6aaedce5a7', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.80.54', 'NetworkInterfaceId': 'eni-086606232e57b4952', 'resource_id': 'eni-086606232e57b4952..10.10.80.54'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_rds', 'resource_id': 'eni-086606232e57b4952..Name'}], 'resource_id': 'eni-086606232e57b4952'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972800417}
2021-06-06 12:46:49,157 - INFO - Calling modeler on-new-snapshot for timestamp 1622972809047 ...
2021-06-06 12:46:49,528 - INFO - Calling analyzer for timestamp 1622972809047 ...
2021-06-06 12:46:53,015 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:46:53,015 - INFO - Finished triggering everything for timestamp 1622972809047 after 3.93 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.37), ('analyzer', 3.47)]
2021-06-06 12:46:54,631 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateVpc in us-east-1 at 2021-06-06T09:38:38Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:38Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateVpc', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'cidrBlock': '10.40.0.0/16', 'instanceTenancy': 'default', 'amazonProvidedIpv6CidrBlock': False, 'tagSpecificationSet': {'items': [{'resourceType': 'vpc', 'tags': [{'key': 'Name', 'value': 'test_vpc_nat'}]}]}}, 'responseElements': {'requestId': '6f2016e6-b642-4727-9895-4ebbf9235da6', 'vpc': {'vpcId': 'vpc-0d9aeb3594c89770e', 'state': 'pending', 'ownerId': '139614369439', 'cidrBlock': '10.40.0.0/16', 'cidrBlockAssociationSet': {'items': [{'cidrBlock': '10.40.0.0/16', 'associationId': 'vpc-cidr-assoc-0c039af057adc39b2', 'cidrBlockState': {'state': 'associated'}}]}, 'ipv6CidrBlockAssociationSet': {}, 'dhcpOptionsId': 'dopt-ac542fd6', 'instanceTenancy': 'default', 'tagSet': {'items': [{'key': 'Name', 'value': 'test_vpc_nat'}]}, 'isDefault': False}}, 'requestID': '6f2016e6-b642-4727-9895-4ebbf9235da6', 'eventID': '27237d54-61e1-4cdc-a1dd-5f5be6cab7b2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:46:54,636 - INFO - create vpc - [{'VpcId': 'vpc-0d9aeb3594c89770e', 'CidrBlock': '10.40.0.0/16', 'IsDefault': False, 'State': 'pending', 'cidr_association': [{'CidrBlock': '10.40.0.0/16', 'AssociationId': 'vpc-cidr-assoc-0c039af057adc39b2', 'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'vpc-0d9aeb3594c89770e..10.40.0.0/16'}], 'tag': [{'Key': 'Name', 'Value': 'test_vpc_nat', 'resource_id': 'vpc-0d9aeb3594c89770e..Name'}], 'resource_id': 'vpc-0d9aeb3594c89770e'}]
2021-06-06 12:46:54,637 - INFO - create cidr_association - [{'CidrBlock': '10.40.0.0/16', 'AssociationId': 'vpc-cidr-assoc-0c039af057adc39b2', 'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'vpc-0d9aeb3594c89770e..10.40.0.0/16'}]
2021-06-06 12:46:54,637 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'subnet': {'filters': [{'name': 'VpcId', 'values': ['vpc-0d9aeb3594c89770e']}]}, 'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-0d9aeb3594c89770e']}]}, 'network_acl': {'filters': [{'name': 'VpcId', 'values': ['vpc-0d9aeb3594c89770e']}]}, 'security_group': {'filters': [{'name': 'VpcId', 'values': ['vpc-0d9aeb3594c89770e']}]}}}
2021-06-06 12:46:56,285 - INFO - scanned resources: {'subnet': [{'SubnetId': 'subnet-0c78091befe9195b8', 'VpcId': 'vpc-0d9aeb3594c89770e', 'CidrBlock': '10.40.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nat', 'resource_id': 'subnet-0c78091befe9195b8..Name'}], 'resource_id': 'subnet-0c78091befe9195b8'}], 'route_table': [{'RouteTableId': 'rtb-06de63e347e6c8259', 'VpcId': 'vpc-0d9aeb3594c89770e', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.40.0.0/16', 'resource_id': 'rtb-06de63e347e6c8259..10.40.0.0/16'}], 'route_table_association': [{'RouteTableId': 'rtb-06de63e347e6c8259', 'AssociationId': 'rtbassoc-05b0235f741a5bd35', 'Main': True, 'resource_id': 'rtb-06de63e347e6c8259..rtbassoc-05b0235f741a5bd35'}], 'resource_id': 'rtb-06de63e347e6c8259'}], 'security_group': [{'GroupId': 'sg-007833b34d0362be4', 'GroupName': 'default', 'VpcId': 'vpc-0d9aeb3594c89770e', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': [], 'PrefixListId': [], 'SourceGroupId': ['sg-007833b34d0362be4'], 'resource_id': 'sg-007833b34d0362be4..all__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-007833b34d0362be4..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-007833b34d0362be4'}], 'network_acl': [{'NetworkAclId': 'acl-029e6c5da91e489e9', 'VpcId': 'vpc-0d9aeb3594c89770e', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0c78091befe9195b8', 'NetworkAclId': 'acl-029e6c5da91e489e9', 'AssociationId': 'aclassoc-53da1a72', 'resource_id': 'acl-029e6c5da91e489e9..aclassoc-53da1a72'}], 'resource_id': 'acl-029e6c5da91e489e9'}]}
2021-06-06 12:46:56,319 - INFO - Get previous translated snapshot with timestamp 1622972809047 took 0.03 seconds
2021-06-06 12:46:56,326 - INFO - sub-event will be discarded because no change in resource configuration: {'CidrBlock': '10.40.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-0d9aeb3594c89770e', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-0c039af057adc39b2', 'CidrBlock': '10.40.0.0/16', 'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'vpc-0d9aeb3594c89770e..10.40.0.0/16'}], 'resource_id': 'vpc-0d9aeb3594c89770e', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_nat', 'resource_id': 'vpc-0d9aeb3594c89770e..Name'}]} 
2021-06-06 12:46:56,341 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_acl': [{'NetworkAclId': 'acl-029e6c5da91e489e9', 'VpcId': 'vpc-0d9aeb3594c89770e', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0c78091befe9195b8', 'NetworkAclId': 'acl-029e6c5da91e489e9', 'AssociationId': 'aclassoc-53da1a72', 'resource_id': 'acl-029e6c5da91e489e9..aclassoc-53da1a72'}], 'resource_id': 'acl-029e6c5da91e489e9'}], 'route_table': [{'RouteTableId': 'rtb-06de63e347e6c8259', 'VpcId': 'vpc-0d9aeb3594c89770e', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.40.0.0/16', 'resource_id': 'rtb-06de63e347e6c8259..10.40.0.0/16'}], 'route_table_association': [{'RouteTableId': 'rtb-06de63e347e6c8259', 'AssociationId': 'rtbassoc-05b0235f741a5bd35', 'Main': True, 'resource_id': 'rtb-06de63e347e6c8259..rtbassoc-05b0235f741a5bd35'}], 'resource_id': 'rtb-06de63e347e6c8259'}], 'security_group': [{'GroupId': 'sg-007833b34d0362be4', 'GroupName': 'default', 'VpcId': 'vpc-0d9aeb3594c89770e', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': [], 'PrefixListId': [], 'SourceGroupId': ['sg-007833b34d0362be4'], 'resource_id': 'sg-007833b34d0362be4..all__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-007833b34d0362be4..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-007833b34d0362be4'}], 'subnet': [{'SubnetId': 'subnet-0c78091befe9195b8', 'VpcId': 'vpc-0d9aeb3594c89770e', 'CidrBlock': '10.40.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nat', 'resource_id': 'subnet-0c78091befe9195b8..Name'}], 'resource_id': 'subnet-0c78091befe9195b8'}], 'vpc': [{'VpcId': 'vpc-0d9aeb3594c89770e', 'CidrBlock': '10.40.0.0/16', 'IsDefault': False, 'State': 'pending', 'cidr_association': [{'CidrBlock': '10.40.0.0/16', 'AssociationId': 'vpc-cidr-assoc-0c039af057adc39b2', 'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'vpc-0d9aeb3594c89770e..10.40.0.0/16'}], 'tag': [{'Key': 'Name', 'Value': 'test_vpc_nat', 'resource_id': 'vpc-0d9aeb3594c89770e..Name'}], 'resource_id': 'vpc-0d9aeb3594c89770e'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972809047}
2021-06-06 12:46:56,420 - INFO - Calling modeler on-new-snapshot for timestamp 1622972816286 ...
2021-06-06 12:46:57,480 - INFO - Calling analyzer for timestamp 1622972816286 ...
2021-06-06 12:47:00,898 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:00,898 - INFO - Finished triggering everything for timestamp 1622972816286 after 4.55 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 1.06), ('analyzer', 3.4)]
2021-06-06 12:47:00,898 - INFO - Missing resource id vpc-0d9aeb3594c89770e from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:47:00,899 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyVpcAttribute in us-east-1 at 2021-06-06T09:38:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyVpcAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0d9aeb3594c89770e', 'enableDnsHostnames': {'value': True}}, 'responseElements': {'requestId': '83bf651e-ce3c-4e05-88cf-ec5054062e31', '_return': True}, 'requestID': '83bf651e-ce3c-4e05-88cf-ec5054062e31', 'eventID': '9a3d5a8c-4ddd-4b72-ae42-e4025edd67f5', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:00,899 - INFO - modify vpc - [{'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'vpc-0d9aeb3594c89770e'}]
2021-06-06 12:47:00,921 - INFO - Get previous translated snapshot with timestamp 1622972816286 took 0.02 seconds
2021-06-06 12:47:00,924 - INFO - sub-event will be discarded because no change in resource configuration: {'CidrBlock': '10.40.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-0d9aeb3594c89770e', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-0c039af057adc39b2', 'CidrBlock': '10.40.0.0/16', 'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'vpc-0d9aeb3594c89770e..10.40.0.0/16'}], 'resource_id': 'vpc-0d9aeb3594c89770e', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_nat', 'resource_id': 'vpc-0d9aeb3594c89770e..Name'}]} 
2021-06-06 12:47:00,925 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972816286}
2021-06-06 12:47:00,925 - INFO - Missing resource id acl-029e6c5da91e489e9 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:47:00,925 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:39:09Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:09Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0d9aeb3594c89770e', 'cidrBlock': '10.40.10.0/24', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_nat'}]}]}}, 'responseElements': {'requestId': 'e9caa3d3-6098-4083-83a2-849d2236ccf7', 'subnet': {'subnetId': 'subnet-0c78091befe9195b8', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-0c78091befe9195b8', 'state': 'available', 'vpcId': 'vpc-0d9aeb3594c89770e', 'cidrBlock': '10.40.10.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1f', 'availabilityZoneId': 'use1-az5', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_nat'}]}}}, 'requestID': 'e9caa3d3-6098-4083-83a2-849d2236ccf7', 'eventID': '43a74c91-c42b-4b85-bdab-ed66ebe0f683', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:00,926 - INFO - create subnet - [{'SubnetId': 'subnet-0c78091befe9195b8', 'VpcId': 'vpc-0d9aeb3594c89770e', 'CidrBlock': '10.40.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nat', 'resource_id': 'subnet-0c78091befe9195b8..Name'}], 'resource_id': 'subnet-0c78091befe9195b8'}]
2021-06-06 12:47:00,926 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-0c78091befe9195b8']}]}}}
2021-06-06 12:47:02,267 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-029e6c5da91e489e9', 'VpcId': 'vpc-0d9aeb3594c89770e', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0c78091befe9195b8', 'NetworkAclId': 'acl-029e6c5da91e489e9', 'AssociationId': 'aclassoc-53da1a72', 'resource_id': 'acl-029e6c5da91e489e9..aclassoc-53da1a72'}], 'resource_id': 'acl-029e6c5da91e489e9'}]}
2021-06-06 12:47:02,298 - INFO - Get previous translated snapshot with timestamp 1622972816286 took 0.03 seconds
2021-06-06 12:47:02,302 - INFO - sub-event will be discarded because no change in resource configuration: {'AvailabilityZone': 'us-east-1f', 'CidrBlock': '10.40.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0c78091befe9195b8', 'VpcId': 'vpc-0d9aeb3594c89770e', 'resource_id': 'subnet-0c78091befe9195b8', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nat', 'resource_id': 'subnet-0c78091befe9195b8..Name'}]} 
2021-06-06 12:47:02,306 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-029e6c5da91e489e9', 'VpcId': 'vpc-0d9aeb3594c89770e', 'acl_association': [{'AssociationId': 'aclassoc-53da1a72', 'NetworkAclId': 'acl-029e6c5da91e489e9', 'SubnetId': 'subnet-0c78091befe9195b8', 'resource_id': 'acl-029e6c5da91e489e9..aclassoc-53da1a72'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-029e6c5da91e489e9..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-029e6c5da91e489e9..32767..False'}], 'resource_id': 'acl-029e6c5da91e489e9'} 
2021-06-06 12:47:02,307 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972816286}
2021-06-06 12:47:02,512 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:38:43.432Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'key-pair', 'version': 1.0, 'tags': {'Name': 'test_key'}}
2021-06-06 12:47:02,720 - INFO - User N/A ([APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]) performed PutBucketPolicy in us-east-1 at 2021-06-06T09:38:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:48Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'PutBucketPolicy', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': '[APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]', 'requestParameters': {'bucketPolicy': {'Version': '2012-10-17', 'Statement': [{'Action': ['s3:PutObject'], 'Effect': 'Allow', 'Resource': 'arn:aws:s3:::ll-test-bucket-2796885/AWSLogs/*', 'Principal': {'AWS': ['arn:aws:iam::127311923021:root']}}], 'Id': 'Policy'}, 'bucketName': 'll-test-bucket-2796885', 'Host': 'll-test-bucket-2796885.s3.amazonaws.com', 'policy': ''}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 341, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'YIYljG0UejwDdHn+jEFlop2QiV96xL1vrMPYRVyURO7nITBbFJMAO6XHWeJJRHnWebk9AVUQaV4=', 'bytesTransferredOut': 0}, 'requestID': 'EQWS9PR02T4T85TA', 'eventID': 'dbf3bea4-d551-4f17-9aff-19d11b2ddad7', 'readOnly': False, 'resources': [{'accountId': '139614369439', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::ll-test-bucket-2796885'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:02,720 - INFO - hard-modify inline_policy_bucket - 
2021-06-06 12:47:02,720 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'s3_bucket': {'filters': [{'name': 'BucketArn', 'values': ['arn:aws:s3:::ll-test-bucket-2796885']}]}}}
2021-06-06 12:47:11,487 - INFO - scanned resources: {'s3_bucket': [{'Name': 'll-test-bucket-2796885', 'BucketArn': 'arn:aws:s3:::ll-test-bucket-2796885', 'Location': 'us-east-1', 'IsPublic': False, 'acl': [{'GranteeDisplayName': 'automation', 'GranteeType': 'CanonicalUser', 'Permission': 'FULL_CONTROL', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885..CanonicalUser..FULL_CONTROL'}], 'inline_policy_bucket': [{'PolicyName': 'll-test-bucket-2796885', 'Arn': 'arn:aws:s3:::ll-test-bucket-2796885', 'IsBucketPolicy': True, 'statement': [{'Effect': 'Allow', 'Principal': {'AWS': 'arn:aws:iam::127311923021:root'}, 'Action': 's3:PutObject', 'Resource': 'arn:aws:s3:::ll-test-bucket-2796885/AWSLogs/*', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'}], 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'}], 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'}]}
2021-06-06 12:47:11,526 - INFO - Get previous translated snapshot with timestamp 1622972816286 took 0.04 seconds
2021-06-06 12:47:11,529 - INFO - sub-event will be discarded because no change in resource configuration: {'BucketArn': 'arn:aws:s3:::ll-test-bucket-2796885', 'IsPublic': False, 'Location': 'us-east-1', 'Name': 'll-test-bucket-2796885', 'acl': [{'GranteeDisplayName': 'automation', 'GranteeType': 'CanonicalUser', 'Permission': 'FULL_CONTROL', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885..CanonicalUser..FULL_CONTROL'}], 'inline_policy_bucket': [{'Arn': 'arn:aws:s3:::ll-test-bucket-2796885', 'IsBucketPolicy': True, 'PolicyName': 'll-test-bucket-2796885', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885', 'statement': [{'Action': 's3:PutObject', 'Effect': 'Allow', 'Principal': {'AWS': 'arn:aws:iam::127311923021:root'}, 'Resource': 'arn:aws:s3:::ll-test-bucket-2796885/AWSLogs/*', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'}]}], 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'} 
2021-06-06 12:47:11,530 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972816286}
2021-06-06 12:47:11,723 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateInstanceProfile in us-east-1 at 2021-06-06T09:38:52Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:52Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'CreateInstanceProfile', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceProfileName': 'test_profile_ecs', 'path': '/', 'tags': []}, 'responseElements': {'instanceProfile': {'path': '/', 'instanceProfileName': 'test_profile_ecs', 'instanceProfileId': 'AIPASBANKG2PYCPWKWY5P', 'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'createDate': 'Jun 6, 2021 9:38:52 AM', 'roles': [], 'tags': []}}, 'requestID': '6acab969-fd2f-4c5f-bd72-2cb49b13898c', 'eventID': '40d9bcbf-1e87-4504-8054-52845ef19e67', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:11,723 - INFO - create instance_profile - [{'Name': 'test_profile_ecs', 'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'RoleName': [], 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs'}]
2021-06-06 12:47:11,747 - INFO - Get previous translated snapshot with timestamp 1622972816286 took 0.02 seconds
2021-06-06 12:47:11,751 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {'instance_profile': [{'Name': 'test_profile_ecs', 'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'RoleName': [], 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs'}]}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972816286}
2021-06-06 12:47:11,828 - INFO - Calling modeler on-new-snapshot for timestamp 1622972831724 ...
2021-06-06 12:47:11,874 - INFO - Calling analyzer for timestamp 1622972831724 ...
2021-06-06 12:47:14,863 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:14,863 - INFO - Finished triggering everything for timestamp 1622972831724 after 3.11 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.05), ('analyzer', 2.96)]
2021-06-06 12:47:14,863 - INFO - Missing resource id arn:aws:iam::139614369439:instance-profile/test_profile_ecs from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:47:14,863 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AddRoleToInstanceProfile in us-east-1 at 2021-06-06T09:38:54Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:54Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'AddRoleToInstanceProfile', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceProfileName': 'test_profile_ecs', 'roleName': 'test_role_ecs'}, 'responseElements': None, 'requestID': 'fc762cbe-ac63-466c-a9a2-0ee9877614f3', 'eventID': '08f70d6e-f447-41f9-b936-b8edbfbce4b8', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:14,864 - INFO - modify instance_profile - [{'Name': 'test_profile_ecs', 'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'RoleName': 'test_role_ecs', 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs'}]
2021-06-06 12:47:14,889 - INFO - Get previous translated snapshot with timestamp 1622972831724 took 0.02 seconds
2021-06-06 12:47:14,894 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {'instance_profile': [{'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'Name': 'test_profile_ecs', 'RoleName': 'test_role_ecs', 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs'}]}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972831724}
2021-06-06 12:47:14,968 - INFO - Calling modeler on-new-snapshot for timestamp 1622972834865 ...
2021-06-06 12:47:15,047 - INFO - Calling analyzer for timestamp 1622972834865 ...
2021-06-06 12:47:18,022 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:18,022 - INFO - Finished triggering everything for timestamp 1622972834865 after 3.13 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('set_complete', 0.02), ('store_classified', 0.03), ('modeler', 0.08), ('analyzer', 2.95)]
2021-06-06 12:47:18,177 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:38:58.873Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 1.0, 'tags': {'Name': 'test_subnet_alb_2'}}
2021-06-06 12:47:18,337 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:01.584Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'internet-gateway', 'version': 1.0, 'tags': {'Name': 'test_gw'}}
2021-06-06 12:47:18,578 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:38:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:56Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.60.0/24', 'availabilityZone': 'us-east-1a', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_glb_1'}]}]}}, 'responseElements': {'requestId': '9dfd955e-6485-40c0-be50-70d3702deb5b', 'subnet': {'subnetId': 'subnet-0fe138ba19046bb30', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-0fe138ba19046bb30', 'state': 'available', 'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.60.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1a', 'availabilityZoneId': 'use1-az2', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_glb_1'}]}}}, 'requestID': '9dfd955e-6485-40c0-be50-70d3702deb5b', 'eventID': '3a9f4289-a931-4a26-a225-8de1719cafd9', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:18,578 - INFO - create subnet - [{'SubnetId': 'subnet-0fe138ba19046bb30', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.60.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1a', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_glb_1', 'resource_id': 'subnet-0fe138ba19046bb30..Name'}], 'resource_id': 'subnet-0fe138ba19046bb30'}]
2021-06-06 12:47:18,578 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-0fe138ba19046bb30']}]}}}
2021-06-06 12:47:19,425 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-236fae02', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'SubnetId': 'subnet-0e4cc63b267655ade', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-51824270', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'SubnetId': 'subnet-083e75a9da33deaec', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-bffb3b9e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'SubnetId': 'subnet-0fd7e25c7d54404b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-ac18d88d', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'SubnetId': 'subnet-0794a2e17f9656258', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-f9af6fd8', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'SubnetId': 'subnet-08d92349b40b0d5aa', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-65e42444', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'SubnetId': 'subnet-0fe138ba19046bb30', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-96f838b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'SubnetId': 'subnet-09fb08ae68c943ff9', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-cf11d1ee', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'SubnetId': 'subnet-0ed5e44884919419e', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-8e73b2af', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'resource_id': 'acl-087062b72f2321f96'}]}
2021-06-06 12:47:19,462 - INFO - Get previous translated snapshot with timestamp 1622972834865 took 0.04 seconds
2021-06-06 12:47:19,469 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'acl_association': [{'AssociationId': 'aclassoc-236fae02', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0b2f8d86c67729f1a', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'AssociationId': 'aclassoc-51824270', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0e4cc63b267655ade', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'AssociationId': 'aclassoc-bffb3b9e', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-083e75a9da33deaec', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'AssociationId': 'aclassoc-ac18d88d', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'AssociationId': 'aclassoc-f9af6fd8', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0794a2e17f9656258', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'AssociationId': 'aclassoc-65e42444', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'AssociationId': 'aclassoc-96f838b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fe138ba19046bb30', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'AssociationId': 'aclassoc-cf11d1ee', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'AssociationId': 'aclassoc-8e73b2af', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0ed5e44884919419e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'resource_id': 'acl-087062b72f2321f96'} 
2021-06-06 12:47:19,469 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-0fe138ba19046bb30', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.60.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1a', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_glb_1', 'resource_id': 'subnet-0fe138ba19046bb30..Name'}], 'resource_id': 'subnet-0fe138ba19046bb30'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972834865}
2021-06-06 12:47:19,533 - INFO - Calling modeler on-new-snapshot for timestamp 1622972839425 ...
2021-06-06 12:47:19,810 - INFO - Calling analyzer for timestamp 1622972839425 ...
2021-06-06 12:47:23,138 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:23,139 - INFO - Finished triggering everything for timestamp 1622972839425 after 3.67 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.28), ('analyzer', 3.3)]
2021-06-06 12:47:24,014 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:38:57Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:57Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.70.0/24', 'availabilityZone': 'us-east-1b', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_glb_2'}]}]}}, 'responseElements': {'requestId': 'f7905fd2-e4f1-4bcd-8128-e6a3ec68bc5f', 'subnet': {'subnetId': 'subnet-0b2f8d86c67729f1a', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-0b2f8d86c67729f1a', 'state': 'available', 'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.70.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1b', 'availabilityZoneId': 'use1-az4', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_glb_2'}]}}}, 'requestID': 'f7905fd2-e4f1-4bcd-8128-e6a3ec68bc5f', 'eventID': 'a5d1c589-5500-4630-89fe-45f5b5fa5d70', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:24,014 - INFO - create subnet - [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.70.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_glb_2', 'resource_id': 'subnet-0b2f8d86c67729f1a..Name'}], 'resource_id': 'subnet-0b2f8d86c67729f1a'}]
2021-06-06 12:47:24,014 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-0b2f8d86c67729f1a']}]}}}
2021-06-06 12:47:24,836 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-236fae02', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'SubnetId': 'subnet-0e4cc63b267655ade', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-51824270', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'SubnetId': 'subnet-083e75a9da33deaec', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-bffb3b9e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'SubnetId': 'subnet-0fd7e25c7d54404b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-ac18d88d', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'SubnetId': 'subnet-0794a2e17f9656258', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-f9af6fd8', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'SubnetId': 'subnet-08d92349b40b0d5aa', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-65e42444', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'SubnetId': 'subnet-0fe138ba19046bb30', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-96f838b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'SubnetId': 'subnet-09fb08ae68c943ff9', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-cf11d1ee', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'SubnetId': 'subnet-0ed5e44884919419e', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-8e73b2af', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'resource_id': 'acl-087062b72f2321f96'}]}
2021-06-06 12:47:24,898 - INFO - Get previous translated snapshot with timestamp 1622972839425 took 0.06 seconds
2021-06-06 12:47:24,907 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'acl_association': [{'AssociationId': 'aclassoc-236fae02', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0b2f8d86c67729f1a', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'AssociationId': 'aclassoc-51824270', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0e4cc63b267655ade', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'AssociationId': 'aclassoc-bffb3b9e', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-083e75a9da33deaec', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'AssociationId': 'aclassoc-ac18d88d', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'AssociationId': 'aclassoc-f9af6fd8', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0794a2e17f9656258', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'AssociationId': 'aclassoc-65e42444', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'AssociationId': 'aclassoc-96f838b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fe138ba19046bb30', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'AssociationId': 'aclassoc-cf11d1ee', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'AssociationId': 'aclassoc-8e73b2af', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0ed5e44884919419e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'resource_id': 'acl-087062b72f2321f96'} 
2021-06-06 12:47:24,907 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.70.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_glb_2', 'resource_id': 'subnet-0b2f8d86c67729f1a..Name'}], 'resource_id': 'subnet-0b2f8d86c67729f1a'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972839425}
2021-06-06 12:47:24,971 - INFO - Calling modeler on-new-snapshot for timestamp 1622972844837 ...
2021-06-06 12:47:25,238 - INFO - Calling analyzer for timestamp 1622972844837 ...
2021-06-06 12:47:28,426 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:28,426 - INFO - Finished triggering everything for timestamp 1622972844837 after 3.52 seconds! times: [('store_sub_events', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('modeler', 0.27), ('analyzer', 3.17)]
2021-06-06 12:47:28,588 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:38:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:56Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.30.0/24', 'availabilityZone': 'us-east-1b', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_alb_2'}]}]}}, 'responseElements': {'requestId': '0e095b8a-3250-4bbd-bdb4-c77dc418a632', 'subnet': {'subnetId': 'subnet-0ed5e44884919419e', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-0ed5e44884919419e', 'state': 'available', 'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.30.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1b', 'availabilityZoneId': 'use1-az4', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_alb_2'}]}}}, 'requestID': '0e095b8a-3250-4bbd-bdb4-c77dc418a632', 'eventID': 'fd3c1341-bb8e-4e56-a7ba-899a6536aa63', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:28,588 - INFO - create subnet - [{'SubnetId': 'subnet-0ed5e44884919419e', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.30.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_alb_2', 'resource_id': 'subnet-0ed5e44884919419e..Name'}], 'resource_id': 'subnet-0ed5e44884919419e'}]
2021-06-06 12:47:28,588 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-0ed5e44884919419e']}]}}}
2021-06-06 12:47:29,926 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-236fae02', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'SubnetId': 'subnet-0e4cc63b267655ade', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-51824270', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'SubnetId': 'subnet-083e75a9da33deaec', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-bffb3b9e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'SubnetId': 'subnet-0fd7e25c7d54404b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-ac18d88d', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'SubnetId': 'subnet-0794a2e17f9656258', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-f9af6fd8', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'SubnetId': 'subnet-08d92349b40b0d5aa', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-65e42444', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'SubnetId': 'subnet-0fe138ba19046bb30', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-96f838b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'SubnetId': 'subnet-09fb08ae68c943ff9', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-cf11d1ee', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'SubnetId': 'subnet-0ed5e44884919419e', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-8e73b2af', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'resource_id': 'acl-087062b72f2321f96'}]}
2021-06-06 12:47:29,951 - INFO - Get previous translated snapshot with timestamp 1622972844837 took 0.02 seconds
2021-06-06 12:47:29,958 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'acl_association': [{'AssociationId': 'aclassoc-236fae02', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0b2f8d86c67729f1a', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'AssociationId': 'aclassoc-51824270', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0e4cc63b267655ade', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'AssociationId': 'aclassoc-bffb3b9e', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-083e75a9da33deaec', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'AssociationId': 'aclassoc-ac18d88d', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'AssociationId': 'aclassoc-f9af6fd8', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0794a2e17f9656258', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'AssociationId': 'aclassoc-65e42444', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'AssociationId': 'aclassoc-96f838b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fe138ba19046bb30', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'AssociationId': 'aclassoc-cf11d1ee', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'AssociationId': 'aclassoc-8e73b2af', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0ed5e44884919419e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'resource_id': 'acl-087062b72f2321f96'} 
2021-06-06 12:47:29,959 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-0ed5e44884919419e', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.30.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_alb_2', 'resource_id': 'subnet-0ed5e44884919419e..Name'}], 'resource_id': 'subnet-0ed5e44884919419e'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972844837}
2021-06-06 12:47:30,018 - INFO - Calling modeler on-new-snapshot for timestamp 1622972849927 ...
2021-06-06 12:47:30,271 - INFO - Calling analyzer for timestamp 1622972849927 ...
2021-06-06 12:47:33,390 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:33,390 - INFO - Finished triggering everything for timestamp 1622972849927 after 3.43 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.25), ('analyzer', 3.1)]
2021-06-06 12:47:33,622 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:03.593Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 1.0, 'tags': {'Name': 'test_subnet_nlb_1'}}
2021-06-06 12:47:34,597 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateTargetGroup in us-east-1 at 2021-06-06T09:38:59Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:59Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'CreateTargetGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'protocol': 'GENEVE', 'targetType': 'instance', 'vpcId': 'vpc-0f057794b5da52459', 'port': 6081, 'name': 'test-target-group'}, 'responseElements': {'targetGroups': [{'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/009772b3216110f0ae', 'healthCheckPort': '80', 'healthCheckEnabled': True, 'healthCheckTimeoutSeconds': 5, 'protocol': 'GENEVE', 'healthCheckProtocol': 'TCP', 'unhealthyThresholdCount': 3, 'healthCheckIntervalSeconds': 10, 'port': 6081, 'targetGroupName': 'test-target-group', 'vpcId': 'vpc-0f057794b5da52459', 'targetType': 'instance', 'healthyThresholdCount': 3}]}, 'requestID': '111b42b7-1a3b-45e5-967b-78458da934b5', 'eventID': 'd3a00eab-aeb5-4d4a-aca1-a42fe7604729', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:34,597 - INFO - create target_group - [{'TargetType': 'instance', 'VpcId': 'vpc-0f057794b5da52459', 'Protocol': 'GENEVE', 'Port': 6081, 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/009772b3216110f0ae', 'TargetGroupName': 'test-target-group', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/009772b3216110f0ae'}]
2021-06-06 12:47:34,629 - INFO - Get previous translated snapshot with timestamp 1622972849927 took 0.03 seconds
2021-06-06 12:47:34,633 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'target_group': [{'TargetType': 'instance', 'VpcId': 'vpc-0f057794b5da52459', 'Protocol': 'GENEVE', 'Port': 6081, 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/009772b3216110f0ae', 'TargetGroupName': 'test-target-group', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/009772b3216110f0ae'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972849927}
2021-06-06 12:47:34,694 - INFO - Calling modeler on-new-snapshot for timestamp 1622972854597 ...
2021-06-06 12:47:34,734 - INFO - Calling analyzer for timestamp 1622972854597 ...
2021-06-06 12:47:37,896 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:37,896 - INFO - Finished triggering everything for timestamp 1622972854597 after 3.27 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 3.14)]
2021-06-06 12:47:38,128 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateInternetGateway in us-east-1 at 2021-06-06T09:38:59Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:59Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'tagSpecificationSet': {'items': [{'resourceType': 'internet-gateway', 'tags': [{'key': 'Name', 'value': 'test_gw'}]}]}}, 'responseElements': {'requestId': 'e0d3e99f-eff3-4306-8efd-02f1fab4a3ab', 'internetGateway': {'internetGatewayId': 'igw-09d1e6d636d27b816', 'ownerId': '139614369439', 'attachmentSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_gw'}]}, 'association': {}}}, 'requestID': 'e0d3e99f-eff3-4306-8efd-02f1fab4a3ab', 'eventID': '7a870b54-cfcd-4c72-b158-9aaeb6030541', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:38,128 - INFO - create internet_gateway - [{'InternetGatewayId': 'igw-09d1e6d636d27b816', 'tag': [{'Key': 'Name', 'Value': 'test_gw', 'resource_id': 'igw-09d1e6d636d27b816..Name'}], 'resource_id': 'igw-09d1e6d636d27b816'}]
2021-06-06 12:47:38,154 - INFO - Get previous translated snapshot with timestamp 1622972854597 took 0.03 seconds
2021-06-06 12:47:38,158 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'internet_gateway': [{'InternetGatewayId': 'igw-09d1e6d636d27b816', 'tag': [{'Key': 'Name', 'Value': 'test_gw', 'resource_id': 'igw-09d1e6d636d27b816..Name'}], 'resource_id': 'igw-09d1e6d636d27b816'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972854597}
2021-06-06 12:47:38,223 - INFO - Calling modeler on-new-snapshot for timestamp 1622972858129 ...
2021-06-06 12:47:38,304 - INFO - Calling analyzer for timestamp 1622972858129 ...
2021-06-06 12:47:41,563 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:41,563 - INFO - Finished triggering everything for timestamp 1622972858129 after 3.39 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.08), ('analyzer', 3.23)]
2021-06-06 12:47:41,564 - INFO - Missing resource id igw-09d1e6d636d27b816 from previous event got added, not retrying failed event due to time passed 480
2021-06-06 12:47:41,815 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSecurityGroup in us-east-1 at 2021-06-06T09:39:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:00Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupName': 'test_security_group_nat', 'groupDescription': 'Managed by Terraform', 'vpcId': 'vpc-0f057794b5da52459', 'tagSpecificationSet': {'items': [{'resourceType': 'security-group', 'tags': [{'key': 'Name', 'value': 'test_security_group_nat'}]}]}}, 'responseElements': {'requestId': 'bdccf0e3-8869-4200-b507-ae6bf223da1f', '_return': True, 'groupId': 'sg-08eb478817b54e9c3', 'tagSet': {'items': [{'key': 'Name', 'value': 'test_security_group_nat'}]}}, 'requestID': 'bdccf0e3-8869-4200-b507-ae6bf223da1f', 'eventID': 'ff703b30-9916-4ec7-beeb-319b0e80f6ae', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:41,815 - INFO - create security_group - [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]
2021-06-06 12:47:41,815 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08eb478817b54e9c3']}]}}}
2021-06-06 12:47:44,079 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]}
2021-06-06 12:47:44,107 - INFO - Get previous translated snapshot with timestamp 1622972858129 took 0.03 seconds
2021-06-06 12:47:44,111 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'security_group': [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972858129}
2021-06-06 12:47:44,173 - INFO - Calling modeler on-new-snapshot for timestamp 1622972864079 ...
2021-06-06 12:47:44,489 - INFO - Calling analyzer for timestamp 1622972864079 ...
2021-06-06 12:47:47,791 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:47,791 - INFO - Finished triggering everything for timestamp 1622972864079 after 3.68 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.32), ('analyzer', 3.27)]
2021-06-06 12:47:47,791 - INFO - Missing resource id sg-08eb478817b54e9c3 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:47:47,791 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RevokeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:01Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:01Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RevokeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-08eb478817b54e9c3', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '91267072-3c42-4f3d-a0d1-7fd617a282d2', '_return': True}, 'requestID': '91267072-3c42-4f3d-a0d1-7fd617a282d2', 'eventID': 'abb8a47a-cd39-4276-8d7c-fa96b8316fc7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:47,792 - INFO - modify security_group - [{'GroupId': 'sg-08eb478817b54e9c3', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-08eb478817b54e9c3..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-08eb478817b54e9c3'}]
2021-06-06 12:47:47,792 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08eb478817b54e9c3']}]}}}
2021-06-06 12:47:48,667 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]}
2021-06-06 12:47:48,695 - INFO - Get previous translated snapshot with timestamp 1622972864079 took 0.03 seconds
2021-06-06 12:47:48,698 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-08eb478817b54e9c3', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}]} 
2021-06-06 12:47:48,699 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972864079}
2021-06-06 12:47:48,699 - INFO - Missing resource id sg-08eb478817b54e9c3 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:47:48,699 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupIngress in us-east-1 at 2021-06-06T09:39:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupIngress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-08eb478817b54e9c3', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '0492d8fe-61c4-4b4d-a286-6a4afba3759c', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-08eb478817b54e9c3', 'securityGroupRuleId': 'sgr-0fe3afca4c22744f8', 'isEgress': False, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': '0492d8fe-61c4-4b4d-a286-6a4afba3759c', 'eventID': '90676f37-eb1c-4a2c-af9d-19012e14555c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:48,699 - INFO - modify security_group - [{'GroupId': 'sg-08eb478817b54e9c3', 'security_ingress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [{}], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..0..0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'DestinationGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3__egress_rule'}], 'resource_id': 'sg-08eb478817b54e9c3'}]
2021-06-06 12:47:48,699 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08eb478817b54e9c3']}]}}}
2021-06-06 12:47:50,508 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]}
2021-06-06 12:47:50,532 - INFO - Get previous translated snapshot with timestamp 1622972864079 took 0.02 seconds
2021-06-06 12:47:50,536 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-08eb478817b54e9c3', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}]} 
2021-06-06 12:47:50,537 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972864079}
2021-06-06 12:47:50,712 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSecurityGroup in us-east-1 at 2021-06-06T09:38:59Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:38:59Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupName': 'test_security_group', 'groupDescription': 'Managed by Terraform', 'vpcId': 'vpc-0f057794b5da52459', 'tagSpecificationSet': {'items': [{'resourceType': 'security-group', 'tags': [{'key': 'Name', 'value': 'test_security_group'}]}]}}, 'responseElements': {'requestId': '73f016cb-7635-4551-b9d3-3f2810158481', '_return': True, 'groupId': 'sg-0af2498b5cbd583f6', 'tagSet': {'items': [{'key': 'Name', 'value': 'test_security_group'}]}}, 'requestID': '73f016cb-7635-4551-b9d3-3f2810158481', 'eventID': '24cec61d-6659-4084-bafa-e218b51ea17e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:50,712 - INFO - create security_group - [{'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]
2021-06-06 12:47:50,712 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0af2498b5cbd583f6']}]}}}
2021-06-06 12:47:51,501 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]}
2021-06-06 12:47:51,531 - INFO - Get previous translated snapshot with timestamp 1622972864079 took 0.03 seconds
2021-06-06 12:47:51,536 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-0af2498b5cbd583f6', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}]} 
2021-06-06 12:47:51,537 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972864079}
2021-06-06 12:47:51,917 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:39:01Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:01Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.40.0/24', 'availabilityZone': 'us-east-1e', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_nlb_1'}]}]}}, 'responseElements': {'requestId': '179ea8ab-5ba0-421c-9ff4-fecee2e82d80', 'subnet': {'subnetId': 'subnet-08d92349b40b0d5aa', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-08d92349b40b0d5aa', 'state': 'available', 'vpcId': 'vpc-0f057794b5da52459', 'cidrBlock': '10.10.40.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1e', 'availabilityZoneId': 'use1-az3', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_nlb_1'}]}}}, 'requestID': '179ea8ab-5ba0-421c-9ff4-fecee2e82d80', 'eventID': 'f3d05540-88d1-409c-b9dc-c7b58d2a51df', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:51,917 - INFO - create subnet - [{'SubnetId': 'subnet-08d92349b40b0d5aa', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.40.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1e', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nlb_1', 'resource_id': 'subnet-08d92349b40b0d5aa..Name'}], 'resource_id': 'subnet-08d92349b40b0d5aa'}]
2021-06-06 12:47:51,917 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-08d92349b40b0d5aa']}]}}}
2021-06-06 12:47:53,361 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0b2f8d86c67729f1a', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-236fae02', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'SubnetId': 'subnet-0e4cc63b267655ade', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-51824270', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'SubnetId': 'subnet-083e75a9da33deaec', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-bffb3b9e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'SubnetId': 'subnet-0fd7e25c7d54404b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-ac18d88d', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'SubnetId': 'subnet-0794a2e17f9656258', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-f9af6fd8', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'SubnetId': 'subnet-08d92349b40b0d5aa', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-65e42444', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'SubnetId': 'subnet-0fe138ba19046bb30', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-96f838b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'SubnetId': 'subnet-09fb08ae68c943ff9', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-cf11d1ee', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'SubnetId': 'subnet-0ed5e44884919419e', 'NetworkAclId': 'acl-087062b72f2321f96', 'AssociationId': 'aclassoc-8e73b2af', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'resource_id': 'acl-087062b72f2321f96'}]}
2021-06-06 12:47:53,388 - INFO - Get previous translated snapshot with timestamp 1622972864079 took 0.03 seconds
2021-06-06 12:47:53,396 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-087062b72f2321f96', 'VpcId': 'vpc-0f057794b5da52459', 'acl_association': [{'AssociationId': 'aclassoc-236fae02', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0b2f8d86c67729f1a', 'resource_id': 'acl-087062b72f2321f96..aclassoc-236fae02'}, {'AssociationId': 'aclassoc-51824270', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0e4cc63b267655ade', 'resource_id': 'acl-087062b72f2321f96..aclassoc-51824270'}, {'AssociationId': 'aclassoc-bffb3b9e', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-083e75a9da33deaec', 'resource_id': 'acl-087062b72f2321f96..aclassoc-bffb3b9e'}, {'AssociationId': 'aclassoc-ac18d88d', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'resource_id': 'acl-087062b72f2321f96..aclassoc-ac18d88d'}, {'AssociationId': 'aclassoc-f9af6fd8', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0794a2e17f9656258', 'resource_id': 'acl-087062b72f2321f96..aclassoc-f9af6fd8'}, {'AssociationId': 'aclassoc-65e42444', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'resource_id': 'acl-087062b72f2321f96..aclassoc-65e42444'}, {'AssociationId': 'aclassoc-96f838b7', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0fe138ba19046bb30', 'resource_id': 'acl-087062b72f2321f96..aclassoc-96f838b7'}, {'AssociationId': 'aclassoc-cf11d1ee', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'resource_id': 'acl-087062b72f2321f96..aclassoc-cf11d1ee'}, {'AssociationId': 'aclassoc-8e73b2af', 'NetworkAclId': 'acl-087062b72f2321f96', 'SubnetId': 'subnet-0ed5e44884919419e', 'resource_id': 'acl-087062b72f2321f96..aclassoc-8e73b2af'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-087062b72f2321f96..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-087062b72f2321f96..32767..False'}], 'resource_id': 'acl-087062b72f2321f96'} 
2021-06-06 12:47:53,396 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-08d92349b40b0d5aa', 'VpcId': 'vpc-0f057794b5da52459', 'CidrBlock': '10.10.40.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1e', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nlb_1', 'resource_id': 'subnet-08d92349b40b0d5aa..Name'}], 'resource_id': 'subnet-08d92349b40b0d5aa'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972864079}
2021-06-06 12:47:53,457 - INFO - Calling modeler on-new-snapshot for timestamp 1622972873361 ...
2021-06-06 12:47:53,792 - INFO - Calling analyzer for timestamp 1622972873361 ...
2021-06-06 12:47:57,115 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:47:57,115 - INFO - Finished triggering everything for timestamp 1622972873361 after 3.71 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.33), ('analyzer', 3.3)]
2021-06-06 12:47:57,268 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0af2498b5cbd583f6', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '26faa6a3-674b-43d5-87c3-1dff146f86fc', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-0af2498b5cbd583f6', 'securityGroupRuleId': 'sgr-019c9353dc15a0403', 'isEgress': True, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': '26faa6a3-674b-43d5-87c3-1dff146f86fc', 'eventID': 'a91ff6f4-1a22-4e2c-9802-23c0f931e2fc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:57,268 - INFO - modify security_group - [{'GroupId': 'sg-0af2498b5cbd583f6', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-0af2498b5cbd583f6..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]
2021-06-06 12:47:57,268 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0af2498b5cbd583f6']}]}}}
2021-06-06 12:47:58,092 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}], 'resource_id': 'sg-0af2498b5cbd583f6'}]}
2021-06-06 12:47:58,120 - INFO - Get previous translated snapshot with timestamp 1622972873361 took 0.03 seconds
2021-06-06 12:47:58,124 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0af2498b5cbd583f6', 'GroupName': 'test_security_group', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-0af2498b5cbd583f6', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0af2498b5cbd583f6..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0af2498b5cbd583f6..Name'}]} 
2021-06-06 12:47:58,125 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972873361}
2021-06-06 12:47:58,487 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:04Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-08eb478817b54e9c3', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '25a8e886-03df-4b17-a7ae-69ae0b97527b', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-08eb478817b54e9c3', 'securityGroupRuleId': 'sgr-0dee0022469b21513', 'isEgress': True, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': '25a8e886-03df-4b17-a7ae-69ae0b97527b', 'eventID': '896ae497-8f55-42bd-bab8-50c390c5d5c0', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:58,492 - INFO - modify security_group - [{'GroupId': 'sg-08eb478817b54e9c3', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-08eb478817b54e9c3..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-08eb478817b54e9c3'}]
2021-06-06 12:47:58,492 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08eb478817b54e9c3']}]}}}
2021-06-06 12:47:59,267 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}], 'resource_id': 'sg-08eb478817b54e9c3'}]}
2021-06-06 12:47:59,328 - INFO - Get previous translated snapshot with timestamp 1622972873361 took 0.06 seconds
2021-06-06 12:47:59,332 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-08eb478817b54e9c3', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'sg-08eb478817b54e9c3', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08eb478817b54e9c3..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-08eb478817b54e9c3..Name'}]} 
2021-06-06 12:47:59,332 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972873361}
2021-06-06 12:47:59,507 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AttachInternetGateway in us-east-1 at 2021-06-06T09:39:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:04Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AttachInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-0b3942a9b4b34a45e', 'vpcId': 'vpc-0a880421f072a8186'}, 'responseElements': {'requestId': '83f67f30-932c-46fc-aef9-47d8af6884ec', '_return': True}, 'requestID': '83f67f30-932c-46fc-aef9-47d8af6884ec', 'eventID': '7f54de19-4b28-4be6-b0ca-c9ae2e840410', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:47:59,507 - INFO - add internet_gateway_attachment - [{'InternetGatewayId': 'igw-0b3942a9b4b34a45e', 'VpcId': 'vpc-0a880421f072a8186', 'State': 'available', 'resource_id': 'igw-0b3942a9b4b34a45e..vpc-0a880421f072a8186'}]
2021-06-06 12:47:59,541 - INFO - Get previous translated snapshot with timestamp 1622972873361 took 0.03 seconds
2021-06-06 12:47:59,546 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'internet_gateway': [{'InternetGatewayId': 'igw-0b3942a9b4b34a45e', 'resource_id': 'igw-0b3942a9b4b34a45e', 'tag': [{'Key': 'Name', 'Value': 'test_gw_2', 'resource_id': 'igw-0b3942a9b4b34a45e..Name'}], 'internet_gateway_attachment': [{'InternetGatewayId': 'igw-0b3942a9b4b34a45e', 'VpcId': 'vpc-0a880421f072a8186', 'State': 'available', 'resource_id': 'igw-0b3942a9b4b34a45e..vpc-0a880421f072a8186'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972873361}
2021-06-06 12:47:59,615 - INFO - Calling modeler on-new-snapshot for timestamp 1622972879507 ...
2021-06-06 12:47:59,767 - INFO - Calling analyzer for timestamp 1622972879507 ...
2021-06-06 12:48:03,066 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:03,066 - INFO - Finished triggering everything for timestamp 1622972879507 after 3.52 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.15), ('analyzer', 3.28)]
2021-06-06 12:48:03,227 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:08.000Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': 'd721ee73-c6c1-43a5-8189-a241a0426ef7'}
2021-06-06 12:48:03,404 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:39:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:04Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-0f06fc190dd71269e', 'minCount': 1, 'maxCount': 1}]}, 'userData': '<sensitiveDataRemoved>', 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': 'BED8BD1C-EA3B-4C7E-BB9F-75B9478C965B', 'iamInstanceProfile': {'name': 'test_profile_ecs'}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_ecs'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': 'd721ee73-c6c1-43a5-8189-a241a0426ef7', 'reservationId': 'r-06392e3a52901b5c7', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-09bd4d3233e68e8cc', 'imageId': 'ami-0f06fc190dd71269e', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-172-31-0-227.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972344000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'privateIpAddress': '172.31.0.227', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/xvda', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_ecs'}]}, 'clientToken': 'BED8BD1C-EA3B-4C7E-BB9F-75B9478C965B', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-061850d4e2549fec2', 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:53:10:d1:23:b5', 'privateIpAddress': '172.31.0.227', 'privateDnsName': 'ip-172-31-0-227.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'attachment': {'attachmentId': 'eni-attach-0627b9510de14b311', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972344000, 'deleteOnTermination': True}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '172.31.0.227', 'privateDnsName': 'ip-172-31-0-227.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'id': 'AIPASBANKG2PYCPWKWY5P'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': 'd721ee73-c6c1-43a5-8189-a241a0426ef7', 'eventID': '1e58c0ee-13bc-4179-9ff6-47bd6d467b63', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:03,419 - INFO - create instance - [{'PrivateIpAddress': '172.31.0.227', 'SourceDestCheck': True, 'InstanceId': 'i-09bd4d3233e68e8cc', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'ImageId': 'ami-0f06fc190dd71269e', 'tag': [{'Key': 'Name', 'Value': 'test-instance_ecs', 'resource_id': 'i-09bd4d3233e68e8cc..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-09bd4d3233e68e8cc'}]
2021-06-06 12:48:03,419 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-09bd4d3233e68e8cc']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:48:04,948 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-061850d4e2549fec2', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.0.227', 'DnsName': 'ip-172-31-0-227.ec2.internal', 'MacAddress': '12:53:10:d1:23:b5', 'PublicIpAddress': '3.87.66.2', 'PublicDnsName': 'ec2-3-87-66-2.compute-1.amazonaws.com', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-09bd4d3233e68e8cc', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0627b9510de14b311', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.0.227', 'NetworkInterfaceId': 'eni-061850d4e2549fec2', 'resource_id': 'eni-061850d4e2549fec2..172.31.0.227'}], 'resource_id': 'eni-061850d4e2549fec2'}]}
2021-06-06 12:48:04,948 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-fee06cc9']}]}}}
2021-06-06 12:48:05,867 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-fee06cc9', 'GroupName': 'default', 'VpcId': 'vpc-3a02dc47', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': [], 'PrefixListId': [], 'SourceGroupId': ['sg-fee06cc9'], 'resource_id': 'sg-fee06cc9..all__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-fee06cc9..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-fee06cc9'}]}
2021-06-06 12:48:05,867 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-09bd4d3233e68e8cc']}]}}}
2021-06-06 12:48:07,291 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-0fa8073fdc1939463', 'VolumeSize': 30, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0c33eff6f4fd1844f', 'VolumeFirstInstanceId': 'i-09bd4d3233e68e8cc', 'volume_attachment': [{'InstanceId': 'i-09bd4d3233e68e8cc', 'VolumeId': 'vol-0fa8073fdc1939463', 'State': 'attached', 'Device': '/dev/xvda', 'resource_id': 'vol-0fa8073fdc1939463..i-09bd4d3233e68e8cc'}], 'resource_id': 'vol-0fa8073fdc1939463'}]}
2021-06-06 12:48:07,317 - INFO - Get previous translated snapshot with timestamp 1622972879507 took 0.03 seconds
2021-06-06 12:48:07,326 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-fee06cc9', 'GroupName': 'default', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'sg-fee06cc9', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-fee06cc9..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-fee06cc9'], 'resource_id': 'sg-fee06cc9..all__ingress_rule'}]} 
2021-06-06 12:48:07,329 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance_volume': [{'VolumeId': 'vol-0fa8073fdc1939463', 'VolumeSize': 30, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0c33eff6f4fd1844f', 'VolumeFirstInstanceId': 'i-09bd4d3233e68e8cc', 'volume_attachment': [{'InstanceId': 'i-09bd4d3233e68e8cc', 'VolumeId': 'vol-0fa8073fdc1939463', 'State': 'attached', 'Device': '/dev/xvda', 'resource_id': 'vol-0fa8073fdc1939463..i-09bd4d3233e68e8cc'}], 'resource_id': 'vol-0fa8073fdc1939463'}], 'network_interface': [{'NetworkInterfaceId': 'eni-061850d4e2549fec2', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.0.227', 'DnsName': 'ip-172-31-0-227.ec2.internal', 'MacAddress': '12:53:10:d1:23:b5', 'PublicIpAddress': '3.87.66.2', 'PublicDnsName': 'ec2-3-87-66-2.compute-1.amazonaws.com', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-09bd4d3233e68e8cc', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0627b9510de14b311', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.0.227', 'NetworkInterfaceId': 'eni-061850d4e2549fec2', 'resource_id': 'eni-061850d4e2549fec2..172.31.0.227'}], 'resource_id': 'eni-061850d4e2549fec2'}]}, 'modified': {'instance': [{'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-09bd4d3233e68e8cc', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.0.227', 'PublicDnsName': 'ec2-3-87-66-2.compute-1.amazonaws.com', 'PublicIpAddress': '3.87.66.2', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-09bd4d3233e68e8cc', 'tag': [{'Key': 'Name', 'Value': 'test-instance_ecs', 'resource_id': 'i-09bd4d3233e68e8cc..Name'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972879507}
2021-06-06 12:48:07,411 - INFO - Calling modeler on-new-snapshot for timestamp 1622972887291 ...
2021-06-06 12:48:08,009 - INFO - Calling analyzer for timestamp 1622972887291 ...
2021-06-06 12:48:12,841 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:12,841 - INFO - Finished triggering everything for timestamp 1622972887291 after 5.51 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.6), ('analyzer', 4.81)]
2021-06-06 12:48:13,696 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:08.777Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 1.0, 'tags': {'Name': 'test_subnet_vpce_1'}}
2021-06-06 12:48:13,857 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:06Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0de1fb53a270d5776', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '1d50e23f-60af-4c63-9517-4c4cf41abd94', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-0de1fb53a270d5776', 'securityGroupRuleId': 'sgr-0c8a155702376c74d', 'isEgress': True, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': '1d50e23f-60af-4c63-9517-4c4cf41abd94', 'eventID': '3663a560-5a4b-43da-8c07-6d67471485ed', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:13,861 - INFO - modify security_group - [{'GroupId': 'sg-0de1fb53a270d5776', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-0de1fb53a270d5776..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-0de1fb53a270d5776'}]
2021-06-06 12:48:13,861 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0de1fb53a270d5776']}]}}}
2021-06-06 12:48:14,667 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0de1fb53a270d5776', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-0a880421f072a8186', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0de1fb53a270d5776..Name'}], 'resource_id': 'sg-0de1fb53a270d5776'}]}
2021-06-06 12:48:14,695 - INFO - Get previous translated snapshot with timestamp 1622972887291 took 0.03 seconds
2021-06-06 12:48:14,698 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0de1fb53a270d5776', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'sg-0de1fb53a270d5776', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0de1fb53a270d5776..Name'}]} 
2021-06-06 12:48:14,699 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972887291}
2021-06-06 12:48:14,863 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RevokeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:05Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:05Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RevokeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-08b4e6d72763b3889', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '40161e33-b2df-448f-be96-5d9843f3f6c0', '_return': True}, 'requestID': '40161e33-b2df-448f-be96-5d9843f3f6c0', 'eventID': '76d874cf-00b9-4eac-9268-220a3db9899e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:14,864 - INFO - modify security_group - [{'GroupId': 'sg-08b4e6d72763b3889', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-08b4e6d72763b3889..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-08b4e6d72763b3889'}]
2021-06-06 12:48:14,864 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08b4e6d72763b3889']}]}}}
2021-06-06 12:48:15,608 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08b4e6d72763b3889', 'GroupName': 'test_security_group_3', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_3', 'resource_id': 'sg-08b4e6d72763b3889..Name'}], 'resource_id': 'sg-08b4e6d72763b3889'}]}
2021-06-06 12:48:15,631 - INFO - Get previous translated snapshot with timestamp 1622972887291 took 0.02 seconds
2021-06-06 12:48:15,635 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-08b4e6d72763b3889', 'GroupName': 'test_security_group_3', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'resource_id': 'sg-08b4e6d72763b3889', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_3', 'resource_id': 'sg-08b4e6d72763b3889..Name'}]} 
2021-06-06 12:48:15,636 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972887291}
2021-06-06 12:48:15,790 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RegisterScalableTarget in us-east-1 at 2021-06-06T09:39:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:08Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'RegisterScalableTarget', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'serviceNamespace': 'ecs', 'resourceId': 'service/test_ecs_cluster/test_ecs_service', 'scalableDimension': 'ecs:service:DesiredCount', 'minCapacity': 1, 'maxCapacity': 4}, 'responseElements': None, 'additionalEventData': {'service': 'application-autoscaling'}, 'requestID': '0150d429-4ae8-47de-962a-7d424c762f8f', 'eventID': '8a522fbc-c720-49c1-aac9-6479b06b8cd6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:15,987 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RevokeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:09Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:09Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RevokeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-06513cfe251115cb0', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': '221b2c00-10ff-4a5c-aebb-082ee5f8a625', '_return': True}, 'requestID': '221b2c00-10ff-4a5c-aebb-082ee5f8a625', 'eventID': '49e291e8-3e8a-49c2-ae9b-7508fc3948bf', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:15,987 - INFO - modify security_group - [{'GroupId': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-06513cfe251115cb0..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-06513cfe251115cb0'}]
2021-06-06 12:48:15,987 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-06513cfe251115cb0']}]}}}
2021-06-06 12:48:17,537 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}], 'resource_id': 'sg-06513cfe251115cb0'}]}
2021-06-06 12:48:17,578 - INFO - Get previous translated snapshot with timestamp 1622972887291 took 0.04 seconds
2021-06-06 12:48:17,582 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}]} 
2021-06-06 12:48:17,582 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972887291}
2021-06-06 12:48:17,837 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:12Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:12Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0fe138ba19046bb30', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_glb'}]}]}}, 'responseElements': {'requestId': '2a34da0a-8e31-4c4d-9263-316c02242251', 'networkInterface': {'networkInterfaceId': 'eni-0657d4e335bbb4065', 'subnetId': 'subnet-0fe138ba19046bb30', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1a', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '12:16:9e:dd:8a:07', 'privateIpAddress': '10.10.60.46', 'privateDnsName': 'ip-10-10-60-46.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.60.46', 'privateDnsName': 'ip-10-10-60-46.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_glb'}]}}}, 'requestID': '2a34da0a-8e31-4c4d-9263-316c02242251', 'eventID': 'a9df6049-f50b-4fd6-bed7-9ccf3083563e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:17,839 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fe138ba19046bb30', 'PrivateIpAddress': '10.10.60.46', 'MacAddress': '12:16:9e:dd:8a:07', 'GroupId': ['sg-0af2498b5cbd583f6'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_glb', 'resource_id': 'eni-0657d4e335bbb4065..Name'}], 'resource_id': 'eni-0657d4e335bbb4065'}]
2021-06-06 12:48:17,839 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0657d4e335bbb4065']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:48:18,809 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fe138ba19046bb30', 'PrivateIpAddress': '10.10.60.46', 'DnsName': 'ip-10-10-60-46.ec2.internal', 'MacAddress': '12:16:9e:dd:8a:07', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-054b3883381a7f655', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-05a04e1b0165316e7', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.60.46', 'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'resource_id': 'eni-0657d4e335bbb4065..10.10.60.46'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_glb', 'resource_id': 'eni-0657d4e335bbb4065..Name'}], 'resource_id': 'eni-0657d4e335bbb4065'}]}
2021-06-06 12:48:18,836 - INFO - Get previous translated snapshot with timestamp 1622972887291 took 0.03 seconds
2021-06-06 12:48:18,840 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-05a04e1b0165316e7', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-10-10-60-46.ec2.internal', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-054b3883381a7f655', 'InterfaceType': 'interface', 'MacAddress': '12:16:9e:dd:8a:07', 'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'PrivateIpAddress': '10.10.60.46', 'SourceDestCheck': True, 'SubnetId': 'subnet-0fe138ba19046bb30', 'VpcId': 'vpc-0f057794b5da52459', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0657d4e335bbb4065', 'PrivateIpAddress': '10.10.60.46', 'resource_id': 'eni-0657d4e335bbb4065..10.10.60.46'}], 'resource_id': 'eni-0657d4e335bbb4065', 'tag': [{'Key': 'Name', 'Value': 'test_interface_glb', 'resource_id': 'eni-0657d4e335bbb4065..Name'}]} 
2021-06-06 12:48:18,840 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972887291}
2021-06-06 12:48:19,058 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:15Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:15Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-083e75a9da33deaec', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_rds'}]}]}}, 'responseElements': {'requestId': '40e91dc6-ed32-4d38-b1dd-b4b10eec9fa3', 'networkInterface': {'networkInterfaceId': 'eni-086606232e57b4952', 'subnetId': 'subnet-083e75a9da33deaec', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1c', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '0e:1d:a5:6b:3c:a5', 'privateIpAddress': '10.10.80.54', 'privateDnsName': 'ip-10-10-80-54.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.80.54', 'privateDnsName': 'ip-10-10-80-54.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_rds'}]}}}, 'requestID': '40e91dc6-ed32-4d38-b1dd-b4b10eec9fa3', 'eventID': '6dd3299f-912c-4d9e-8feb-80d6d8516c13', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:19,058 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-086606232e57b4952', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.54', 'MacAddress': '0e:1d:a5:6b:3c:a5', 'GroupId': ['sg-0af2498b5cbd583f6'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_rds', 'resource_id': 'eni-086606232e57b4952..Name'}], 'resource_id': 'eni-086606232e57b4952'}]
2021-06-06 12:48:19,059 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-086606232e57b4952']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:48:19,878 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-086606232e57b4952', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.54', 'DnsName': 'ip-10-10-80-54.ec2.internal', 'MacAddress': '0e:1d:a5:6b:3c:a5', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-0244269d751c2a0af', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-08c8a2b6aaedce5a7', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.80.54', 'NetworkInterfaceId': 'eni-086606232e57b4952', 'resource_id': 'eni-086606232e57b4952..10.10.80.54'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_rds', 'resource_id': 'eni-086606232e57b4952..Name'}], 'resource_id': 'eni-086606232e57b4952'}]}
2021-06-06 12:48:19,907 - INFO - Get previous translated snapshot with timestamp 1622972887291 took 0.03 seconds
2021-06-06 12:48:19,910 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-08c8a2b6aaedce5a7', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1c', 'DeviceIndex': 0, 'DnsName': 'ip-10-10-80-54.ec2.internal', 'GroupId': ['sg-0af2498b5cbd583f6'], 'InstanceId': 'i-0244269d751c2a0af', 'InterfaceType': 'interface', 'MacAddress': '0e:1d:a5:6b:3c:a5', 'NetworkInterfaceId': 'eni-086606232e57b4952', 'PrivateIpAddress': '10.10.80.54', 'SourceDestCheck': True, 'SubnetId': 'subnet-083e75a9da33deaec', 'VpcId': 'vpc-0f057794b5da52459', 'private_ip_address': [{'NetworkInterfaceId': 'eni-086606232e57b4952', 'PrivateIpAddress': '10.10.80.54', 'resource_id': 'eni-086606232e57b4952..10.10.80.54'}], 'resource_id': 'eni-086606232e57b4952', 'tag': [{'Key': 'Name', 'Value': 'test_interface_rds', 'resource_id': 'eni-086606232e57b4952..Name'}]} 
2021-06-06 12:48:19,911 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972887291}
2021-06-06 12:48:20,083 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:22Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:22Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:22Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-09fb08ae68c943ff9', 'description': 'ELB net/test-nlb/54a3ea88b666491c', 'groupSet': {}, 'privateIpAddressesSet': {}}, 'responseElements': {'requestId': 'afaf3f77-24d3-4a17-a0d0-8ae5e40dce9a', 'networkInterface': {'networkInterfaceId': 'eni-0d630ebd297ebeb52', 'subnetId': 'subnet-09fb08ae68c943ff9', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1f', 'description': 'ELB net/test-nlb/54a3ea88b666491c', 'ownerId': '139614369439', 'requesterId': '072728369454', 'requesterManaged': True, 'status': 'pending', 'macAddress': '16:22:a6:e3:69:91', 'privateIpAddress': '10.10.50.221', 'privateDnsName': 'ip-10-10-50-221.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0f81d6cfe66d5f79d', 'groupName': 'default'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.50.221', 'privateDnsName': 'ip-10-10-50-221.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': 'afaf3f77-24d3-4a17-a0d0-8ae5e40dce9a', 'eventID': '9d41cb11-a445-4fca-b3b7-aba4228fc0f2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:20,084 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'PrivateIpAddress': '10.10.50.221', 'MacAddress': '16:22:a6:e3:69:91', 'GroupId': ['sg-0f81d6cfe66d5f79d'], 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-0d630ebd297ebeb52'}]
2021-06-06 12:48:20,084 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0d630ebd297ebeb52']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:48:21,628 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'PrivateIpAddress': '10.10.50.221', 'DnsName': 'ip-10-10-50-221.ec2.internal', 'MacAddress': '16:22:a6:e3:69:91', 'PublicIpAddress': '54.146.184.218', 'PublicDnsName': 'ec2-54-146-184-218.compute-1.amazonaws.com', 'GroupId': [], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'ela-attach-09493b93ddf778111', 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'SourceDestCheck': False, 'InterfaceType': 'network_load_balancer', 'private_ip_address': [{'PrivateIpAddress': '10.10.50.221', 'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'resource_id': 'eni-0d630ebd297ebeb52..10.10.50.221'}], 'resource_id': 'eni-0d630ebd297ebeb52'}]}
2021-06-06 12:48:21,664 - INFO - Get previous translated snapshot with timestamp 1622972887291 took 0.03 seconds
2021-06-06 12:48:21,669 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-09fb08ae68c943ff9', 'PrivateIpAddress': '10.10.50.221', 'DnsName': 'ip-10-10-50-221.ec2.internal', 'MacAddress': '16:22:a6:e3:69:91', 'PublicIpAddress': '54.146.184.218', 'PublicDnsName': 'ec2-54-146-184-218.compute-1.amazonaws.com', 'GroupId': [], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'ela-attach-09493b93ddf778111', 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'SourceDestCheck': False, 'InterfaceType': 'network_load_balancer', 'private_ip_address': [{'PrivateIpAddress': '10.10.50.221', 'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'resource_id': 'eni-0d630ebd297ebeb52..10.10.50.221'}], 'resource_id': 'eni-0d630ebd297ebeb52'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972887291}
2021-06-06 12:48:21,730 - INFO - Calling modeler on-new-snapshot for timestamp 1622972901635 ...
2021-06-06 12:48:22,049 - INFO - Calling analyzer for timestamp 1622972901635 ...
2021-06-06 12:48:25,531 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:25,531 - INFO - Finished triggering everything for timestamp 1622972901635 after 3.86 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.32), ('analyzer', 3.46)]
2021-06-06 12:48:25,531 - INFO - Missing resource id eni-0d630ebd297ebeb52 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:48:25,531 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed ModifyNetworkInterfaceAttribute in us-east-1 at 2021-06-06T09:39:23Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:22Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:23Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyNetworkInterfaceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0d630ebd297ebeb52', 'sourceDestCheck': {'value': False}}, 'responseElements': {'requestId': 'aed2ae36-ec0c-43b8-92da-6382e8e2f537', '_return': True}, 'requestID': 'aed2ae36-ec0c-43b8-92da-6382e8e2f537', 'eventID': 'd3843c84-7202-40e5-9b5f-f276592f4a26', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:25,532 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'resource_id': 'eni-0d630ebd297ebeb52'}]
2021-06-06 12:48:25,558 - INFO - Get previous translated snapshot with timestamp 1622972901635 took 0.03 seconds
2021-06-06 12:48:25,563 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'ela-attach-09493b93ddf778111', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-50-221.ec2.internal', 'GroupId': [], 'InterfaceType': 'network_load_balancer', 'MacAddress': '16:22:a6:e3:69:91', 'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'PrivateIpAddress': '10.10.50.221', 'PublicDnsName': 'ec2-54-146-184-218.compute-1.amazonaws.com', 'PublicIpAddress': '54.146.184.218', 'SourceDestCheck': False, 'SubnetId': 'subnet-09fb08ae68c943ff9', 'VpcId': 'vpc-0f057794b5da52459', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0d630ebd297ebeb52', 'PrivateIpAddress': '10.10.50.221', 'resource_id': 'eni-0d630ebd297ebeb52..10.10.50.221'}], 'resource_id': 'eni-0d630ebd297ebeb52'} 
2021-06-06 12:48:25,563 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972901635}
2021-06-06 12:48:25,808 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:22Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:22Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:22Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-08d92349b40b0d5aa', 'description': 'ELB net/test-nlb/54a3ea88b666491c', 'groupSet': {}, 'privateIpAddressesSet': {}}, 'responseElements': {'requestId': 'f9fa153b-5405-41fa-a43d-db939986497f', 'networkInterface': {'networkInterfaceId': 'eni-0e38779a9f731c54c', 'subnetId': 'subnet-08d92349b40b0d5aa', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1e', 'description': 'ELB net/test-nlb/54a3ea88b666491c', 'ownerId': '139614369439', 'requesterId': '018884231568', 'requesterManaged': True, 'status': 'pending', 'macAddress': '06:b7:12:fc:c9:71', 'privateIpAddress': '10.10.40.4', 'privateDnsName': 'ip-10-10-40-4.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0f81d6cfe66d5f79d', 'groupName': 'default'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.40.4', 'privateDnsName': 'ip-10-10-40-4.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': 'f9fa153b-5405-41fa-a43d-db939986497f', 'eventID': 'ff157274-5cd8-4dab-8a3d-441ac1b2755e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:25,808 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1e', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'PrivateIpAddress': '10.10.40.4', 'MacAddress': '06:b7:12:fc:c9:71', 'GroupId': ['sg-0f81d6cfe66d5f79d'], 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-0e38779a9f731c54c'}]
2021-06-06 12:48:25,808 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0e38779a9f731c54c']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:48:26,658 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1e', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'PrivateIpAddress': '10.10.40.4', 'DnsName': 'ip-10-10-40-4.ec2.internal', 'MacAddress': '06:b7:12:fc:c9:71', 'PublicIpAddress': '3.223.95.163', 'PublicDnsName': 'ec2-3-223-95-163.compute-1.amazonaws.com', 'GroupId': [], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'ela-attach-06eb1cdac942a3107', 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'SourceDestCheck': False, 'InterfaceType': 'network_load_balancer', 'private_ip_address': [{'PrivateIpAddress': '10.10.40.4', 'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'resource_id': 'eni-0e38779a9f731c54c..10.10.40.4'}], 'resource_id': 'eni-0e38779a9f731c54c'}]}
2021-06-06 12:48:26,684 - INFO - Get previous translated snapshot with timestamp 1622972901635 took 0.03 seconds
2021-06-06 12:48:26,688 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1e', 'SubnetId': 'subnet-08d92349b40b0d5aa', 'PrivateIpAddress': '10.10.40.4', 'DnsName': 'ip-10-10-40-4.ec2.internal', 'MacAddress': '06:b7:12:fc:c9:71', 'PublicIpAddress': '3.223.95.163', 'PublicDnsName': 'ec2-3-223-95-163.compute-1.amazonaws.com', 'GroupId': [], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'ela-attach-06eb1cdac942a3107', 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'SourceDestCheck': False, 'InterfaceType': 'network_load_balancer', 'private_ip_address': [{'PrivateIpAddress': '10.10.40.4', 'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'resource_id': 'eni-0e38779a9f731c54c..10.10.40.4'}], 'resource_id': 'eni-0e38779a9f731c54c'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972901635}
2021-06-06 12:48:26,758 - INFO - Calling modeler on-new-snapshot for timestamp 1622972906659 ...
2021-06-06 12:48:27,066 - INFO - Calling analyzer for timestamp 1622972906659 ...
2021-06-06 12:48:30,639 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:30,639 - INFO - Finished triggering everything for timestamp 1622972906659 after 3.95 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.31), ('analyzer', 3.55)]
2021-06-06 12:48:30,639 - INFO - Missing resource id eni-0e38779a9f731c54c from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:48:30,639 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed ModifyNetworkInterfaceAttribute in us-east-1 at 2021-06-06T09:39:23Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:22Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:23Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyNetworkInterfaceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0e38779a9f731c54c', 'sourceDestCheck': {'value': False}}, 'responseElements': {'requestId': 'd3e5077f-e43b-4a3a-9af4-cb5cfce7133d', '_return': True}, 'requestID': 'd3e5077f-e43b-4a3a-9af4-cb5cfce7133d', 'eventID': '29ab079d-c867-42d0-a7de-2d3f7fe23be0', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:30,640 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'resource_id': 'eni-0e38779a9f731c54c'}]
2021-06-06 12:48:30,662 - INFO - Get previous translated snapshot with timestamp 1622972906659 took 0.02 seconds
2021-06-06 12:48:30,666 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'ela-attach-06eb1cdac942a3107', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1e', 'Description': 'ELB net/test-nlb/54a3ea88b666491c', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-40-4.ec2.internal', 'GroupId': [], 'InterfaceType': 'network_load_balancer', 'MacAddress': '06:b7:12:fc:c9:71', 'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'PrivateIpAddress': '10.10.40.4', 'PublicDnsName': 'ec2-3-223-95-163.compute-1.amazonaws.com', 'PublicIpAddress': '3.223.95.163', 'SourceDestCheck': False, 'SubnetId': 'subnet-08d92349b40b0d5aa', 'VpcId': 'vpc-0f057794b5da52459', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0e38779a9f731c54c', 'PrivateIpAddress': '10.10.40.4', 'resource_id': 'eni-0e38779a9f731c54c..10.10.40.4'}], 'resource_id': 'eni-0e38779a9f731c54c'} 
2021-06-06 12:48:30,667 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972906659}
2021-06-06 12:48:30,826 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:27Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:26Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:27Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-0fd7e25c7d54404b7', 'description': 'ELB app/test-alb/7af893b271c21390', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'ipv6AddressCount': 0}, 'responseElements': {'requestId': '183215f7-5858-44db-87de-597ec8c629da', 'networkInterface': {'networkInterfaceId': 'eni-03177a07da30654fa', 'subnetId': 'subnet-0fd7e25c7d54404b7', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1a', 'description': 'ELB app/test-alb/7af893b271c21390', 'ownerId': '139614369439', 'requesterId': 'amazon-elb', 'requesterManaged': True, 'status': 'pending', 'macAddress': '12:0c:61:b5:ed:25', 'privateIpAddress': '10.10.20.97', 'privateDnsName': 'ip-10-10-20-97.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.20.97', 'privateDnsName': 'ip-10-10-20-97.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': '183215f7-5858-44db-87de-597ec8c629da', 'eventID': '4910f185-6a83-4c74-9b9c-92111650ae37', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:30,826 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-03177a07da30654fa', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'PrivateIpAddress': '10.10.20.97', 'MacAddress': '12:0c:61:b5:ed:25', 'GroupId': ['sg-0af2498b5cbd583f6'], 'Description': 'ELB app/test-alb/7af893b271c21390', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-03177a07da30654fa'}]
2021-06-06 12:48:30,826 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03177a07da30654fa']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:48:31,758 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-03177a07da30654fa', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'PrivateIpAddress': '10.10.20.97', 'DnsName': 'ip-10-10-20-97.ec2.internal', 'MacAddress': '12:0c:61:b5:ed:25', 'PublicIpAddress': '52.204.111.230', 'PublicDnsName': 'ec2-52-204-111-230.compute-1.amazonaws.com', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-053a5e41740c3aca5', 'Description': 'ELB app/test-alb/7af893b271c21390', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.20.97', 'NetworkInterfaceId': 'eni-03177a07da30654fa', 'resource_id': 'eni-03177a07da30654fa..10.10.20.97'}], 'resource_id': 'eni-03177a07da30654fa'}]}
2021-06-06 12:48:31,786 - INFO - Get previous translated snapshot with timestamp 1622972906659 took 0.03 seconds
2021-06-06 12:48:31,791 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-03177a07da30654fa', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0fd7e25c7d54404b7', 'PrivateIpAddress': '10.10.20.97', 'DnsName': 'ip-10-10-20-97.ec2.internal', 'MacAddress': '12:0c:61:b5:ed:25', 'PublicIpAddress': '52.204.111.230', 'PublicDnsName': 'ec2-52-204-111-230.compute-1.amazonaws.com', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-053a5e41740c3aca5', 'Description': 'ELB app/test-alb/7af893b271c21390', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.20.97', 'NetworkInterfaceId': 'eni-03177a07da30654fa', 'resource_id': 'eni-03177a07da30654fa..10.10.20.97'}], 'resource_id': 'eni-03177a07da30654fa'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972906659}
2021-06-06 12:48:31,851 - INFO - Calling modeler on-new-snapshot for timestamp 1622972911760 ...
2021-06-06 12:48:32,268 - INFO - Calling analyzer for timestamp 1622972911760 ...
2021-06-06 12:48:36,076 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:36,077 - INFO - Finished triggering everything for timestamp 1622972911760 after 4.29 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.42), ('analyzer', 3.78)]
2021-06-06 12:48:36,660 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:03.995Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': '002ecdb0-a040-48de-8d1e-0651239efae0'}
2021-06-06 12:48:36,866 - INFO - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:40:51Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PTXLBH4KPM:i-07e8ed8341d35c6b0', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-07e8ed8341d35c6b0', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PUEX4ESBE', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PTXLBH4KPM', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:23Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:40:51Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '18.233.148.35', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'requestParameters': {'cluster': 'test_ecs_cluster', 'task': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'attachments': [{'attachmentArn': 'arn:aws:ecs:us-east-1:139614369439:attachment/cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'status': 'ATTACHED'}]}, 'responseElements': {'acknowledgment': 'ack'}, 'requestID': '55a19ff3-0bb3-40bd-a19a-9ebd25b1f22d', 'eventID': 'e5cb24f9-5abd-4d4e-8bd1-268fad359eca', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:36,867 - INFO - modify ecs - [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}]
2021-06-06 12:48:36,867 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'ecs': {'filters': [{'name': 'clusterArn', 'values': ['arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster']}]}}}
2021-06-06 12:48:41,606 - INFO - scanned resources: {'ecs': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'status': 'ACTIVE', 'registeredContainerInstancesCount': 3, 'pendingTasksCount': 0, 'runningTasksCount': 3, 'activeServicesCount': 2, 'container_instance': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}], 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'launchType': 'EC2', 'pendingTasksCount': 0, 'runningTasksCount': 2, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/4959225571735023063', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'desiredCount': 2, 'pendingCount': 0, 'runningCount': 2, 'failedTasks': 0, 'launchType': 'EC2', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/6347564329799363003', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'desiredCount': 1, 'pendingCount': 0, 'runningCount': 1, 'failedTasks': 0, 'launchType': 'FARGATE', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}], 'task': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc'}, {'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'FARGATE', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}]}
2021-06-06 12:48:41,644 - INFO - Get previous translated snapshot with timestamp 1622972911760 took 0.03 seconds
2021-06-06 12:48:41,649 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'ecs': [{'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'launchType': 'EC2', 'pendingTasksCount': 0, 'runningTasksCount': 2, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/4959225571735023063', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'desiredCount': 2, 'pendingCount': 0, 'runningCount': 2, 'failedTasks': 0, 'launchType': 'EC2', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/6347564329799363003', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'desiredCount': 1, 'pendingCount': 0, 'runningCount': 1, 'failedTasks': 0, 'launchType': 'FARGATE', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc'}, {'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'FARGATE', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972911760}
2021-06-06 12:48:41,761 - INFO - Calling modeler on-new-snapshot for timestamp 1622972921619 ...
2021-06-06 12:48:41,907 - INFO - Calling analyzer for timestamp 1622972921619 ...
2021-06-06 12:48:45,178 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:45,179 - INFO - Finished triggering everything for timestamp 1622972921619 after 3.51 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.05), ('modeler', 0.15), ('analyzer', 3.25)]
2021-06-06 12:48:45,347 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:06.689Z, account_id: N/A, extra:{'attachments': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-073e4f80decd5dd47'}, {'name': 'macAddress', 'value': '12:85:60:3c:cb:13'}, {'name': 'privateDnsName', 'value': 'ip-172-31-10-113.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.10.113'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:40:35.364Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc/323acebb-323e-4ec8-82db-92e358a62d8e', 'lastStatus': 'RUNNING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': 'dbe7b760ac43b90bcbbbff4ffeb1bafe6d843a55ff2e8eb8dca0d7b403bce13d', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'networkInterfaces': [{'attachmentId': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'privateIpv4Address': '172.31.10.113'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:40:35.364Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'RUNNING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'pullStartedAt': '2021-06-06T09:41:00.243Z', 'pullStoppedAt': '2021-06-06T09:41:05.243Z', 'startedAt': '2021-06-06T09:41:06.243Z', 'startedBy': 'ecs-svc/4959225571735023063', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'updatedAt': '2021-06-06T09:41:06.243Z', 'version': 3}
2021-06-06 12:48:45,557 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:22.459Z, account_id: N/A, extra:{'instance-id': 'i-0b26f2433f51be1c4', 'state': 'running'}
2021-06-06 12:48:45,717 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:25.856Z, account_id: N/A, extra:{'instance-id': 'i-006dab3da6b657b68', 'state': 'pending'}
2021-06-06 12:48:45,872 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:26.427Z, account_id: N/A, extra:{'instance-id': 'i-0244269d751c2a0af', 'state': 'running'}
2021-06-06 12:48:46,075 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:28.209Z, account_id: N/A, extra:{'instance-id': 'i-054b3883381a7f655', 'state': 'running'}
2021-06-06 12:48:46,231 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateLoadBalancer in us-east-1 at 2021-06-06T09:41:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:53Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'CreateLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnets': ['subnet-0794a2e17f9656258'], 'securityGroups': ['sg-0af2498b5cbd583f6'], 'loadBalancerName': 'test-elb-2796885', 'listeners': [{'sSLCertificateId': '', 'protocol': 'http', 'loadBalancerPort': 80, 'instanceProtocol': 'http', 'instancePort': 8000}]}, 'responseElements': {'dNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}, 'requestID': 'f204dc42-65d4-41f0-9974-e5776975c9a0', 'eventID': '0707776b-ea82-4d7a-a1e0-a84e1dcc843f', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:46,232 - INFO - create elb - [{'LoadBalancerName': 'test-elb-2796885', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['subnet-0794a2e17f9656258'], 'listener_elb': [{'LoadBalancerPort': 80, 'Protocol': 'http', 'InstanceProtocol': 'http', 'InstancePort': 8000, 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]
2021-06-06 12:48:46,232 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:48:47,275 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:48:47,300 - INFO - Get previous translated snapshot with timestamp 1622972921619 took 0.02 seconds
2021-06-06 12:48:47,305 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972921619}
2021-06-06 12:48:47,371 - INFO - Calling modeler on-new-snapshot for timestamp 1622972927276 ...
2021-06-06 12:48:47,419 - INFO - Calling analyzer for timestamp 1622972927276 ...
2021-06-06 12:48:50,956 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:48:50,956 - INFO - Finished triggering everything for timestamp 1622972927276 after 3.65 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_classified', 0.02), ('set_complete', 0.02), ('validate_timestamp', 0.02), ('store_trans', 0.03), ('modeler', 0.05), ('analyzer', 3.49)]
2021-06-06 12:48:50,957 - INFO - Missing resource id test-elb-2796885-957413492.us-east-1.elb.amazonaws.com from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:48:50,957 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ApplySecurityGroupsToLoadBalancer in us-east-1 at 2021-06-06T09:42:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:02Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ApplySecurityGroupsToLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'securityGroups': ['sg-0af2498b5cbd583f6'], 'loadBalancerName': 'test-elb-2796885'}, 'responseElements': {'securityGroups': ['sg-0af2498b5cbd583f6']}, 'requestID': '9d437b10-89eb-4741-9bc6-b65707cac512', 'eventID': '73a95bf6-5e30-4b93-a361-b9851e515098', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:50,958 - INFO - hard-modify elb - 
2021-06-06 12:48:50,958 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:48:51,977 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:48:52,005 - INFO - Get previous translated snapshot with timestamp 1622972927276 took 0.03 seconds
2021-06-06 12:48:52,007 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:48:52,007 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972927276}
2021-06-06 12:48:52,007 - INFO - Missing resource id test-elb-2796885-957413492.us-east-1.elb.amazonaws.com from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:48:52,007 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyLoadBalancerAttributes in us-east-1 at 2021-06-06T09:41:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:56Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ModifyLoadBalancerAttributes', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'loadBalancerAttributes': {'crossZoneLoadBalancing': {'enabled': True}, 'accessLog': {'s3BucketPrefix': '', 'enabled': True, 's3BucketName': 'll-test-bucket-2796885', 'emitInterval': 60}, 'connectionSettings': {'idleTimeout': 60}}}, 'responseElements': {'loadBalancerAttributes': {'crossZoneLoadBalancing': {'enabled': True}, 'accessLog': {'s3BucketPrefix': '', 'enabled': True, 's3BucketName': 'll-test-bucket-2796885', 'emitInterval': 60}, 'connectionSettings': {'idleTimeout': 60}}, 'loadBalancerName': 'test-elb-2796885'}, 'requestID': '9a432e16-6992-46bd-bd9b-142188a9d038', 'eventID': '8e5210a5-0ed7-41dd-b54c-d94a99defa1d', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:52,007 - INFO - modify elb - []
2021-06-06 12:48:52,007 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:48:53,097 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:48:53,142 - INFO - Get previous translated snapshot with timestamp 1622972927276 took 0.04 seconds
2021-06-06 12:48:53,148 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:48:53,149 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972927276}
2021-06-06 12:48:53,149 - INFO - Missing resource id test-elb-2796885-957413492.us-east-1.elb.amazonaws.com from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:48:53,149 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyLoadBalancerAttributes in us-east-1 at 2021-06-06T09:41:58Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:58Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ModifyLoadBalancerAttributes', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'loadBalancerAttributes': {'connectionDraining': {'enabled': False, 'timeout': 300}}}, 'responseElements': {'loadBalancerAttributes': {'connectionDraining': {'enabled': False, 'timeout': 300}}, 'loadBalancerName': 'test-elb-2796885'}, 'requestID': '2064d17d-5a9c-4f51-b441-c3a894839ef9', 'eventID': 'd1010d5e-46b3-4bef-826b-5711e1ca1700', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:53,150 - INFO - modify elb - []
2021-06-06 12:48:53,150 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:48:54,117 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:48:54,148 - INFO - Get previous translated snapshot with timestamp 1622972927276 took 0.03 seconds
2021-06-06 12:48:54,149 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:48:54,149 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972927276}
2021-06-06 12:48:54,149 - INFO - Missing resource id test-elb-2796885-957413492.us-east-1.elb.amazonaws.com from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:48:54,149 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AttachLoadBalancerToSubnets in us-east-1 at 2021-06-06T09:42:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:02Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'AttachLoadBalancerToSubnets', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'subnets': ['subnet-0794a2e17f9656258']}, 'responseElements': {'subnets': ['subnet-0794a2e17f9656258']}, 'requestID': 'f39cff50-65ef-448d-b60d-5fdecb1f3949', 'eventID': 'cf3ad64d-db84-43e2-b18b-6b293476058e', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:54,149 - INFO - modify elb - []
2021-06-06 12:48:54,149 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:48:55,158 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:48:55,186 - INFO - Get previous translated snapshot with timestamp 1622972927276 took 0.03 seconds
2021-06-06 12:48:55,191 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:48:55,192 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972927276}
2021-06-06 12:48:55,389 - INFO - Invalid event id - User N/A (N/A) performed SERVICE_DEPLOYMENT_COMPLETED in N/A at 2021-06-06T09:43:57.729Z, account_id: N/A, extra:{'eventType': 'INFO', 'eventName': 'SERVICE_DEPLOYMENT_COMPLETED', 'deploymentId': 'ecs-svc/4959225571735023063', 'updatedAt': '2021-06-06T09:38:55.579Z', 'reason': 'ECS deployment ecs-svc/4959225571735023063 completed.'}
2021-06-06 12:48:56,057 - INFO - Ignoring failed event - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RevokeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:02Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RevokeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'errorCode': 'Client.InvalidPermission.NotFound', 'errorMessage': 'The specified rule does not exist in this security group.', 'requestParameters': {'groupId': 'sg-08eb478817b54e9c3', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {}, 'ipv6Ranges': {'items': [{'cidrIpv6': '::/0'}]}, 'prefixListIds': {}}]}}, 'responseElements': None, 'requestID': '61a23c7c-6cda-485c-b85c-be2558b2e0eb', 'eventID': '731e57dc-41df-471c-8677-d22e244bc3bb', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.InvalidPermission.NotFound, message: The specified rule does not exist in this security group.)
2021-06-06 12:48:56,207 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:39:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:06Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-06275dc7f34c8f1ac', 'cidrBlock': '10.20.110.0/24', 'availabilityZone': 'us-east-1b', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_vpce_2'}]}]}}, 'responseElements': {'requestId': '870e064d-19cf-4a43-9097-ff79b01ed44d', 'subnet': {'subnetId': 'subnet-090cfb622a4e9acbc', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-090cfb622a4e9acbc', 'state': 'available', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'cidrBlock': '10.20.110.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1b', 'availabilityZoneId': 'use1-az4', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_vpce_2'}]}}}, 'requestID': '870e064d-19cf-4a43-9097-ff79b01ed44d', 'eventID': '72b5e9d4-ab83-4981-8d01-4fb438637821', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:48:56,207 - INFO - create subnet - [{'SubnetId': 'subnet-090cfb622a4e9acbc', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'CidrBlock': '10.20.110.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_vpce_2', 'resource_id': 'subnet-090cfb622a4e9acbc..Name'}], 'resource_id': 'subnet-090cfb622a4e9acbc'}]
2021-06-06 12:48:56,207 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-090cfb622a4e9acbc']}]}}}
2021-06-06 12:48:58,764 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0803c343c9dbf2502', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'AssociationId': 'aclassoc-8ab878ab', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-8ab878ab'}, {'SubnetId': 'subnet-090cfb622a4e9acbc', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'AssociationId': 'aclassoc-a88b4b89', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-a88b4b89'}], 'resource_id': 'acl-0acd7eefeae0dd03c'}]}
2021-06-06 12:48:58,824 - INFO - Get previous translated snapshot with timestamp 1622972927276 took 0.06 seconds
2021-06-06 12:48:58,839 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-090cfb622a4e9acbc', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'CidrBlock': '10.20.110.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_vpce_2', 'resource_id': 'subnet-090cfb622a4e9acbc..Name'}], 'resource_id': 'subnet-090cfb622a4e9acbc'}]}, 'modified': {'network_acl': [{'IsDefault': True, 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..False'}], 'resource_id': 'acl-0acd7eefeae0dd03c', 'acl_association': [{'SubnetId': 'subnet-0803c343c9dbf2502', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'AssociationId': 'aclassoc-8ab878ab', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-8ab878ab'}, {'SubnetId': 'subnet-090cfb622a4e9acbc', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'AssociationId': 'aclassoc-a88b4b89', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-a88b4b89'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972927276}
2021-06-06 12:48:58,927 - INFO - Calling modeler on-new-snapshot for timestamp 1622972938765 ...
2021-06-06 12:48:59,590 - INFO - Calling analyzer for timestamp 1622972938765 ...
2021-06-06 12:49:03,182 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:03,182 - INFO - Finished triggering everything for timestamp 1622972938765 after 4.33 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.66), ('analyzer', 3.57)]
2021-06-06 12:49:03,337 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateSubnet in us-east-1 at 2021-06-06T09:39:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:06Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-06275dc7f34c8f1ac', 'cidrBlock': '10.20.100.0/24', 'availabilityZone': 'us-east-1a', 'tagSpecificationSet': {'items': [{'resourceType': 'subnet', 'tags': [{'key': 'Name', 'value': 'test_subnet_vpce_1'}]}]}}, 'responseElements': {'requestId': '0ef1d597-df42-458a-b60c-f5bc04880cff', 'subnet': {'subnetId': 'subnet-0803c343c9dbf2502', 'subnetArn': 'arn:aws:ec2:us-east-1:139614369439:subnet/subnet-0803c343c9dbf2502', 'state': 'available', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'cidrBlock': '10.20.100.0/24', 'ipv6CidrBlockAssociationSet': {}, 'availableIpAddressCount': 251, 'availabilityZone': 'us-east-1a', 'availabilityZoneId': 'use1-az2', 'ownerId': '139614369439', 'defaultForAz': False, 'mapPublicIpOnLaunch': False, 'assignIpv6AddressOnCreation': False, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_subnet_vpce_1'}]}}}, 'requestID': '0ef1d597-df42-458a-b60c-f5bc04880cff', 'eventID': 'e27fb8fc-880b-43f5-b50e-1c3c196308b2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:03,338 - INFO - create subnet - [{'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'CidrBlock': '10.20.100.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1a', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_vpce_1', 'resource_id': 'subnet-0803c343c9dbf2502..Name'}], 'resource_id': 'subnet-0803c343c9dbf2502'}]
2021-06-06 12:49:03,338 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_acl': {'filters': [{'name': ['acl_association', 'SubnetId'], 'values': ['subnet-0803c343c9dbf2502']}]}}}
2021-06-06 12:49:04,907 - INFO - scanned resources: {'network_acl': [{'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'IsDefault': True, 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..False'}], 'acl_association': [{'SubnetId': 'subnet-0803c343c9dbf2502', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'AssociationId': 'aclassoc-8ab878ab', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-8ab878ab'}, {'SubnetId': 'subnet-090cfb622a4e9acbc', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'AssociationId': 'aclassoc-a88b4b89', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-a88b4b89'}], 'resource_id': 'acl-0acd7eefeae0dd03c'}]}
2021-06-06 12:49:04,932 - INFO - Get previous translated snapshot with timestamp 1622972938765 took 0.03 seconds
2021-06-06 12:49:04,940 - INFO - sub-event will be discarded because no change in resource configuration: {'IsDefault': True, 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'acl_association': [{'AssociationId': 'aclassoc-8ab878ab', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'SubnetId': 'subnet-0803c343c9dbf2502', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-8ab878ab'}, {'AssociationId': 'aclassoc-a88b4b89', 'NetworkAclId': 'acl-0acd7eefeae0dd03c', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'resource_id': 'acl-0acd7eefeae0dd03c..aclassoc-a88b4b89'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0acd7eefeae0dd03c..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0acd7eefeae0dd03c..32767..False'}], 'resource_id': 'acl-0acd7eefeae0dd03c'} 
2021-06-06 12:49:04,941 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'subnet': [{'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'CidrBlock': '10.20.100.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'AvailabilityZone': 'us-east-1a', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_vpce_1', 'resource_id': 'subnet-0803c343c9dbf2502..Name'}], 'resource_id': 'subnet-0803c343c9dbf2502'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972938765}
2021-06-06 12:49:05,006 - INFO - Calling modeler on-new-snapshot for timestamp 1622972944907 ...
2021-06-06 12:49:05,280 - INFO - Calling analyzer for timestamp 1622972944907 ...
2021-06-06 12:49:08,851 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:08,852 - INFO - Finished triggering everything for timestamp 1622972944907 after 3.90 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.27), ('analyzer', 3.54)]
2021-06-06 12:49:09,097 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupIngress in us-east-1 at 2021-06-06T09:39:05Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:05Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupIngress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0de1fb53a270d5776', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': 'db853c58-d586-447b-8452-8870f44333b1', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-0de1fb53a270d5776', 'securityGroupRuleId': 'sgr-04530e5e5cae81acf', 'isEgress': False, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': 'db853c58-d586-447b-8452-8870f44333b1', 'eventID': '7762721a-16db-436f-b7d5-d1c4b34fba18', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:09,097 - INFO - modify security_group - [{'GroupId': 'sg-0de1fb53a270d5776', 'security_ingress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [{}], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..0..0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'DestinationGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776__egress_rule'}], 'resource_id': 'sg-0de1fb53a270d5776'}]
2021-06-06 12:49:09,097 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-0de1fb53a270d5776']}]}}}
2021-06-06 12:49:10,117 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-0de1fb53a270d5776', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-0a880421f072a8186', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0de1fb53a270d5776..Name'}], 'resource_id': 'sg-0de1fb53a270d5776'}]}
2021-06-06 12:49:10,153 - INFO - Get previous translated snapshot with timestamp 1622972944907 took 0.03 seconds
2021-06-06 12:49:10,158 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-0de1fb53a270d5776', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'sg-0de1fb53a270d5776', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0de1fb53a270d5776..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0de1fb53a270d5776..Name'}]} 
2021-06-06 12:49:10,158 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972944907}
2021-06-06 12:49:10,332 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateVpcEndpoint in us-east-1 at 2021-06-06T09:39:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:06Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateVpcEndpoint', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'CreateVpcEndpointRequest': {'PrivateDnsEnabled': False, 'RouteTableId': {'tag': 1, 'content': 'rtb-03b41e12a3709de28'}, 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ServiceName': 'com.amazonaws.us-east-1.dynamodb', 'VpcEndpointType': 'Gateway', 'TagSpecification': {'ResourceType': 'vpc-endpoint', 'tag': 1, 'Tag': {'Value': 'test_vpc_endpoint_dynamodb', 'tag': 1, 'Key': 'Name'}}}}, 'responseElements': {'CreateVpcEndpointResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': '9e09a209-2ba1-4d4a-a1eb-5de4dd974482', 'vpcEndpoint': {'policyDocument': '{"Version":"2008-10-17","Statement":[{"Effect":"Allow","Principal":"*","Action":"*","Resource":"*"}]}', 'routeTableIdSet': {'item': 'rtb-03b41e12a3709de28'}, 'dnsEntrySet': '', 'ownerId': 139614369439, 'privateDnsEnabled': False, 'serviceName': 'com.amazonaws.us-east-1.dynamodb', 'groupSet': '', 'requesterManaged': False, 'vpcEndpointId': 'vpce-09c7006e264934178', 'subnetIdSet': '', 'tagSet': {'item': {'value': 'test_vpc_endpoint_dynamodb', 'key': 'Name'}}, 'networkInterfaceIdSet': '', 'vpcEndpointType': 'Gateway', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'creationTimestamp': '2021-06-06T09:39:06.000Z', 'state': 'available'}}}, 'requestID': '9e09a209-2ba1-4d4a-a1eb-5de4dd974482', 'eventID': '02a080da-5fad-4154-b19e-348d08d6c640', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:10,332 - INFO - create vpc_endpoint - [{'VpcEndpointId': 'vpce-09c7006e264934178', 'VpcEndpointType': 'Gateway', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ServiceName': 'com.amazonaws.us-east-1.dynamodb', 'NetworkInterfaceIds': '', 'RouteTableIds': ['rtb-03b41e12a3709de28'], 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_dynamodb', 'resource_id': 'vpce-09c7006e264934178..Name'}], 'resource_id': 'vpce-09c7006e264934178'}]
2021-06-06 12:49:10,333 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-03b41e12a3709de28']}]}}}
2021-06-06 12:49:11,863 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-03b41e12a3709de28', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-03b41e12a3709de28..10.20.0.0/16'}, {'GatewayId': 'vpce-09c7006e264934178', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationPrefixListId': 'pl-02cd2c6b', 'resource_id': 'rtb-03b41e12a3709de28'}, {'GatewayId': 'vpce-03050161c8e381c75', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationPrefixListId': 'pl-63a5400a', 'resource_id': 'rtb-03b41e12a3709de28'}], 'route_table_association': [{'RouteTableId': 'rtb-03b41e12a3709de28', 'AssociationId': 'rtbassoc-0f36dbd6ae6942007', 'Main': True, 'resource_id': 'rtb-03b41e12a3709de28..rtbassoc-0f36dbd6ae6942007'}], 'resource_id': 'rtb-03b41e12a3709de28'}]}
2021-06-06 12:49:11,892 - INFO - Get previous translated snapshot with timestamp 1622972944907 took 0.03 seconds
2021-06-06 12:49:11,905 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-03b41e12a3709de28', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'rtb-03b41e12a3709de28', 'route': [{'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-03b41e12a3709de28..10.20.0.0/16'}, {'DestinationPrefixListId': 'pl-02cd2c6b', 'GatewayId': 'vpce-09c7006e264934178', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-03b41e12a3709de28'}, {'DestinationPrefixListId': 'pl-63a5400a', 'GatewayId': 'vpce-03050161c8e381c75', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-03b41e12a3709de28'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0f36dbd6ae6942007', 'Main': True, 'RouteTableId': 'rtb-03b41e12a3709de28', 'resource_id': 'rtb-03b41e12a3709de28..rtbassoc-0f36dbd6ae6942007'}]} 
2021-06-06 12:49:11,907 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'vpc_endpoint': [{'VpcEndpointId': 'vpce-09c7006e264934178', 'VpcEndpointType': 'Gateway', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ServiceName': 'com.amazonaws.us-east-1.dynamodb', 'NetworkInterfaceIds': '', 'RouteTableIds': ['rtb-03b41e12a3709de28'], 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_dynamodb', 'resource_id': 'vpce-09c7006e264934178..Name'}], 'resource_id': 'vpce-09c7006e264934178'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972944907}
2021-06-06 12:49:11,976 - INFO - Calling modeler on-new-snapshot for timestamp 1622972951863 ...
2021-06-06 12:49:12,068 - INFO - Calling analyzer for timestamp 1622972951863 ...
2021-06-06 12:49:15,654 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:15,655 - INFO - Finished triggering everything for timestamp 1622972951863 after 3.75 seconds! times: [('store_sub_events', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('set_complete', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.09), ('analyzer', 3.55)]
2021-06-06 12:49:15,847 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AuthorizeSecurityGroupEgress in us-east-1 at 2021-06-06T09:39:12Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:12Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AuthorizeSecurityGroupEgress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-06513cfe251115cb0', 'ipPermissions': {'items': [{'ipProtocol': '-1', 'fromPort': 0, 'toPort': 0, 'groups': {}, 'ipRanges': {'items': [{'cidrIp': '0.0.0.0/0'}]}, 'ipv6Ranges': {}, 'prefixListIds': {}}]}}, 'responseElements': {'requestId': 'a90c0136-e167-4d9e-b864-517efbdd5ece', '_return': True, 'securityGroupRuleSet': {'items': [{'groupOwnerId': '139614369439', 'groupId': 'sg-06513cfe251115cb0', 'securityGroupRuleId': 'sgr-0f34ddc2fab623757', 'isEgress': True, 'ipProtocol': '-1', 'fromPort': -1, 'toPort': -1, 'cidrIpv4': '0.0.0.0/0'}]}}, 'requestID': 'a90c0136-e167-4d9e-b864-517efbdd5ece', 'eventID': '1ee15a23-769d-4054-816d-55926d57c03c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:15,847 - INFO - modify security_group - [{'GroupId': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'IpProtocol': ['-1'], 'FromPort': [0], 'ToPort': [0], 'CidrIp': ['0.0.0.0/0'], 'resource_id': 'sg-06513cfe251115cb0..0..0..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-06513cfe251115cb0'}]
2021-06-06 12:49:15,851 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-06513cfe251115cb0']}]}}}
2021-06-06 12:49:16,808 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}], 'resource_id': 'sg-06513cfe251115cb0'}]}
2021-06-06 12:49:16,832 - INFO - Get previous translated snapshot with timestamp 1622972951863 took 0.02 seconds
2021-06-06 12:49:16,836 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}]} 
2021-06-06 12:49:16,837 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972951863}
2021-06-06 12:49:16,988 - INFO - Ignoring failed event - User N/A (aws-internal/3 aws-sdk-java/1.11.997 Linux/4.14.231-173.360.amzn2.x86_64 OpenJDK_64-Bit_Server_VM/11.0.10+9-LTS java/11.0.10 kotlin/1.3.72 vendor/Amazon.com_Inc. cfg/retry-mode/legacy) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:39:14Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PZ2D3PVS6N:awslambda_596_20210606093914082', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_lambda/awslambda_596_20210606093914082', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PV6GMQUJK', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PZ2D3PVS6N', 'arn': 'arn:aws:iam::139614369439:role/test_role_lambda', 'accountId': '139614369439', 'userName': 'test_role_lambda'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:14Z', 'mfaAuthenticated': 'false'}}}, 'eventTime': '2021-06-06T09:39:14Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '3.94.110.60', 'userAgent': 'aws-internal/3 aws-sdk-java/1.11.997 Linux/4.14.231-173.360.amzn2.x86_64 OpenJDK_64-Bit_Server_VM/11.0.10+9-LTS java/11.0.10 kotlin/1.3.72 vendor/Amazon.com_Inc. cfg/retry-mode/legacy', 'errorCode': 'Client.DryRunOperation', 'errorMessage': 'Request would have succeeded, but DryRun flag is set.', 'requestParameters': None, 'responseElements': None, 'requestID': 'cac3a41f-71da-448f-a3a4-0894412a0514', 'eventID': 'cac8e862-c68e-49ce-8e0f-4fc27256f51e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.DryRunOperation, message: Request would have succeeded, but DryRun flag is set.)
2021-06-06 12:49:17,138 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:17.828Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_1'}}
2021-06-06 12:49:17,372 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:19.402Z, account_id: N/A, extra:{'changed-tag-keys': ['aws:autoscaling:groupName'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'aws:autoscaling:groupName': 'test_autoscaling_group'}}
2021-06-06 12:49:17,526 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:21.608Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': '993a5521-b1f8-4a2e-976b-0334967807ff'}
2021-06-06 12:49:18,468 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:39:20Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:20Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'f33397ef-402f-4876-828b-0ca4585e8e02', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': '738cbfdc-29a9-4ebf-84d8-a4603a772472', 'serviceEventDetails': {'snapshotId': 'snap-0c33eff6f4fd1844f'}, 'eventCategory': 'Management'}
2021-06-06 12:49:18,626 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:40.796Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_nat_ec2'}}
2021-06-06 12:49:18,782 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:38Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:38Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0794a2e17f9656258', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_nat_ec2'}]}]}}, 'responseElements': {'requestId': 'b585dcad-99bc-4402-a947-a1eb739f93d6', 'networkInterface': {'networkInterfaceId': 'eni-0af88763181c7f3f3', 'subnetId': 'subnet-0794a2e17f9656258', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1a', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '12:bd:8e:34:33:51', 'privateIpAddress': '10.10.10.37', 'privateDnsName': 'ip-10-10-10-37.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.10.37', 'privateDnsName': 'ip-10-10-10-37.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_nat_ec2'}]}}}, 'requestID': 'b585dcad-99bc-4402-a947-a1eb739f93d6', 'eventID': 'd3954d6c-9229-40ca-b2cb-7e70f90f98e1', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:18,784 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0af88763181c7f3f3', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.37', 'MacAddress': '12:bd:8e:34:33:51', 'GroupId': ['sg-0af2498b5cbd583f6'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_nat_ec2', 'resource_id': 'eni-0af88763181c7f3f3..Name'}], 'resource_id': 'eni-0af88763181c7f3f3'}]
2021-06-06 12:49:18,784 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0af88763181c7f3f3']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:49:20,380 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0af88763181c7f3f3', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.37', 'DnsName': 'ip-10-10-10-37.ec2.internal', 'MacAddress': '12:bd:8e:34:33:51', 'GroupId': ['sg-0af2498b5cbd583f6'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.37', 'NetworkInterfaceId': 'eni-0af88763181c7f3f3', 'resource_id': 'eni-0af88763181c7f3f3..10.10.10.37'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_nat_ec2', 'resource_id': 'eni-0af88763181c7f3f3..Name'}], 'resource_id': 'eni-0af88763181c7f3f3'}]}
2021-06-06 12:49:20,408 - INFO - Get previous translated snapshot with timestamp 1622972951863 took 0.03 seconds
2021-06-06 12:49:20,412 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-0af88763181c7f3f3', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.37', 'DnsName': 'ip-10-10-10-37.ec2.internal', 'MacAddress': '12:bd:8e:34:33:51', 'GroupId': ['sg-0af2498b5cbd583f6'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.37', 'NetworkInterfaceId': 'eni-0af88763181c7f3f3', 'resource_id': 'eni-0af88763181c7f3f3..10.10.10.37'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_nat_ec2', 'resource_id': 'eni-0af88763181c7f3f3..Name'}], 'resource_id': 'eni-0af88763181c7f3f3'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972951863}
2021-06-06 12:49:20,475 - INFO - Calling modeler on-new-snapshot for timestamp 1622972960380 ...
2021-06-06 12:49:20,479 - INFO - Calling analyzer for timestamp 1622972960380 ...
2021-06-06 12:49:23,853 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:23,854 - INFO - Finished triggering everything for timestamp 1622972960380 after 3.43 seconds! times: [('modeler', 0.0), ('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('analyzer', 3.35)]
2021-06-06 12:49:24,669 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:47.916Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'route-table', 'version': 1.0, 'tags': {'Name': 'test_rt'}}
2021-06-06 12:49:24,858 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateRouteTable in us-east-1 at 2021-06-06T09:39:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateRouteTable', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0f057794b5da52459', 'tagSpecificationSet': {'items': [{'resourceType': 'route-table', 'tags': [{'key': 'Name', 'value': 'test_rt'}]}]}}, 'responseElements': {'requestId': 'f3cdf555-6df3-414a-941d-1c97c1fce85f', 'routeTable': {'routeTableId': 'rtb-0c30833a924816bb1', 'vpcId': 'vpc-0f057794b5da52459', 'ownerId': '139614369439', 'routeSet': {'items': [{'destinationCidrBlock': '10.10.0.0/16', 'gatewayId': 'local', 'state': 'active', 'origin': 'CreateRouteTable'}]}, 'associationSet': {}, 'propagatingVgwSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_rt'}]}}}, 'requestID': 'f3cdf555-6df3-414a-941d-1c97c1fce85f', 'eventID': '11a004f8-7dc2-48d1-a809-edb0118113e2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:24,859 - INFO - create route_table - [{'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'GatewayId': ['local'], 'Origin': ['CreateRouteTable'], 'State': ['active'], 'DestinationCidrBlock': ['10.10.0.0/16'], 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}], 'resource_id': 'rtb-0c30833a924816bb1'}]
2021-06-06 12:49:24,859 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-0c30833a924816bb1']}]}}}
2021-06-06 12:49:25,887 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}], 'resource_id': 'rtb-0c30833a924816bb1'}]}
2021-06-06 12:49:25,912 - INFO - Get previous translated snapshot with timestamp 1622972960380 took 0.03 seconds
2021-06-06 12:49:25,917 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'route_table': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}], 'resource_id': 'rtb-0c30833a924816bb1'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972960380}
2021-06-06 12:49:25,976 - INFO - Calling modeler on-new-snapshot for timestamp 1622972965887 ...
2021-06-06 12:49:26,193 - INFO - Calling analyzer for timestamp 1622972965887 ...
2021-06-06 12:49:29,432 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:29,432 - INFO - Finished triggering everything for timestamp 1622972965887 after 3.52 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.22), ('analyzer', 3.21)]
2021-06-06 12:49:29,432 - INFO - Missing resource id rtb-0c30833a924816bb1 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:49:29,433 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:41:20Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:20Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-03f9a1acea8729b3d', 'routeTableId': 'rtb-0c30833a924816bb1'}, 'responseElements': {'requestId': 'f063f148-63cc-474b-b551-1a04cbc01d7e', 'newAssociationId': 'rtbassoc-0562bb1814fa743df', 'associationState': {'state': 'associated'}}, 'requestID': 'f063f148-63cc-474b-b551-1a04cbc01d7e', 'eventID': '1ba213f4-9180-4dae-9e3b-c2a973ff977e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:29,433 - INFO - hard-modify route_table - 
2021-06-06 12:49:29,459 - INFO - Got 1 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-0c30833a924816bb1$'}]
2021-06-06 12:49:29,459 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-0f057794b5da52459']}]}}}
2021-06-06 12:49:30,696 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-03495ab781c7c2665', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-03495ab781c7c2665..10.10.0.0/16'}], 'resource_id': 'rtb-03495ab781c7c2665'}, {'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}], 'resource_id': 'rtb-0c30833a924816bb1'}]}
2021-06-06 12:49:30,724 - INFO - Get previous translated snapshot with timestamp 1622972965887 took 0.03 seconds
2021-06-06 12:49:30,729 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'rtb-0c30833a924816bb1', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'DestinationCidrBlock': '0.0.0.0/0', 'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'RouteTableId': 'rtb-0c30833a924816bb1', 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}]} 
2021-06-06 12:49:30,730 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'route_table': [{'RouteTableId': 'rtb-03495ab781c7c2665', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-03495ab781c7c2665..10.10.0.0/16'}], 'resource_id': 'rtb-03495ab781c7c2665'}]}, 'deleted': {}}}, 'previous_timestamp': 1622972965887}
2021-06-06 12:49:30,818 - INFO - Calling modeler on-new-snapshot for timestamp 1622972970697 ...
2021-06-06 12:49:30,962 - INFO - Calling analyzer for timestamp 1622972970697 ...
2021-06-06 12:49:34,465 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:34,465 - INFO - Finished triggering everything for timestamp 1622972970697 after 3.74 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.03), ('store_classified', 0.04), ('modeler', 0.14), ('analyzer', 3.48)]
2021-06-06 12:49:34,687 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:50.750Z, account_id: N/A, extra:{'Origin': 'EC2', 'Destination': 'AutoScalingGroup', 'Description': 'Launching a new EC2 instance: i-07e8ed8341d35c6b0', 'EndTime': '2021-06-06T09:39:50.618Z', 'RequestId': 'bd45e782-c37b-a43b-4036-a055936200f1', 'ActivityId': 'bd45e782-c37b-a43b-4036-a055936200f1', 'StartTime': '2021-06-06T09:39:18.377Z', 'EC2InstanceId': 'i-07e8ed8341d35c6b0', 'StatusCode': 'InProgress', 'StatusMessage': '', 'Details': {'Availability Zone': 'us-east-1a'}, 'Cause': 'At 2021-06-06T09:39:11Z a user request created an AutoScalingGroup changing the desired capacity from 0 to 2.  At 2021-06-06T09:39:16Z an instance was started in response to a difference between desired and actual capacity, increasing the capacity from 0 to 2.', 'AutoScalingGroupName': 'test_autoscaling_group'}
2021-06-06 12:49:34,986 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateRouteTable in us-east-1 at 2021-06-06T09:39:45Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:45Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateRouteTable', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0a880421f072a8186', 'tagSpecificationSet': {'items': [{'resourceType': 'route-table', 'tags': [{'key': 'Name', 'value': 'test_rt_2'}]}]}}, 'responseElements': {'requestId': '22cb996a-7171-49c2-baff-6e3e1162f33b', 'routeTable': {'routeTableId': 'rtb-010d0cddf0307500d', 'vpcId': 'vpc-0a880421f072a8186', 'ownerId': '139614369439', 'routeSet': {'items': [{'destinationCidrBlock': '10.20.0.0/16', 'gatewayId': 'local', 'state': 'active', 'origin': 'CreateRouteTable'}]}, 'associationSet': {}, 'propagatingVgwSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_rt_2'}]}}}, 'requestID': '22cb996a-7171-49c2-baff-6e3e1162f33b', 'eventID': '53713514-2963-4ceb-9dae-ec7501229c7c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:34,986 - INFO - create route_table - [{'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'route': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'GatewayId': ['local'], 'Origin': ['CreateRouteTable'], 'State': ['active'], 'DestinationCidrBlock': ['10.20.0.0/16'], 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}], 'resource_id': 'rtb-010d0cddf0307500d'}]
2021-06-06 12:49:34,986 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-010d0cddf0307500d']}]}}}
2021-06-06 12:49:35,808 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'route': [{'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-010d0cddf0307500d..10.10.0.0/16'}, {'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'route_table_association': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'AssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'Main': True, 'resource_id': 'rtb-010d0cddf0307500d..rtbassoc-0de0d5b1b0c53f526'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}], 'resource_id': 'rtb-010d0cddf0307500d'}]}
2021-06-06 12:49:35,837 - INFO - Get previous translated snapshot with timestamp 1622972970697 took 0.03 seconds
2021-06-06 12:49:35,841 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'rtb-010d0cddf0307500d', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'resource_id': 'rtb-010d0cddf0307500d..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'Main': True, 'RouteTableId': 'rtb-010d0cddf0307500d', 'resource_id': 'rtb-010d0cddf0307500d..rtbassoc-0de0d5b1b0c53f526'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}]} 
2021-06-06 12:49:35,841 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972970697}
2021-06-06 12:49:35,991 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:39:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:48Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-055d8dde7349f9bf0', 'groupSet': {'items': [{'groupId': 'sg-0de1fb53a270d5776'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_3'}]}]}}, 'responseElements': {'requestId': '92253495-aab5-454d-be14-b9c05e6d6dc6', 'networkInterface': {'networkInterfaceId': 'eni-07f52585a76316c2c', 'subnetId': 'subnet-055d8dde7349f9bf0', 'vpcId': 'vpc-0a880421f072a8186', 'availabilityZone': 'us-east-1b', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '0a:14:c6:4c:af:f1', 'privateIpAddress': '10.20.10.212', 'privateDnsName': 'ip-10-20-10-212.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0de1fb53a270d5776', 'groupName': 'test_security_group_2'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.10.212', 'privateDnsName': 'ip-10-20-10-212.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_3'}]}}}, 'requestID': '92253495-aab5-454d-be14-b9c05e6d6dc6', 'eventID': '1916448a-83a0-4921-9e21-46286b7ae73d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:35,992 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'VpcId': 'vpc-0a880421f072a8186', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-055d8dde7349f9bf0', 'PrivateIpAddress': '10.20.10.212', 'MacAddress': '0a:14:c6:4c:af:f1', 'GroupId': ['sg-0de1fb53a270d5776'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_3', 'resource_id': 'eni-07f52585a76316c2c..Name'}], 'resource_id': 'eni-07f52585a76316c2c'}]
2021-06-06 12:49:35,992 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-07f52585a76316c2c']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:49:36,859 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'VpcId': 'vpc-0a880421f072a8186', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-055d8dde7349f9bf0', 'PrivateIpAddress': '10.20.10.212', 'DnsName': 'ip-10-20-10-212.ec2.internal', 'MacAddress': '0a:14:c6:4c:af:f1', 'GroupId': ['sg-0de1fb53a270d5776'], 'InstanceId': 'i-08e91318bdb27a3b4', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-075feccf19b32927c', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.10.212', 'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'resource_id': 'eni-07f52585a76316c2c..10.20.10.212'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_3', 'resource_id': 'eni-07f52585a76316c2c..Name'}], 'resource_id': 'eni-07f52585a76316c2c'}]}
2021-06-06 12:49:36,903 - INFO - Get previous translated snapshot with timestamp 1622972970697 took 0.04 seconds
2021-06-06 12:49:36,907 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-075feccf19b32927c', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-10-212.ec2.internal', 'GroupId': ['sg-0de1fb53a270d5776'], 'InstanceId': 'i-08e91318bdb27a3b4', 'InterfaceType': 'interface', 'MacAddress': '0a:14:c6:4c:af:f1', 'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'PrivateIpAddress': '10.20.10.212', 'SourceDestCheck': True, 'SubnetId': 'subnet-055d8dde7349f9bf0', 'VpcId': 'vpc-0a880421f072a8186', 'private_ip_address': [{'NetworkInterfaceId': 'eni-07f52585a76316c2c', 'PrivateIpAddress': '10.20.10.212', 'resource_id': 'eni-07f52585a76316c2c..10.20.10.212'}], 'resource_id': 'eni-07f52585a76316c2c', 'tag': [{'Key': 'Name', 'Value': 'test_interface_3', 'resource_id': 'eni-07f52585a76316c2c..Name'}]} 
2021-06-06 12:49:36,908 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972970697}
2021-06-06 12:49:37,047 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:40:11Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:11Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-084dd3570a09297a9', 'groupSet': {'items': [{'groupId': 'sg-08b4e6d72763b3889'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_4'}]}]}}, 'responseElements': {'requestId': '337b1f73-d97d-4cbc-a3fd-2e8b4a0bb823', 'networkInterface': {'networkInterfaceId': 'eni-012b6ba2716e69ea0', 'subnetId': 'subnet-084dd3570a09297a9', 'vpcId': 'vpc-0bf1ce99828ae9cd2', 'availabilityZone': 'us-east-1f', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '16:66:2c:fd:6e:77', 'privateIpAddress': '10.30.10.164', 'privateDnsName': 'ip-10-30-10-164.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-08b4e6d72763b3889', 'groupName': 'test_security_group_3'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.30.10.164', 'privateDnsName': 'ip-10-30-10-164.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_4'}]}}}, 'requestID': '337b1f73-d97d-4cbc-a3fd-2e8b4a0bb823', 'eventID': '5b2b5b24-851e-4fbd-8978-b7e941d278a4', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:37,047 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-084dd3570a09297a9', 'PrivateIpAddress': '10.30.10.164', 'MacAddress': '16:66:2c:fd:6e:77', 'GroupId': ['sg-08b4e6d72763b3889'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_4', 'resource_id': 'eni-012b6ba2716e69ea0..Name'}], 'resource_id': 'eni-012b6ba2716e69ea0'}]
2021-06-06 12:49:37,056 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-012b6ba2716e69ea0']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:49:38,778 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-084dd3570a09297a9', 'PrivateIpAddress': '10.30.10.164', 'DnsName': 'ip-10-30-10-164.ec2.internal', 'MacAddress': '16:66:2c:fd:6e:77', 'PublicIpAddress': '50.17.238.206', 'PublicDnsName': 'ec2-50-17-238-206.compute-1.amazonaws.com', 'GroupId': ['sg-08b4e6d72763b3889'], 'InstanceId': 'i-064cdc1e76e796802', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02b117ad6488cbbcd', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.30.10.164', 'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'resource_id': 'eni-012b6ba2716e69ea0..10.30.10.164'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_4', 'resource_id': 'eni-012b6ba2716e69ea0..Name'}], 'resource_id': 'eni-012b6ba2716e69ea0'}]}
2021-06-06 12:49:38,809 - INFO - Get previous translated snapshot with timestamp 1622972970697 took 0.03 seconds
2021-06-06 12:49:38,814 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-084dd3570a09297a9', 'PrivateIpAddress': '10.30.10.164', 'DnsName': 'ip-10-30-10-164.ec2.internal', 'MacAddress': '16:66:2c:fd:6e:77', 'PublicIpAddress': '50.17.238.206', 'PublicDnsName': 'ec2-50-17-238-206.compute-1.amazonaws.com', 'GroupId': ['sg-08b4e6d72763b3889'], 'InstanceId': 'i-064cdc1e76e796802', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02b117ad6488cbbcd', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.30.10.164', 'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'resource_id': 'eni-012b6ba2716e69ea0..10.30.10.164'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_4', 'resource_id': 'eni-012b6ba2716e69ea0..Name'}], 'resource_id': 'eni-012b6ba2716e69ea0'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972970697}
2021-06-06 12:49:38,883 - INFO - Calling modeler on-new-snapshot for timestamp 1622972978779 ...
2021-06-06 12:49:39,270 - INFO - Calling analyzer for timestamp 1622972978779 ...
2021-06-06 12:49:44,261 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:44,261 - INFO - Finished triggering everything for timestamp 1622972978779 after 5.45 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.39), ('analyzer', 4.97)]
2021-06-06 12:49:44,609 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:20.401Z, account_id: N/A, extra:{'Origin': 'EC2', 'Destination': 'AutoScalingGroup', 'Description': 'Launching a new EC2 instance: i-0bedadb3dfadfbb56', 'EndTime': '2021-06-06T09:40:20.001Z', 'RequestId': 'b4d5e782-c37b-a482-95e8-b9f40b5b5f70', 'ActivityId': 'b4d5e782-c37b-a482-95e8-b9f40b5b5f70', 'StartTime': '2021-06-06T09:39:18.377Z', 'EC2InstanceId': 'i-0bedadb3dfadfbb56', 'StatusCode': 'InProgress', 'StatusMessage': '', 'Details': {'Availability Zone': 'us-east-1a'}, 'Cause': 'At 2021-06-06T09:39:11Z a user request created an AutoScalingGroup changing the desired capacity from 0 to 2.  At 2021-06-06T09:39:16Z an instance was started in response to a difference between desired and actual capacity, increasing the capacity from 0 to 2.', 'AutoScalingGroupName': 'test_autoscaling_group'}
2021-06-06 12:49:45,086 - INFO - User N/A (autoscaling.amazonaws.com) performed RunInstances in us-east-1 at 2021-06-06T09:39:18Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PRWAVJLVEN:AutoScaling', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForAutoScaling/AutoScaling', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PRWAVJLVEN', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForAutoScaling'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:16Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'autoscaling.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:18Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'autoscaling.amazonaws.com', 'userAgent': 'autoscaling.amazonaws.com', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-0f06fc190dd71269e', 'minCount': 1, 'maxCount': 2}]}, 'userData': '<sensitiveDataRemoved>', 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'availabilityZone': 'us-east-1a', 'monitoring': {'enabled': True}, 'disableApiTermination': False, 'clientToken': '80d5e782-c35c-66ef-4fd9-620375331da6', 'networkInterfaceSet': {'items': [{'deviceIndex': 0, 'associatePublicIpAddress': True}]}, 'iamInstanceProfile': {'name': 'test_profile_ecs'}, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'aws:autoscaling:groupName', 'value': 'test_autoscaling_group'}]}]}}, 'responseElements': {'requestId': '993a5521-b1f8-4a2e-976b-0334967807ff', 'reservationId': 'r-0158bb7995d411b60', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-0bedadb3dfadfbb56', 'imageId': 'ami-0f06fc190dd71269e', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-172-31-11-236.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972358000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'pending'}, 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'privateIpAddress': '172.31.11.236', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/xvda', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'aws:autoscaling:groupName', 'value': 'test_autoscaling_group'}]}, 'clientToken': '80d5e782-c35c-66ef-4fd9-620375331da6', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0ec154ffe3999ca02', 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:6d:78:88:df:57', 'privateIpAddress': '172.31.11.236', 'privateDnsName': 'ip-172-31-11-236.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'attachment': {'attachmentId': 'eni-attach-03acbd1acab7b1d05', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972358000, 'deleteOnTermination': True}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '172.31.11.236', 'privateDnsName': 'ip-172-31-11-236.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'id': 'AIPASBANKG2PYCPWKWY5P'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}, {'instanceId': 'i-07e8ed8341d35c6b0', 'imageId': 'ami-0f06fc190dd71269e', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-172-31-13-14.ec2.internal', 'amiLaunchIndex': 1, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972358000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'pending'}, 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'privateIpAddress': '172.31.13.14', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/xvda', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'aws:autoscaling:groupName', 'value': 'test_autoscaling_group'}]}, 'clientToken': '80d5e782-c35c-66ef-4fd9-620375331da6', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0d511f8ee15a881d8', 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:63:19:23:55:31', 'privateIpAddress': '172.31.13.14', 'privateDnsName': 'ip-172-31-13-14.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'attachment': {'attachmentId': 'eni-attach-07452c722b4bf5155', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972358000, 'deleteOnTermination': True}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '172.31.13.14', 'privateDnsName': 'ip-172-31-13-14.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'id': 'AIPASBANKG2PYCPWKWY5P'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}, 'requesterId': '940372691376'}, 'requestID': '993a5521-b1f8-4a2e-976b-0334967807ff', 'eventID': 'dd5c04b9-d9be-42a7-b6b0-3dec0f7e49b3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:45,098 - INFO - create instance - [{'PrivateIpAddress': '172.31.11.236', 'SourceDestCheck': True, 'InstanceId': 'i-0bedadb3dfadfbb56', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'ImageId': 'ami-0f06fc190dd71269e', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bedadb3dfadfbb56i-07e8ed8341d35c6b0..aws:autoscaling:groupName'}, {'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bedadb3dfadfbb56i-07e8ed8341d35c6b0..aws:autoscaling:groupName'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0bedadb3dfadfbb56'}, {'PrivateIpAddress': '172.31.13.14', 'SourceDestCheck': True, 'InstanceId': 'i-07e8ed8341d35c6b0', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'ImageId': 'ami-0f06fc190dd71269e', 'InstanceType': 't2.micro', 'resource_id': 'i-07e8ed8341d35c6b0'}]
2021-06-06 12:49:45,098 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-0bedadb3dfadfbb56', 'i-07e8ed8341d35c6b0']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:49:46,353 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.9.32', 'DnsName': 'ip-172-31-9-32.ec2.internal', 'MacAddress': '12:ed:f4:02:8a:4b', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02770f627db5fc799', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.9.32', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'}, {'NetworkInterfaceId': 'eni-0ec154ffe3999ca02', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.11.236', 'DnsName': 'ip-172-31-11-236.ec2.internal', 'MacAddress': '12:6d:78:88:df:57', 'PublicIpAddress': '54.144.245.121', 'PublicDnsName': 'ec2-54-144-245-121.compute-1.amazonaws.com', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-03acbd1acab7b1d05', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.11.236', 'NetworkInterfaceId': 'eni-0ec154ffe3999ca02', 'resource_id': 'eni-0ec154ffe3999ca02..172.31.11.236'}], 'resource_id': 'eni-0ec154ffe3999ca02'}, {'NetworkInterfaceId': 'eni-0d511f8ee15a881d8', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.13.14', 'DnsName': 'ip-172-31-13-14.ec2.internal', 'MacAddress': '12:63:19:23:55:31', 'PublicIpAddress': '18.233.148.35', 'PublicDnsName': 'ec2-18-233-148-35.compute-1.amazonaws.com', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-07e8ed8341d35c6b0', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-07452c722b4bf5155', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.13.14', 'NetworkInterfaceId': 'eni-0d511f8ee15a881d8', 'resource_id': 'eni-0d511f8ee15a881d8..172.31.13.14'}], 'resource_id': 'eni-0d511f8ee15a881d8'}, {'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.10.113', 'DnsName': 'ip-172-31-10-113.ec2.internal', 'MacAddress': '12:85:60:3c:cb:13', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-07e8ed8341d35c6b0', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0746963a71525a893', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.10.113', 'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'resource_id': 'eni-073e4f80decd5dd47..172.31.10.113'}], 'resource_id': 'eni-073e4f80decd5dd47'}]}
2021-06-06 12:49:46,353 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-fee06cc9']}]}}}
2021-06-06 12:49:47,178 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-fee06cc9', 'GroupName': 'default', 'VpcId': 'vpc-3a02dc47', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': [], 'PrefixListId': [], 'SourceGroupId': ['sg-fee06cc9'], 'resource_id': 'sg-fee06cc9..all__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-fee06cc9..all..0.0.0.0/0__egress_rule'}], 'resource_id': 'sg-fee06cc9'}]}
2021-06-06 12:49:47,179 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-0bedadb3dfadfbb56', 'i-07e8ed8341d35c6b0']}]}}}
2021-06-06 12:49:48,821 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-041fb7b79d19e9de1', 'VolumeSize': 30, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0c33eff6f4fd1844f', 'VolumeFirstInstanceId': 'i-0bedadb3dfadfbb56', 'volume_attachment': [{'InstanceId': 'i-0bedadb3dfadfbb56', 'VolumeId': 'vol-041fb7b79d19e9de1', 'State': 'attached', 'Device': '/dev/xvda', 'resource_id': 'vol-041fb7b79d19e9de1..i-0bedadb3dfadfbb56'}], 'resource_id': 'vol-041fb7b79d19e9de1'}, {'VolumeId': 'vol-0c714dd3a70904fac', 'VolumeSize': 30, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0c33eff6f4fd1844f', 'VolumeFirstInstanceId': 'i-07e8ed8341d35c6b0', 'volume_attachment': [{'InstanceId': 'i-07e8ed8341d35c6b0', 'VolumeId': 'vol-0c714dd3a70904fac', 'State': 'attached', 'Device': '/dev/xvda', 'resource_id': 'vol-0c714dd3a70904fac..i-07e8ed8341d35c6b0'}], 'resource_id': 'vol-0c714dd3a70904fac'}]}
2021-06-06 12:49:48,845 - INFO - Get previous translated snapshot with timestamp 1622972978779 took 0.02 seconds
2021-06-06 12:49:48,853 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-0746963a71525a893', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'DeviceIndex': 1, 'DnsName': 'ip-172-31-10-113.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-07e8ed8341d35c6b0', 'InterfaceType': 'interface', 'MacAddress': '12:85:60:3c:cb:13', 'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'PrivateIpAddress': '172.31.10.113', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-073e4f80decd5dd47', 'PrivateIpAddress': '172.31.10.113', 'resource_id': 'eni-073e4f80decd5dd47..172.31.10.113'}], 'resource_id': 'eni-073e4f80decd5dd47'} 
2021-06-06 12:49:48,858 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-fee06cc9', 'GroupName': 'default', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'sg-fee06cc9', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-fee06cc9..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-fee06cc9'], 'resource_id': 'sg-fee06cc9..all__ingress_rule'}]} 
2021-06-06 12:49:48,863 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance_volume': [{'VolumeId': 'vol-041fb7b79d19e9de1', 'VolumeSize': 30, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0c33eff6f4fd1844f', 'VolumeFirstInstanceId': 'i-0bedadb3dfadfbb56', 'volume_attachment': [{'InstanceId': 'i-0bedadb3dfadfbb56', 'VolumeId': 'vol-041fb7b79d19e9de1', 'State': 'attached', 'Device': '/dev/xvda', 'resource_id': 'vol-041fb7b79d19e9de1..i-0bedadb3dfadfbb56'}], 'resource_id': 'vol-041fb7b79d19e9de1'}, {'VolumeId': 'vol-0c714dd3a70904fac', 'VolumeSize': 30, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0c33eff6f4fd1844f', 'VolumeFirstInstanceId': 'i-07e8ed8341d35c6b0', 'volume_attachment': [{'InstanceId': 'i-07e8ed8341d35c6b0', 'VolumeId': 'vol-0c714dd3a70904fac', 'State': 'attached', 'Device': '/dev/xvda', 'resource_id': 'vol-0c714dd3a70904fac..i-07e8ed8341d35c6b0'}], 'resource_id': 'vol-0c714dd3a70904fac'}], 'network_interface': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.9.32', 'DnsName': 'ip-172-31-9-32.ec2.internal', 'MacAddress': '12:ed:f4:02:8a:4b', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02770f627db5fc799', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.9.32', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'}, {'NetworkInterfaceId': 'eni-0ec154ffe3999ca02', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.11.236', 'DnsName': 'ip-172-31-11-236.ec2.internal', 'MacAddress': '12:6d:78:88:df:57', 'PublicIpAddress': '54.144.245.121', 'PublicDnsName': 'ec2-54-144-245-121.compute-1.amazonaws.com', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-03acbd1acab7b1d05', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.11.236', 'NetworkInterfaceId': 'eni-0ec154ffe3999ca02', 'resource_id': 'eni-0ec154ffe3999ca02..172.31.11.236'}], 'resource_id': 'eni-0ec154ffe3999ca02'}, {'NetworkInterfaceId': 'eni-0d511f8ee15a881d8', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.13.14', 'DnsName': 'ip-172-31-13-14.ec2.internal', 'MacAddress': '12:63:19:23:55:31', 'PublicIpAddress': '18.233.148.35', 'PublicDnsName': 'ec2-18-233-148-35.compute-1.amazonaws.com', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-07e8ed8341d35c6b0', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-07452c722b4bf5155', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.13.14', 'NetworkInterfaceId': 'eni-0d511f8ee15a881d8', 'resource_id': 'eni-0d511f8ee15a881d8..172.31.13.14'}], 'resource_id': 'eni-0d511f8ee15a881d8'}]}, 'modified': {'instance': [{'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-07e8ed8341d35c6b0', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.13.14', 'PublicDnsName': 'ec2-18-233-148-35.compute-1.amazonaws.com', 'PublicIpAddress': '18.233.148.35', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-07e8ed8341d35c6b0', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-07e8ed8341d35c6b0..aws:autoscaling:groupName'}]}, {'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-0bedadb3dfadfbb56', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.11.236', 'PublicDnsName': 'ec2-54-144-245-121.compute-1.amazonaws.com', 'PublicIpAddress': '54.144.245.121', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-0bedadb3dfadfbb56', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bedadb3dfadfbb56i-07e8ed8341d35c6b0..aws:autoscaling:groupName'}, {'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bedadb3dfadfbb56i-07e8ed8341d35c6b0..aws:autoscaling:groupName'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622972978779}
2021-06-06 12:49:48,976 - INFO - Calling modeler on-new-snapshot for timestamp 1622972988822 ...
2021-06-06 12:49:50,624 - INFO - Calling analyzer for timestamp 1622972988822 ...
2021-06-06 12:49:57,727 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:49:57,727 - INFO - Finished triggering everything for timestamp 1622972988822 after 8.84 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.05), ('modeler', 1.65), ('analyzer', 7.08)]
2021-06-06 12:49:57,728 - INFO - Missing resource id eni-05095d1d9d13f13f3 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:49:57,728 - INFO - User N/A (ecs.amazonaws.com) performed AttachNetworkInterface in us-east-1 at 2021-06-06T09:40:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:40:38Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:40:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AttachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-05095d1d9d13f13f3', 'instanceId': 'i-0bedadb3dfadfbb56', 'deviceIndex': 1}, 'responseElements': {'requestId': '474c47f8-3fed-41d6-82bd-5ad288932111', 'attachmentId': 'eni-attach-02770f627db5fc799'}, 'requestID': '474c47f8-3fed-41d6-82bd-5ad288932111', 'eventID': '6f02ff59-aeb1-4060-8f13-167452750595', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:49:57,728 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'InstanceId': 'i-0bedadb3dfadfbb56', 'resource_id': 'eni-05095d1d9d13f13f3'}]
2021-06-06 12:49:57,728 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-05095d1d9d13f13f3']}]}}}
2021-06-06 12:49:59,786 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.9.32', 'DnsName': 'ip-172-31-9-32.ec2.internal', 'MacAddress': '12:ed:f4:02:8a:4b', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02770f627db5fc799', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.9.32', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'}]}
2021-06-06 12:49:59,814 - INFO - Get previous translated snapshot with timestamp 1622972988822 took 0.03 seconds
2021-06-06 12:49:59,819 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-02770f627db5fc799', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'DeviceIndex': 1, 'DnsName': 'ip-172-31-9-32.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'InterfaceType': 'interface', 'MacAddress': '12:ed:f4:02:8a:4b', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'PrivateIpAddress': '172.31.9.32', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'PrivateIpAddress': '172.31.9.32', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'} 
2021-06-06 12:49:59,820 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972988822}
2021-06-06 12:49:59,967 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed EnableEnhancedMonitoring in us-east-1 at 2021-06-06T09:39:22Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:22Z', 'eventSource': 'kinesis.amazonaws.com', 'eventName': 'EnableEnhancedMonitoring', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'streamName': 'test_kinesis', 'shardLevelMetrics': ['IncomingBytes', 'OutgoingBytes']}, 'responseElements': {'streamName': 'test_kinesis', 'currentShardLevelMetrics': [], 'desiredShardLevelMetrics': ['IncomingBytes', 'OutgoingBytes']}, 'requestID': 'effc3c1e-8928-259c-b6ca-a614bc135000', 'eventID': 'b733270c-764b-4321-960e-83f986e51b7c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:00,156 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:39:07Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:39:07Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'bbb686b9-b613-4c83-beae-b4e07226e478', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': '4e7d7bbd-646e-4011-82ff-33394a455829', 'serviceEventDetails': {'snapshotId': 'snap-0c33eff6f4fd1844f'}, 'eventCategory': 'Management'}
2021-06-06 12:50:00,297 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:33.927Z, account_id: N/A, extra:{'attachments': [{'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-04402a82414953b52'}, {'name': 'macAddress', 'value': '12:ec:d8:a3:cc:55'}, {'name': 'privateDnsName', 'value': 'ip-172-31-4-36.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.4.36'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:39:11.422Z', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122/a71db6f1-510c-471f-ad53-16ee5630b665', 'lastStatus': 'RUNNING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': '901764ab013a4feaab7f6f2b5667f122-1576263027', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'networkInterfaces': [{'attachmentId': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'privateIpv4Address': '172.31.4.36'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:39:05.586Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'ephemeralStorage': {'sizeInGiB': 20}, 'group': 'service:test_ecs_service_fargate', 'launchType': 'FARGATE', 'lastStatus': 'RUNNING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'platformVersion': '1.4.0', 'pullStartedAt': '2021-06-06T09:39:26.004Z', 'pullStoppedAt': '2021-06-06T09:39:30.659Z', 'startedAt': '2021-06-06T09:39:33.161Z', 'startedBy': 'ecs-svc/6347564329799363003', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'updatedAt': '2021-06-06T09:39:33.161Z', 'version': 3}
2021-06-06 12:50:00,447 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:39:40.257Z, account_id: N/A, extra:{'instance-id': 'i-07e8ed8341d35c6b0', 'state': 'running'}
2021-06-06 12:50:00,599 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:48.244Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'route-table', 'version': 1.0, 'tags': {'Name': 'test_rt_2'}}
2021-06-06 12:50:00,746 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateRoute in us-east-1 at 2021-06-06T09:39:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateRoute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-010d0cddf0307500d', 'destinationCidrBlock': '10.10.0.0/16', 'vpcPeeringConnectionId': 'pcx-025cdacc34c221339'}, 'responseElements': {'requestId': '6c816819-8790-4d5f-8695-34bf76e758e8', '_return': True}, 'requestID': '6c816819-8790-4d5f-8695-34bf76e758e8', 'eventID': 'a50e84cd-dc8b-4933-ade1-275df111d0f1', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:00,747 - INFO - hard-modify route_table - 
2021-06-06 12:50:00,747 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-010d0cddf0307500d']}]}}}
2021-06-06 12:50:01,620 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'route': [{'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-010d0cddf0307500d..10.10.0.0/16'}, {'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'route_table_association': [{'RouteTableId': 'rtb-010d0cddf0307500d', 'AssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'Main': True, 'resource_id': 'rtb-010d0cddf0307500d..rtbassoc-0de0d5b1b0c53f526'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}], 'resource_id': 'rtb-010d0cddf0307500d'}]}
2021-06-06 12:50:01,660 - INFO - Get previous translated snapshot with timestamp 1622972988822 took 0.04 seconds
2021-06-06 12:50:01,668 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-010d0cddf0307500d', 'VpcId': 'vpc-0a880421f072a8186', 'resource_id': 'rtb-010d0cddf0307500d', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'resource_id': 'rtb-010d0cddf0307500d..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-010d0cddf0307500d..10.20.0.0/16'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0de0d5b1b0c53f526', 'Main': True, 'RouteTableId': 'rtb-010d0cddf0307500d', 'resource_id': 'rtb-010d0cddf0307500d..rtbassoc-0de0d5b1b0c53f526'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-010d0cddf0307500d..Name'}]} 
2021-06-06 12:50:01,670 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972988822}
2021-06-06 12:50:01,825 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateRoute in us-east-1 at 2021-06-06T09:39:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:39:48Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateRoute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-0c30833a924816bb1', 'destinationCidrBlock': '10.20.0.0/16', 'vpcPeeringConnectionId': 'pcx-025cdacc34c221339'}, 'responseElements': {'requestId': '03816fe2-0b75-426f-8f18-d7151501e7d2', '_return': True}, 'requestID': '03816fe2-0b75-426f-8f18-d7151501e7d2', 'eventID': '5b8fd449-37c5-4e51-a8ff-202f16fcc24e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:01,826 - INFO - hard-modify route_table - 
2021-06-06 12:50:01,827 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-0c30833a924816bb1']}]}}}
2021-06-06 12:50:02,750 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}], 'resource_id': 'rtb-0c30833a924816bb1'}]}
2021-06-06 12:50:02,811 - INFO - Get previous translated snapshot with timestamp 1622972988822 took 0.06 seconds
2021-06-06 12:50:02,819 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'rtb-0c30833a924816bb1', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'DestinationCidrBlock': '0.0.0.0/0', 'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'RouteTableId': 'rtb-0c30833a924816bb1', 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}]} 
2021-06-06 12:50:02,820 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972988822}
2021-06-06 12:50:02,967 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:39:53.464Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc-endpoint', 'version': 1.0, 'tags': {'Name': 'test_vpc_endpoint_kinesis'}}
2021-06-06 12:50:03,144 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:13.999Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 1.0, 'tags': {'Name': 'test_interface_4'}}
2021-06-06 12:50:03,739 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AllocateAddress in us-east-1 at 2021-06-06T09:40:15Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:15Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AllocateAddress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'domain': 'vpc'}, 'responseElements': {'requestId': '997bd19c-c9db-410b-9b14-e2e4eac6df7a', 'publicIp': '67.202.13.163', 'domain': 'vpc', 'allocationId': 'eipalloc-00a0fe73123d00c86', 'publicIpv4Pool': 'amazon', 'networkBorderGroup': 'us-east-1'}, 'requestID': '997bd19c-c9db-410b-9b14-e2e4eac6df7a', 'eventID': 'b1846768-0589-4e36-9b48-afb0fe7353e1', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:03,893 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:21.473Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 1, 'versionInfo': {}, 'updatedAt': '2021-06-06T09:40:21.08Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:50:04,056 - INFO - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed DiscoverPollEndpoint in us-east-1 at 2021-06-06T09:40:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PTXLBH4KPM:i-09bd4d3233e68e8cc', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-09bd4d3233e68e8cc', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2P5YGKUVED', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PTXLBH4KPM', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:10Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:40:06Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DiscoverPollEndpoint', 'awsRegion': 'us-east-1', 'sourceIPAddress': '3.87.66.2', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'requestParameters': {'containerInstance': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'cluster': 'test_ecs_cluster'}, 'responseElements': {'endpoint': 'https://ecs-a-20.us-east-1.amazonaws.com/', 'telemetryEndpoint': 'https://ecs-t-20.us-east-1.amazonaws.com/'}, 'requestID': '5ff1f369-cc9e-4fbb-9dcb-667462a2174d', 'eventID': 'cff918a7-e0aa-4b38-9afd-869d34b8d398', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:04,205 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:35.718Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 4, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:35.373Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:50:04,364 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:40.828Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 5, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:35.373Z', 'registeredAt': '2021-06-06T09:40:32.186Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:50:04,524 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:58.177Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_1'}}
2021-06-06 12:50:04,674 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:00.974Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': 'e2453c77-3e53-4bc4-9109-8339784849c3'}
2021-06-06 12:50:04,861 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateRoute in us-east-1 at 2021-06-06T09:41:21Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:21Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateRoute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-0c30833a924816bb1', 'destinationCidrBlock': '0.0.0.0/0', 'gatewayId': 'igw-09d1e6d636d27b816'}, 'responseElements': {'requestId': 'eafc41da-12ca-4dac-904d-588c882fcf45', '_return': True}, 'requestID': 'eafc41da-12ca-4dac-904d-588c882fcf45', 'eventID': '7feeaa4b-456c-48d5-a076-eb090f1001de', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:04,862 - INFO - hard-modify route_table - 
2021-06-06 12:50:04,862 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-0c30833a924816bb1']}]}}}
2021-06-06 12:50:05,714 - INFO - scanned resources: {'route_table': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'route': [{'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'DestinationCidrBlock': '10.10.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '10.20.0.0/16', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'RouteTableId': 'rtb-0c30833a924816bb1', 'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}], 'resource_id': 'rtb-0c30833a924816bb1'}]}
2021-06-06 12:50:05,745 - INFO - Get previous translated snapshot with timestamp 1622972988822 took 0.03 seconds
2021-06-06 12:50:05,751 - INFO - sub-event will be discarded because no change in resource configuration: {'RouteTableId': 'rtb-0c30833a924816bb1', 'VpcId': 'vpc-0f057794b5da52459', 'resource_id': 'rtb-0c30833a924816bb1', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0c30833a924816bb1..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-025cdacc34c221339', 'resource_id': 'rtb-0c30833a924816bb1..10.20.0.0/16'}, {'DestinationCidrBlock': '0.0.0.0/0', 'GatewayId': 'igw-09d1e6d636d27b816', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0c30833a924816bb1..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0562bb1814fa743df', 'Main': True, 'RouteTableId': 'rtb-0c30833a924816bb1', 'resource_id': 'rtb-0c30833a924816bb1..rtbassoc-0562bb1814fa743df'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0c30833a924816bb1..Name'}]} 
2021-06-06 12:50:05,752 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972988822}
2021-06-06 12:50:05,997 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNatGateway in us-east-1 at 2021-06-06T09:41:32Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:32Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNatGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'CreateNatGatewayRequest': {'AllocationId': 'eipalloc-00a0fe73123d00c86', 'SubnetId': 'subnet-0c78091befe9195b8', 'ClientToken': '5BB925BB-F5B7-43FC-9219-269FE7406337', 'TagSpecification': {'ResourceType': 'natgateway', 'tag': 1, 'Tag': {'Value': 'test_nat_gw', 'tag': 1, 'Key': 'Name'}}}}, 'responseElements': {'CreateNatGatewayResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'natGateway': {'connectivityType': 'public', 'subnetId': 'subnet-0c78091befe9195b8', 'tagSet': {'item': {'value': 'test_nat_gw', 'key': 'Name'}}, 'natGatewayAddressSet': {'item': {'allocationId': 'eipalloc-00a0fe73123d00c86'}}, 'createTime': '2021-06-06T09:41:32.000Z', 'vpcId': 'vpc-0d9aeb3594c89770e', 'natGatewayId': 'nat-03c38ea9a4881ae8f', 'state': 'pending'}, 'requestId': '8c199095-17a0-4a0c-8b3a-958959d75ac7', 'clientToken': '5BB925BB-F5B7-43FC-9219-269FE7406337'}}, 'requestID': '8c199095-17a0-4a0c-8b3a-958959d75ac7', 'eventID': '6b8750a0-ce4c-4e46-bfdf-d89c05adca59', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:05,997 - INFO - create nat_gateway - [{'NatGatewayId': 'nat-03c38ea9a4881ae8f', 'SubnetId': 'subnet-0c78091befe9195b8', 'State': 'pending', 'VpcId': 'pending', 'nat_gateway_address': [{'AllocationId': 'eipalloc-00a0fe73123d00c86', 'NatGatewayId': 'nat-03c38ea9a4881ae8f', 'resource_id': 'nat-03c38ea9a4881ae8f..'}], 'tag': [{'Key': 'Name', 'Value': 'test_nat_gw', 'resource_id': 'nat-03c38ea9a4881ae8f..Name'}], 'resource_id': 'nat-03c38ea9a4881ae8f'}]
2021-06-06 12:50:05,999 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'nat_gateway': {'filters': [{'name': 'NatGatewayId', 'values': ['nat-03c38ea9a4881ae8f']}], 'retry': {'times': 2, 'sleep_interval': 1000, 'data_to_check': ['NatGateways', 'NatGatewayAddresses..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:07,469 - INFO - scanned resources: {'nat_gateway': [{'NatGatewayId': 'nat-03c38ea9a4881ae8f', 'SubnetId': 'subnet-0c78091befe9195b8', 'State': 'available', 'VpcId': 'vpc-0d9aeb3594c89770e', 'nat_gateway_address': [{'NetworkInterfaceId': 'eni-04a2407200c1af720', 'PrivateIp': '10.40.10.84', 'PublicIp': '67.202.13.163', 'AllocationId': 'eipalloc-00a0fe73123d00c86', 'resource_id': 'nat-03c38ea9a4881ae8f..eni-04a2407200c1af720'}], 'tag': [{'Key': 'Name', 'Value': 'test_nat_gw', 'resource_id': 'nat-03c38ea9a4881ae8f..Name'}], 'resource_id': 'nat-03c38ea9a4881ae8f'}]}
2021-06-06 12:50:07,469 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-04a2407200c1af720']}], 'retry': {'times': 2, 'sleep_interval': 1000, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:09,099 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-04a2407200c1af720', 'VpcId': 'vpc-0d9aeb3594c89770e', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-0c78091befe9195b8', 'PrivateIpAddress': '10.40.10.84', 'DnsName': 'ip-10-40-10-84.ec2.internal', 'MacAddress': '16:6c:02:86:8a:5b', 'PublicIpAddress': '67.202.13.163', 'PublicDnsName': 'ec2-67-202-13-163.compute-1.amazonaws.com', 'GroupId': [], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'ela-attach-001cb7e78a11f3aa4', 'Description': 'Interface for NAT Gateway nat-03c38ea9a4881ae8f', 'SourceDestCheck': False, 'InterfaceType': 'nat_gateway', 'private_ip_address': [{'PrivateIpAddress': '10.40.10.84', 'NetworkInterfaceId': 'eni-04a2407200c1af720', 'resource_id': 'eni-04a2407200c1af720..10.40.10.84'}], 'resource_id': 'eni-04a2407200c1af720'}]}
2021-06-06 12:50:09,147 - INFO - Get previous translated snapshot with timestamp 1622972988822 took 0.05 seconds
2021-06-06 12:50:09,157 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'nat_gateway': [{'NatGatewayId': 'nat-03c38ea9a4881ae8f', 'SubnetId': 'subnet-0c78091befe9195b8', 'State': 'available', 'VpcId': 'vpc-0d9aeb3594c89770e', 'nat_gateway_address': [{'NetworkInterfaceId': 'eni-04a2407200c1af720', 'PrivateIp': '10.40.10.84', 'PublicIp': '67.202.13.163', 'AllocationId': 'eipalloc-00a0fe73123d00c86', 'resource_id': 'nat-03c38ea9a4881ae8f..eni-04a2407200c1af720'}], 'tag': [{'Key': 'Name', 'Value': 'test_nat_gw', 'resource_id': 'nat-03c38ea9a4881ae8f..Name'}], 'resource_id': 'nat-03c38ea9a4881ae8f'}], 'network_interface': [{'NetworkInterfaceId': 'eni-04a2407200c1af720', 'VpcId': 'vpc-0d9aeb3594c89770e', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-0c78091befe9195b8', 'PrivateIpAddress': '10.40.10.84', 'DnsName': 'ip-10-40-10-84.ec2.internal', 'MacAddress': '16:6c:02:86:8a:5b', 'PublicIpAddress': '67.202.13.163', 'PublicDnsName': 'ec2-67-202-13-163.compute-1.amazonaws.com', 'GroupId': [], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'ela-attach-001cb7e78a11f3aa4', 'Description': 'Interface for NAT Gateway nat-03c38ea9a4881ae8f', 'SourceDestCheck': False, 'InterfaceType': 'nat_gateway', 'private_ip_address': [{'PrivateIpAddress': '10.40.10.84', 'NetworkInterfaceId': 'eni-04a2407200c1af720', 'resource_id': 'eni-04a2407200c1af720..10.40.10.84'}], 'resource_id': 'eni-04a2407200c1af720'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622972988822}
2021-06-06 12:50:09,234 - INFO - Calling modeler on-new-snapshot for timestamp 1622973009100 ...
2021-06-06 12:50:09,824 - INFO - Calling analyzer for timestamp 1622973009100 ...
2021-06-06 12:50:14,013 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:50:14,013 - INFO - Finished triggering everything for timestamp 1622973009100 after 4.85 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.59), ('analyzer', 4.17)]
2021-06-06 12:50:14,185 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:36.692Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': 'ad4b7d0a-ec64-4607-8b5c-93b734e42227'}
2021-06-06 12:50:15,822 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:42.545Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_vpce_s3'}}
2021-06-06 12:50:16,030 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:28Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:28Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'cc76adee-6b54-4704-9d2d-b49fb93b9ab8', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': 'fcf4007d-2164-4f43-b5aa-3f4131089ef9', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:50:16,231 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:50Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:50Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': '915EB656-AEBF-44D5-81EE-F9F45FA27999', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0cda1858b7bf13a87', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {'name': 'test_profile'}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_dynamo_db'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '766cabdb-7336-426d-a5af-0d46c8c11663', 'reservationId': 'r-00a2ecebc2489e878', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-08405bcd1f1f290b2', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-20-110-36.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972510000, 'placement': {'availabilityZone': 'us-east-1b', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-090cfb622a4e9acbc', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'privateIpAddress': '10.20.110.36', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_dynamo_db'}]}, 'clientToken': '915EB656-AEBF-44D5-81EE-F9F45FA27999', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0cda1858b7bf13a87', 'subnetId': 'subnet-090cfb622a4e9acbc', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '0a:7b:be:71:02:7f', 'privateIpAddress': '10.20.110.36', 'privateDnsName': 'ip-10-20-110-36.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'attachment': {'attachmentId': 'eni-attach-04cf9614e9b18b231', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972510000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.110.36', 'privateDnsName': 'ip-10-20-110-36.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'id': 'AIPASBANKG2P7LQVS7PFV'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '766cabdb-7336-426d-a5af-0d46c8c11663', 'eventID': 'f6711146-52bf-4502-9844-f584da5b1da3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:16,245 - INFO - create instance - [{'PrivateIpAddress': '10.20.110.36', 'SourceDestCheck': True, 'InstanceId': 'i-08405bcd1f1f290b2', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_dynamo_db', 'resource_id': 'i-08405bcd1f1f290b2..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-08405bcd1f1f290b2'}]
2021-06-06 12:50:16,245 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-08405bcd1f1f290b2']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:18,237 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'PrivateIpAddress': '10.20.110.36', 'DnsName': 'ip-10-20-110-36.ec2.internal', 'MacAddress': '0a:7b:be:71:02:7f', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-08405bcd1f1f290b2', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-04cf9614e9b18b231', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.110.36', 'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'resource_id': 'eni-0cda1858b7bf13a87..10.20.110.36'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_dynamo', 'resource_id': 'eni-0cda1858b7bf13a87..Name'}], 'resource_id': 'eni-0cda1858b7bf13a87'}]}
2021-06-06 12:50:18,237 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-06513cfe251115cb0']}]}}}
2021-06-06 12:50:19,715 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}], 'resource_id': 'sg-06513cfe251115cb0'}]}
2021-06-06 12:50:19,715 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-08405bcd1f1f290b2']}]}}}
2021-06-06 12:50:20,628 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-078e8282cf9383c05', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1b', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-08405bcd1f1f290b2', 'volume_attachment': [{'InstanceId': 'i-08405bcd1f1f290b2', 'VolumeId': 'vol-078e8282cf9383c05', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-078e8282cf9383c05..i-08405bcd1f1f290b2'}], 'resource_id': 'vol-078e8282cf9383c05'}]}
2021-06-06 12:50:20,653 - INFO - Get previous translated snapshot with timestamp 1622973009100 took 0.03 seconds
2021-06-06 12:50:20,662 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-04cf9614e9b18b231', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-110-36.ec2.internal', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-08405bcd1f1f290b2', 'InterfaceType': 'interface', 'MacAddress': '0a:7b:be:71:02:7f', 'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'PrivateIpAddress': '10.20.110.36', 'SourceDestCheck': True, 'SubnetId': 'subnet-090cfb622a4e9acbc', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0cda1858b7bf13a87', 'PrivateIpAddress': '10.20.110.36', 'resource_id': 'eni-0cda1858b7bf13a87..10.20.110.36'}], 'resource_id': 'eni-0cda1858b7bf13a87', 'tag': [{'Key': 'Name', 'Value': 'test_interface_dynamo', 'resource_id': 'eni-0cda1858b7bf13a87..Name'}]} 
2021-06-06 12:50:20,666 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}]} 
2021-06-06 12:50:20,671 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.20.110.36', 'SourceDestCheck': True, 'InstanceId': 'i-08405bcd1f1f290b2', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_dynamo_db', 'resource_id': 'i-08405bcd1f1f290b2..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-08405bcd1f1f290b2'}], 'instance_volume': [{'VolumeId': 'vol-078e8282cf9383c05', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1b', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-08405bcd1f1f290b2', 'volume_attachment': [{'InstanceId': 'i-08405bcd1f1f290b2', 'VolumeId': 'vol-078e8282cf9383c05', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-078e8282cf9383c05..i-08405bcd1f1f290b2'}], 'resource_id': 'vol-078e8282cf9383c05'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973009100}
2021-06-06 12:50:20,745 - INFO - Calling modeler on-new-snapshot for timestamp 1622973020628 ...
2021-06-06 12:50:20,935 - INFO - Calling analyzer for timestamp 1622973020628 ...
2021-06-06 12:50:26,417 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:50:26,418 - INFO - Finished triggering everything for timestamp 1622973020628 after 5.74 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.19), ('analyzer', 5.46)]
2021-06-06 12:50:26,728 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:53.608Z, account_id: N/A, extra:{'result': 'available', 'cause': '', 'event': 'createVolume', 'request-id': '766cabdb-7336-426d-a5af-0d46c8c11663'}
2021-06-06 12:50:26,880 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:53Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': 'ED6591D3-5D1D-428F-8271-FBDB2755FD09', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0d7b3374ec048ab52', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {'name': 'test_profile'}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_sqs'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '5ba0a05d-f87e-4776-ad11-95e29846c7e7', 'reservationId': 'r-09a633e8b406edb39', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-0459367d7e3bc3ba4', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-20-100-83.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972512000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-0803c343c9dbf2502', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'privateIpAddress': '10.20.100.83', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_sqs'}]}, 'clientToken': 'ED6591D3-5D1D-428F-8271-FBDB2755FD09', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0d7b3374ec048ab52', 'subnetId': 'subnet-0803c343c9dbf2502', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:7d:54:5c:0f:35', 'privateIpAddress': '10.20.100.83', 'privateDnsName': 'ip-10-20-100-83.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'attachment': {'attachmentId': 'eni-attach-0eaa76a5667b6c232', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972512000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.100.83', 'privateDnsName': 'ip-10-20-100-83.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'id': 'AIPASBANKG2P7LQVS7PFV'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '5ba0a05d-f87e-4776-ad11-95e29846c7e7', 'eventID': 'f6bbd87c-a36d-4ff6-a381-2787da7bf5a2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:26,893 - INFO - create instance - [{'PrivateIpAddress': '10.20.100.83', 'SourceDestCheck': True, 'InstanceId': 'i-0459367d7e3bc3ba4', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_sqs', 'resource_id': 'i-0459367d7e3bc3ba4..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0459367d7e3bc3ba4'}]
2021-06-06 12:50:26,894 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-0459367d7e3bc3ba4']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:27,752 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0803c343c9dbf2502', 'PrivateIpAddress': '10.20.100.83', 'DnsName': 'ip-10-20-100-83.ec2.internal', 'MacAddress': '12:7d:54:5c:0f:35', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0459367d7e3bc3ba4', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0eaa76a5667b6c232', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.100.83', 'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'resource_id': 'eni-0d7b3374ec048ab52..10.20.100.83'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_sqs', 'resource_id': 'eni-0d7b3374ec048ab52..Name'}], 'resource_id': 'eni-0d7b3374ec048ab52'}]}
2021-06-06 12:50:27,752 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-06513cfe251115cb0']}]}}}
2021-06-06 12:50:28,517 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}], 'resource_id': 'sg-06513cfe251115cb0'}]}
2021-06-06 12:50:28,517 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-0459367d7e3bc3ba4']}]}}}
2021-06-06 12:50:29,924 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-0901cebcb95b446b1', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-0459367d7e3bc3ba4', 'volume_attachment': [{'InstanceId': 'i-0459367d7e3bc3ba4', 'VolumeId': 'vol-0901cebcb95b446b1', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0901cebcb95b446b1..i-0459367d7e3bc3ba4'}], 'resource_id': 'vol-0901cebcb95b446b1'}]}
2021-06-06 12:50:29,957 - INFO - Get previous translated snapshot with timestamp 1622973020628 took 0.03 seconds
2021-06-06 12:50:29,965 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-0eaa76a5667b6c232', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-100-83.ec2.internal', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0459367d7e3bc3ba4', 'InterfaceType': 'interface', 'MacAddress': '12:7d:54:5c:0f:35', 'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'PrivateIpAddress': '10.20.100.83', 'SourceDestCheck': True, 'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0d7b3374ec048ab52', 'PrivateIpAddress': '10.20.100.83', 'resource_id': 'eni-0d7b3374ec048ab52..10.20.100.83'}], 'resource_id': 'eni-0d7b3374ec048ab52', 'tag': [{'Key': 'Name', 'Value': 'test_interface_sqs', 'resource_id': 'eni-0d7b3374ec048ab52..Name'}]} 
2021-06-06 12:50:29,970 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}]} 
2021-06-06 12:50:29,975 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.20.100.83', 'SourceDestCheck': True, 'InstanceId': 'i-0459367d7e3bc3ba4', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_sqs', 'resource_id': 'i-0459367d7e3bc3ba4..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0459367d7e3bc3ba4'}], 'instance_volume': [{'VolumeId': 'vol-0901cebcb95b446b1', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-0459367d7e3bc3ba4', 'volume_attachment': [{'InstanceId': 'i-0459367d7e3bc3ba4', 'VolumeId': 'vol-0901cebcb95b446b1', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-0901cebcb95b446b1..i-0459367d7e3bc3ba4'}], 'resource_id': 'vol-0901cebcb95b446b1'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973020628}
2021-06-06 12:50:30,049 - INFO - Calling modeler on-new-snapshot for timestamp 1622973029924 ...
2021-06-06 12:50:30,226 - INFO - Calling analyzer for timestamp 1622973029924 ...
2021-06-06 12:50:35,743 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:50:35,743 - INFO - Finished triggering everything for timestamp 1622973029924 after 5.76 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.18), ('analyzer', 5.49)]
2021-06-06 12:50:35,893 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RegisterInstancesWithLoadBalancer in us-east-1 at 2021-06-06T09:41:55Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:55Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'RegisterInstancesWithLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'instances': [{'instanceId': 'i-0b26f2433f51be1c4'}]}, 'responseElements': {'instances': [{'instanceId': 'i-0b26f2433f51be1c4'}]}, 'requestID': 'f68e2bb3-e4b6-41ff-ad08-ae4fcad4def4', 'eventID': '4043ddca-db10-4841-8aa1-b7a2568725f9', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:35,895 - INFO - modify elb - []
2021-06-06 12:50:35,895 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:50:38,310 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:50:38,336 - INFO - Get previous translated snapshot with timestamp 1622973029924 took 0.02 seconds
2021-06-06 12:50:38,340 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:50:38,341 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973029924}
2021-06-06 12:50:38,488 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateLoadBalancerListeners in us-east-1 at 2021-06-06T09:41:54Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:54Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'CreateLoadBalancerListeners', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'listeners': [{'sSLCertificateId': '', 'protocol': 'HTTP', 'loadBalancerPort': 80, 'instanceProtocol': 'HTTP', 'instancePort': 8000}], 'loadBalancerName': 'test-elb-2796885'}, 'responseElements': None, 'requestID': 'a6d0d2f4-081a-4116-9962-237e6568389c', 'eventID': '66516af7-783d-47ff-afad-f2df8cf0a8fd', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:38,488 - INFO - modify elb - []
2021-06-06 12:50:38,488 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:50:39,567 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:50:39,593 - INFO - Get previous translated snapshot with timestamp 1622973029924 took 0.03 seconds
2021-06-06 12:50:39,597 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:50:39,598 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973029924}
2021-06-06 12:50:39,885 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:42:05.037Z, account_id: N/A, extra:{'instance-id': 'i-08e91318bdb27a3b4', 'state': 'running'}
2021-06-06 12:50:40,074 - INFO - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:43:33Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PTXLBH4KPM:i-0bedadb3dfadfbb56', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0bedadb3dfadfbb56', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2P22WQ7N5Q', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PTXLBH4KPM', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:24Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:43:33Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '54.144.245.121', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'requestParameters': {'cluster': 'test_ecs_cluster', 'task': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'attachments': [{'attachmentArn': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'status': 'ATTACHED'}]}, 'responseElements': {'acknowledgment': 'ack'}, 'requestID': '048ace1f-80cf-4aef-b75d-035540600872', 'eventID': 'edb0a5dc-dd54-43be-a2fd-dd0ea9118759', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:40,075 - INFO - modify ecs - [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}]
2021-06-06 12:50:40,075 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'ecs': {'filters': [{'name': 'clusterArn', 'values': ['arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster']}]}}}
2021-06-06 12:50:44,787 - INFO - scanned resources: {'ecs': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'status': 'ACTIVE', 'registeredContainerInstancesCount': 3, 'pendingTasksCount': 0, 'runningTasksCount': 3, 'activeServicesCount': 2, 'container_instance': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}], 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'launchType': 'EC2', 'pendingTasksCount': 0, 'runningTasksCount': 2, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/4959225571735023063', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'desiredCount': 2, 'pendingCount': 0, 'runningCount': 2, 'failedTasks': 0, 'launchType': 'EC2', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/6347564329799363003', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'desiredCount': 1, 'pendingCount': 0, 'runningCount': 1, 'failedTasks': 0, 'launchType': 'FARGATE', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}], 'task': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc'}, {'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'FARGATE', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}]}
2021-06-06 12:50:44,827 - INFO - Get previous translated snapshot with timestamp 1622973029924 took 0.03 seconds
2021-06-06 12:50:44,833 - INFO - sub-event will be discarded because no change in resource configuration: {'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 2, 'failedTasks': 0, 'id': 'ecs-svc/4959225571735023063', 'launchType': 'EC2', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063', 'rolloutState': 'COMPLETED', 'runningCount': 2, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}], 'launchType': 'EC2', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'runningTasksCount': 2, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}]}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 1, 'failedTasks': 0, 'id': 'ecs-svc/6347564329799363003', 'launchType': 'FARGATE', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003', 'rolloutState': 'COMPLETED', 'runningCount': 1, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22'}], 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'runningTasksCount': 1, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}]}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'cpu': '256', 'launchType': 'FARGATE', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22'}]} 
2021-06-06 12:50:44,856 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973029924}
2021-06-06 12:50:45,007 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:44:04.393Z, account_id: N/A, extra:{'EventCategories': ['creation'], 'SourceType': 'DB_INSTANCE', 'SourceArn': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606094017231600000008', 'Date': '2021-06-06T09:44:03.177Z', 'Message': 'DB instance created', 'SourceIdentifier': 'terraform-20210606094017231600000008', 'EventID': 'RDS-EVENT-0005'}
2021-06-06 12:50:47,002 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:40:23Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:40:23Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-090cfb622a4e9acbc', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'privateIpAddressesSet': {}, 'tagSpecificationSet': {'items': [{'resourceType': 'network-interface', 'tags': [{'key': 'Name', 'value': 'test_interface_kinesis'}]}]}}, 'responseElements': {'requestId': 'c09add1e-3111-497a-bf23-80e875370ad6', 'networkInterface': {'networkInterfaceId': 'eni-0246404e261080399', 'subnetId': 'subnet-090cfb622a4e9acbc', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'availabilityZone': 'us-east-1b', 'ownerId': '139614369439', 'requesterManaged': False, 'status': 'pending', 'macAddress': '0a:c5:ec:ee:66:f9', 'privateIpAddress': '10.20.110.83', 'privateDnsName': 'ip-10-20-110-83.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0', 'groupName': 'test_security_group_vpce'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.110.83', 'privateDnsName': 'ip-10-20-110-83.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {'items': [{'key': 'Name', 'value': 'test_interface_kinesis'}]}}}, 'requestID': 'c09add1e-3111-497a-bf23-80e875370ad6', 'eventID': 'ba3ca78b-2602-42b1-a158-7c8cc51789d4', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:47,004 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-0246404e261080399', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'PrivateIpAddress': '10.20.110.83', 'MacAddress': '0a:c5:ec:ee:66:f9', 'GroupId': ['sg-06513cfe251115cb0'], 'SourceDestCheck': True, 'InterfaceType': 'interface', 'tag': [{'Key': 'Name', 'Value': 'test_interface_kinesis', 'resource_id': 'eni-0246404e261080399..Name'}], 'resource_id': 'eni-0246404e261080399'}]
2021-06-06 12:50:47,005 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0246404e261080399']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:47,828 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0246404e261080399', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1b', 'SubnetId': 'subnet-090cfb622a4e9acbc', 'PrivateIpAddress': '10.20.110.83', 'DnsName': 'ip-10-20-110-83.ec2.internal', 'MacAddress': '0a:c5:ec:ee:66:f9', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0c07e959d87683383', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-005d8b823d5d3ad30', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.110.83', 'NetworkInterfaceId': 'eni-0246404e261080399', 'resource_id': 'eni-0246404e261080399..10.20.110.83'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_kinesis', 'resource_id': 'eni-0246404e261080399..Name'}], 'resource_id': 'eni-0246404e261080399'}]}
2021-06-06 12:50:47,853 - INFO - Get previous translated snapshot with timestamp 1622973029924 took 0.02 seconds
2021-06-06 12:50:47,858 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-005d8b823d5d3ad30', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-110-83.ec2.internal', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0c07e959d87683383', 'InterfaceType': 'interface', 'MacAddress': '0a:c5:ec:ee:66:f9', 'NetworkInterfaceId': 'eni-0246404e261080399', 'PrivateIpAddress': '10.20.110.83', 'SourceDestCheck': True, 'SubnetId': 'subnet-090cfb622a4e9acbc', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0246404e261080399', 'PrivateIpAddress': '10.20.110.83', 'resource_id': 'eni-0246404e261080399..10.20.110.83'}], 'resource_id': 'eni-0246404e261080399', 'tag': [{'Key': 'Name', 'Value': 'test_interface_kinesis', 'resource_id': 'eni-0246404e261080399..Name'}]} 
2021-06-06 12:50:47,858 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973029924}
2021-06-06 12:50:48,021 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:32.855Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 2, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:32.341Z', 'registeredAt': '2021-06-06T09:40:32.186Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:50:48,270 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:35.629Z, account_id: N/A, extra:{'attachments': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'eni', 'status': 'PRECREATED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710/454035b1-0f2b-4a6c-82da-a7dca7d542bd', 'lastStatus': 'PENDING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'networkInterfaces': [], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:40:35.364Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'PROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'startedBy': 'ecs-svc/4959225571735023063', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'updatedAt': '2021-06-06T09:40:35.364Z', 'version': 1}
2021-06-06 12:50:48,467 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:35.647Z, account_id: N/A, extra:{'attachments': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'eni', 'status': 'PRECREATED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc/323acebb-323e-4ec8-82db-92e358a62d8e', 'lastStatus': 'PENDING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'networkInterfaces': [], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:40:35.364Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'PROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'startedBy': 'ecs-svc/4959225571735023063', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'updatedAt': '2021-06-06T09:40:35.364Z', 'version': 1}
2021-06-06 12:50:48,776 - INFO - User N/A (ecs.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:40:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:40:38Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:40:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-0e7e54192b01b1ed0', 'description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'groupSet': {}, 'privateIpAddressesSet': {}}, 'responseElements': {'requestId': '1eda1e49-b0c8-4d6e-8ccb-d7165db8fa97', 'networkInterface': {'networkInterfaceId': 'eni-05095d1d9d13f13f3', 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'availabilityZone': 'us-east-1a', 'description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'ownerId': '139614369439', 'requesterId': '578734482556', 'requesterManaged': True, 'status': 'pending', 'macAddress': '12:ed:f4:02:8a:4b', 'privateIpAddress': '172.31.9.32', 'privateDnsName': 'ip-172-31-9-32.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '172.31.9.32', 'privateDnsName': 'ip-172-31-9-32.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': '1eda1e49-b0c8-4d6e-8ccb-d7165db8fa97', 'eventID': '56ee8d57-327e-4460-813d-d7bee3fe4a8a', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:48,776 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.9.32', 'MacAddress': '12:ed:f4:02:8a:4b', 'GroupId': ['sg-fee06cc9'], 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-05095d1d9d13f13f3'}]
2021-06-06 12:50:48,777 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-05095d1d9d13f13f3']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:49,731 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.9.32', 'DnsName': 'ip-172-31-9-32.ec2.internal', 'MacAddress': '12:ed:f4:02:8a:4b', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02770f627db5fc799', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '172.31.9.32', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'}]}
2021-06-06 12:50:49,757 - INFO - Get previous translated snapshot with timestamp 1622973029924 took 0.03 seconds
2021-06-06 12:50:49,762 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-02770f627db5fc799', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/b689a700-9b8a-4d47-914c-83dc5a1266a0', 'DeviceIndex': 1, 'DnsName': 'ip-172-31-9-32.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bedadb3dfadfbb56', 'InterfaceType': 'interface', 'MacAddress': '12:ed:f4:02:8a:4b', 'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'PrivateIpAddress': '172.31.9.32', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-05095d1d9d13f13f3', 'PrivateIpAddress': '172.31.9.32', 'resource_id': 'eni-05095d1d9d13f13f3..172.31.9.32'}], 'resource_id': 'eni-05095d1d9d13f13f3'} 
2021-06-06 12:50:49,763 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973029924}
2021-06-06 12:50:49,913 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:40:51.888Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 6, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:40:35.373Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:50:50,108 - INFO - User N/A (rds.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:40:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PVTMOOHZ6U:SLRManagement', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForRDS/SLRManagement', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PVTMOOHZ6U', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForRDS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:40:53Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'rds.amazonaws.com'}, 'eventTime': '2021-06-06T09:40:53Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'rds.amazonaws.com', 'userAgent': 'rds.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-083e75a9da33deaec', 'description': 'RDSNetworkInterface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'ipv6AddressCount': 0}, 'responseElements': {'requestId': 'dd8117f0-0878-413a-9253-89e8c1c842d9', 'networkInterface': {'networkInterfaceId': 'eni-080489651fff1c95b', 'subnetId': 'subnet-083e75a9da33deaec', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1c', 'description': 'RDSNetworkInterface', 'ownerId': '139614369439', 'requesterId': 'amazon-rds', 'requesterManaged': True, 'status': 'pending', 'macAddress': '0e:1d:74:cd:1e:91', 'privateIpAddress': '10.10.80.203', 'privateDnsName': 'ip-10-10-80-203.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.80.203', 'privateDnsName': 'ip-10-10-80-203.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': 'dd8117f0-0878-413a-9253-89e8c1c842d9', 'eventID': '6995a3b1-8f47-4b35-8e01-1a241f7ad2aa', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:50,109 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-080489651fff1c95b', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.203', 'MacAddress': '0e:1d:74:cd:1e:91', 'GroupId': ['sg-0af2498b5cbd583f6'], 'Description': 'RDSNetworkInterface', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-080489651fff1c95b'}]
2021-06-06 12:50:50,109 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-080489651fff1c95b']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:51,029 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-080489651fff1c95b', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.203', 'DnsName': 'ip-10-10-80-203.ec2.internal', 'MacAddress': '0e:1d:74:cd:1e:91', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-09ea1802250229682', 'Description': 'RDSNetworkInterface', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.80.203', 'NetworkInterfaceId': 'eni-080489651fff1c95b', 'resource_id': 'eni-080489651fff1c95b..10.10.80.203'}], 'resource_id': 'eni-080489651fff1c95b'}]}
2021-06-06 12:50:51,054 - INFO - Get previous translated snapshot with timestamp 1622973029924 took 0.03 seconds
2021-06-06 12:50:51,060 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-080489651fff1c95b', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1c', 'SubnetId': 'subnet-083e75a9da33deaec', 'PrivateIpAddress': '10.10.80.203', 'DnsName': 'ip-10-10-80-203.ec2.internal', 'MacAddress': '0e:1d:74:cd:1e:91', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-09ea1802250229682', 'Description': 'RDSNetworkInterface', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.80.203', 'NetworkInterfaceId': 'eni-080489651fff1c95b', 'resource_id': 'eni-080489651fff1c95b..10.10.80.203'}], 'resource_id': 'eni-080489651fff1c95b'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973029924}
2021-06-06 12:50:51,123 - INFO - Calling modeler on-new-snapshot for timestamp 1622973051029 ...
2021-06-06 12:50:51,422 - INFO - Calling analyzer for timestamp 1622973051029 ...
2021-06-06 12:50:55,071 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:50:55,071 - INFO - Finished triggering everything for timestamp 1622973051029 after 4.00 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.3), ('analyzer', 3.62)]
2021-06-06 12:50:56,037 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:00Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': '50bc369f-87ea-48ae-9ed3-27118f6bc8fd', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': 'db9d0a2e-d209-492d-8cb7-dd7a1d0bc0de', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:50:56,245 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:28.320Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_2'}}
2021-06-06 12:50:57,028 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:35.182Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'natgateway', 'version': 1.0, 'tags': {'Name': 'test_nat_gw'}}
2021-06-06 12:50:57,515 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:44:19Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:44:19Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:44:19Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-0794a2e17f9656258', 'description': 'ELB test-elb-2796885', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6'}]}, 'privateIpAddressesSet': {}, 'ipv6AddressCount': 0}, 'responseElements': {'requestId': '45051ade-bb7c-4d73-be05-d0d5542b0025', 'networkInterface': {'networkInterfaceId': 'eni-04670714e854c45d6', 'subnetId': 'subnet-0794a2e17f9656258', 'vpcId': 'vpc-0f057794b5da52459', 'availabilityZone': 'us-east-1a', 'description': 'ELB test-elb-2796885', 'ownerId': '139614369439', 'requesterId': 'amazon-elb', 'requesterManaged': True, 'status': 'pending', 'macAddress': '12:3c:ad:30:e5:39', 'privateIpAddress': '10.10.10.59', 'privateDnsName': 'ip-10-10-10-59.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-0af2498b5cbd583f6', 'groupName': 'test_security_group'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.10.10.59', 'privateDnsName': 'ip-10-10-10-59.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': '45051ade-bb7c-4d73-be05-d0d5542b0025', 'eventID': '4788dcd9-1509-45dc-a21c-5e3c94a313cb', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:50:57,515 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-04670714e854c45d6', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.59', 'MacAddress': '12:3c:ad:30:e5:39', 'GroupId': ['sg-0af2498b5cbd583f6'], 'Description': 'ELB test-elb-2796885', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-04670714e854c45d6'}]
2021-06-06 12:50:57,515 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-04670714e854c45d6']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:50:58,472 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-04670714e854c45d6', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.59', 'DnsName': 'ip-10-10-10-59.ec2.internal', 'MacAddress': '12:3c:ad:30:e5:39', 'PublicIpAddress': '52.21.60.36', 'PublicDnsName': 'ec2-52-21-60-36.compute-1.amazonaws.com', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0eaf4e65917a86752', 'Description': 'ELB test-elb-2796885', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.59', 'NetworkInterfaceId': 'eni-04670714e854c45d6', 'resource_id': 'eni-04670714e854c45d6..10.10.10.59'}], 'resource_id': 'eni-04670714e854c45d6'}]}
2021-06-06 12:50:58,497 - INFO - Get previous translated snapshot with timestamp 1622973051029 took 0.02 seconds
2021-06-06 12:50:58,502 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-04670714e854c45d6', 'VpcId': 'vpc-0f057794b5da52459', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0794a2e17f9656258', 'PrivateIpAddress': '10.10.10.59', 'DnsName': 'ip-10-10-10-59.ec2.internal', 'MacAddress': '12:3c:ad:30:e5:39', 'PublicIpAddress': '52.21.60.36', 'PublicDnsName': 'ec2-52-21-60-36.compute-1.amazonaws.com', 'GroupId': ['sg-0af2498b5cbd583f6'], 'DeviceIndex': 1, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0eaf4e65917a86752', 'Description': 'ELB test-elb-2796885', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.10.10.59', 'NetworkInterfaceId': 'eni-04670714e854c45d6', 'resource_id': 'eni-04670714e854c45d6..10.10.10.59'}], 'resource_id': 'eni-04670714e854c45d6'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973051029}
2021-06-06 12:50:58,576 - INFO - Calling modeler on-new-snapshot for timestamp 1622973058473 ...
2021-06-06 12:50:58,967 - INFO - Calling analyzer for timestamp 1622973058473 ...
2021-06-06 12:51:03,146 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:51:03,146 - INFO - Finished triggering everything for timestamp 1622973058473 after 4.64 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.02), ('store_trans', 0.03), ('modeler', 0.39), ('analyzer', 4.15)]
2021-06-06 12:51:04,490 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:35.422Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_3'}}
2021-06-06 12:51:04,738 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:41.102Z, account_id: N/A, extra:{'instance-id': 'i-0c085fcc61457b5b3', 'state': 'pending'}
2021-06-06 12:51:05,044 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:41:42.822Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'instance', 'version': 1.0, 'tags': {'Name': 'test-instance_4'}}
2021-06-06 12:51:05,248 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': '2CCAA095-81A9-4298-8508-51877A8E5023', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-012b6ba2716e69ea0', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {'name': 'test_profile'}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_4'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '10249c1d-a550-4bc5-ac8d-392798af47dc', 'reservationId': 'r-031fa1214e53fc8ce', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-064cdc1e76e796802', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-30-10-164.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972499000, 'placement': {'availabilityZone': 'us-east-1f', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-084dd3570a09297a9', 'vpcId': 'vpc-0bf1ce99828ae9cd2', 'privateIpAddress': '10.30.10.164', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_4'}]}, 'clientToken': '2CCAA095-81A9-4298-8508-51877A8E5023', 'groupSet': {'items': [{'groupId': 'sg-08b4e6d72763b3889'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-012b6ba2716e69ea0', 'subnetId': 'subnet-084dd3570a09297a9', 'vpcId': 'vpc-0bf1ce99828ae9cd2', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '16:66:2c:fd:6e:77', 'privateIpAddress': '10.30.10.164', 'privateDnsName': 'ip-10-30-10-164.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-08b4e6d72763b3889'}]}, 'attachment': {'attachmentId': 'eni-attach-02b117ad6488cbbcd', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972499000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.30.10.164', 'privateDnsName': 'ip-10-30-10-164.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'iamInstanceProfile': {'arn': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'id': 'AIPASBANKG2P7LQVS7PFV'}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '10249c1d-a550-4bc5-ac8d-392798af47dc', 'eventID': 'd93c24e2-abe6-4f63-b5d6-e5add5746198', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:51:05,258 - INFO - create instance - [{'PrivateIpAddress': '10.30.10.164', 'SourceDestCheck': True, 'InstanceId': 'i-064cdc1e76e796802', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-084dd3570a09297a9', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_4', 'resource_id': 'i-064cdc1e76e796802..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-064cdc1e76e796802'}]
2021-06-06 12:51:05,258 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-064cdc1e76e796802']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:51:06,464 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'AvailabilityZone': 'us-east-1f', 'SubnetId': 'subnet-084dd3570a09297a9', 'PrivateIpAddress': '10.30.10.164', 'DnsName': 'ip-10-30-10-164.ec2.internal', 'MacAddress': '16:66:2c:fd:6e:77', 'PublicIpAddress': '50.17.238.206', 'PublicDnsName': 'ec2-50-17-238-206.compute-1.amazonaws.com', 'GroupId': ['sg-08b4e6d72763b3889'], 'InstanceId': 'i-064cdc1e76e796802', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-02b117ad6488cbbcd', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.30.10.164', 'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'resource_id': 'eni-012b6ba2716e69ea0..10.30.10.164'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_4', 'resource_id': 'eni-012b6ba2716e69ea0..Name'}], 'resource_id': 'eni-012b6ba2716e69ea0'}]}
2021-06-06 12:51:06,465 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-08b4e6d72763b3889']}]}}}
2021-06-06 12:51:07,529 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-08b4e6d72763b3889', 'GroupName': 'test_security_group_3', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_3', 'resource_id': 'sg-08b4e6d72763b3889..Name'}], 'resource_id': 'sg-08b4e6d72763b3889'}]}
2021-06-06 12:51:07,530 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-064cdc1e76e796802']}]}}}
2021-06-06 12:51:09,348 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-005408b4992f4b758', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1f', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-064cdc1e76e796802', 'volume_attachment': [{'InstanceId': 'i-064cdc1e76e796802', 'VolumeId': 'vol-005408b4992f4b758', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-005408b4992f4b758..i-064cdc1e76e796802'}], 'resource_id': 'vol-005408b4992f4b758'}]}
2021-06-06 12:51:09,373 - INFO - Get previous translated snapshot with timestamp 1622973058473 took 0.02 seconds
2021-06-06 12:51:09,382 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-02b117ad6488cbbcd', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'DeviceIndex': 0, 'DnsName': 'ip-10-30-10-164.ec2.internal', 'GroupId': ['sg-08b4e6d72763b3889'], 'InstanceId': 'i-064cdc1e76e796802', 'InterfaceType': 'interface', 'MacAddress': '16:66:2c:fd:6e:77', 'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'PrivateIpAddress': '10.30.10.164', 'PublicDnsName': 'ec2-50-17-238-206.compute-1.amazonaws.com', 'PublicIpAddress': '50.17.238.206', 'SourceDestCheck': True, 'SubnetId': 'subnet-084dd3570a09297a9', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'private_ip_address': [{'NetworkInterfaceId': 'eni-012b6ba2716e69ea0', 'PrivateIpAddress': '10.30.10.164', 'resource_id': 'eni-012b6ba2716e69ea0..10.30.10.164'}], 'resource_id': 'eni-012b6ba2716e69ea0', 'tag': [{'Key': 'Name', 'Value': 'test_interface_4', 'resource_id': 'eni-012b6ba2716e69ea0..Name'}]} 
2021-06-06 12:51:09,387 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-08b4e6d72763b3889', 'GroupName': 'test_security_group_3', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'resource_id': 'sg-08b4e6d72763b3889', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-08b4e6d72763b3889..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_3', 'resource_id': 'sg-08b4e6d72763b3889..Name'}]} 
2021-06-06 12:51:09,392 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.30.10.164', 'SourceDestCheck': True, 'InstanceId': 'i-064cdc1e76e796802', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'State': 'pending', 'SubnetId': 'subnet-084dd3570a09297a9', 'VpcId': 'vpc-0bf1ce99828ae9cd2', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_4', 'resource_id': 'i-064cdc1e76e796802..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-064cdc1e76e796802'}], 'instance_volume': [{'VolumeId': 'vol-005408b4992f4b758', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1f', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-064cdc1e76e796802', 'volume_attachment': [{'InstanceId': 'i-064cdc1e76e796802', 'VolumeId': 'vol-005408b4992f4b758', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-005408b4992f4b758..i-064cdc1e76e796802'}], 'resource_id': 'vol-005408b4992f4b758'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973058473}
2021-06-06 12:51:09,465 - INFO - Calling modeler on-new-snapshot for timestamp 1622973069349 ...
2021-06-06 12:51:09,612 - INFO - Calling analyzer for timestamp 1622973069349 ...
2021-06-06 12:51:14,833 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:51:14,833 - INFO - Finished triggering everything for timestamp 1622973069349 after 5.44 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.15), ('analyzer', 5.19)]
2021-06-06 12:51:14,988 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RunInstances in us-east-1 at 2021-06-06T09:41:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'RunInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'imageId': 'ami-00ddb0e5626798373', 'minCount': 1, 'maxCount': 1}]}, 'instanceType': 't2.micro', 'blockDeviceMapping': {}, 'monitoring': {'enabled': False}, 'disableApiTermination': False, 'clientToken': 'CC860340-0316-4A8A-830B-6FF457936E26', 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0078a042e6e15c1c4', 'deviceIndex': 0, 'deleteOnTermination': False}]}, 'iamInstanceProfile': {}, 'ebsOptimized': False, 'tagSpecificationSet': {'items': [{'resourceType': 'instance', 'tags': [{'key': 'Name', 'value': 'test-instance_vpce_s3'}]}]}, 'hibernationOptions': {'configured': False}}, 'responseElements': {'requestId': '909eff31-5698-4bf1-b34d-414a4693beca', 'reservationId': 'r-09e9657d1ea0f195e', 'ownerId': '139614369439', 'groupSet': {}, 'instancesSet': {'items': [{'instanceId': 'i-0c085fcc61457b5b3', 'imageId': 'ami-00ddb0e5626798373', 'instanceState': {'code': 0, 'name': 'pending'}, 'privateDnsName': 'ip-10-20-100-143.ec2.internal', 'amiLaunchIndex': 0, 'productCodes': {}, 'instanceType': 't2.micro', 'launchTime': 1622972500000, 'placement': {'availabilityZone': 'us-east-1a', 'tenancy': 'default'}, 'monitoring': {'state': 'disabled'}, 'subnetId': 'subnet-0803c343c9dbf2502', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'privateIpAddress': '10.20.100.143', 'stateReason': {'code': 'pending', 'message': 'pending'}, 'architecture': 'x86_64', 'rootDeviceType': 'ebs', 'rootDeviceName': '/dev/sda1', 'blockDeviceMapping': {}, 'virtualizationType': 'hvm', 'hypervisor': 'xen', 'tagSet': {'items': [{'key': 'Name', 'value': 'test-instance_vpce_s3'}]}, 'clientToken': 'CC860340-0316-4A8A-830B-6FF457936E26', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'sourceDestCheck': True, 'networkInterfaceSet': {'items': [{'networkInterfaceId': 'eni-0078a042e6e15c1c4', 'subnetId': 'subnet-0803c343c9dbf2502', 'vpcId': 'vpc-06275dc7f34c8f1ac', 'ownerId': '139614369439', 'status': 'in-use', 'macAddress': '12:b7:05:33:44:25', 'privateIpAddress': '10.20.100.143', 'privateDnsName': 'ip-10-20-100-143.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-06513cfe251115cb0'}]}, 'attachment': {'attachmentId': 'eni-attach-0b8239c509f07064f', 'deviceIndex': 0, 'networkCardIndex': 0, 'status': 'attaching', 'attachTime': 1622972500000, 'deleteOnTermination': False}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '10.20.100.143', 'privateDnsName': 'ip-10-20-100-143.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}]}, 'ebsOptimized': False, 'enaSupport': True, 'cpuOptions': {'coreCount': 1, 'threadsPerCore': 1}, 'capacityReservationSpecification': {'capacityReservationPreference': 'open'}, 'hibernationOptions': {'configured': False}, 'enclaveOptions': {'enabled': False}, 'metadataOptions': {'state': 'pending', 'httpTokens': 'optional', 'httpPutResponseHopLimit': 1, 'httpEndpoint': 'enabled'}}]}}, 'requestID': '909eff31-5698-4bf1-b34d-414a4693beca', 'eventID': '874d9699-1344-4ca9-865d-3cf3eafbe7bc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:51:14,989 - INFO - create instance - [{'PrivateIpAddress': '10.20.100.143', 'SourceDestCheck': True, 'InstanceId': 'i-0c085fcc61457b5b3', 'State': 'pending', 'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_vpce_s3', 'resource_id': 'i-0c085fcc61457b5b3..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0c085fcc61457b5b3'}]
2021-06-06 12:51:14,999 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'InstanceId', 'values': ['i-0c085fcc61457b5b3']}], 'retry': {'times': 3, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:51:16,137 - INFO - scanned resources: {'network_interface': [{'NetworkInterfaceId': 'eni-0078a042e6e15c1c4', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0803c343c9dbf2502', 'PrivateIpAddress': '10.20.100.143', 'DnsName': 'ip-10-20-100-143.ec2.internal', 'MacAddress': '12:b7:05:33:44:25', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0c085fcc61457b5b3', 'DeviceIndex': 0, 'AttachmentStatus': 'attached', 'AttachmentId': 'eni-attach-0b8239c509f07064f', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'private_ip_address': [{'PrivateIpAddress': '10.20.100.143', 'NetworkInterfaceId': 'eni-0078a042e6e15c1c4', 'resource_id': 'eni-0078a042e6e15c1c4..10.20.100.143'}], 'tag': [{'Key': 'Name', 'Value': 'test_interface_vpce_1', 'resource_id': 'eni-0078a042e6e15c1c4..Name'}], 'resource_id': 'eni-0078a042e6e15c1c4'}]}
2021-06-06 12:51:16,137 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'security_group': {'filters': [{'name': 'GroupId', 'values': ['sg-06513cfe251115cb0']}]}}}
2021-06-06 12:51:16,918 - INFO - scanned resources: {'security_group': [{'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'security_ingress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'security_egress_rule': [{'IpProtocol': '-1', 'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}], 'resource_id': 'sg-06513cfe251115cb0'}]}
2021-06-06 12:51:16,918 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'instance_volume': {'filters': [{'name': ['volume_attachment', 'InstanceId'], 'values': ['i-0c085fcc61457b5b3']}]}}}
2021-06-06 12:51:17,831 - INFO - scanned resources: {'instance_volume': [{'VolumeId': 'vol-01ad4919de3170e85', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-0c085fcc61457b5b3', 'volume_attachment': [{'InstanceId': 'i-0c085fcc61457b5b3', 'VolumeId': 'vol-01ad4919de3170e85', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-01ad4919de3170e85..i-0c085fcc61457b5b3'}], 'resource_id': 'vol-01ad4919de3170e85'}]}
2021-06-06 12:51:17,857 - INFO - Get previous translated snapshot with timestamp 1622973069349 took 0.03 seconds
2021-06-06 12:51:17,866 - INFO - sub-event will be discarded because no change in resource configuration: {'AttachmentId': 'eni-attach-0b8239c509f07064f', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-100-143.ec2.internal', 'GroupId': ['sg-06513cfe251115cb0'], 'InstanceId': 'i-0c085fcc61457b5b3', 'InterfaceType': 'interface', 'MacAddress': '12:b7:05:33:44:25', 'NetworkInterfaceId': 'eni-0078a042e6e15c1c4', 'PrivateIpAddress': '10.20.100.143', 'SourceDestCheck': True, 'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0078a042e6e15c1c4', 'PrivateIpAddress': '10.20.100.143', 'resource_id': 'eni-0078a042e6e15c1c4..10.20.100.143'}], 'resource_id': 'eni-0078a042e6e15c1c4', 'tag': [{'Key': 'Name', 'Value': 'test_interface_vpce_1', 'resource_id': 'eni-0078a042e6e15c1c4..Name'}]} 
2021-06-06 12:51:17,871 - INFO - sub-event will be discarded because no change in resource configuration: {'GroupId': 'sg-06513cfe251115cb0', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'resource_id': 'sg-06513cfe251115cb0', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-06513cfe251115cb0..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-06513cfe251115cb0..Name'}]} 
2021-06-06 12:51:17,876 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'instance': [{'PrivateIpAddress': '10.20.100.143', 'SourceDestCheck': True, 'InstanceId': 'i-0c085fcc61457b5b3', 'State': 'pending', 'SubnetId': 'subnet-0803c343c9dbf2502', 'VpcId': 'vpc-06275dc7f34c8f1ac', 'ImageId': 'ami-00ddb0e5626798373', 'tag': [{'Key': 'Name', 'Value': 'test-instance_vpce_s3', 'resource_id': 'i-0c085fcc61457b5b3..Name'}], 'InstanceType': 't2.micro', 'resource_id': 'i-0c085fcc61457b5b3'}], 'instance_volume': [{'VolumeId': 'vol-01ad4919de3170e85', 'VolumeSize': 8, 'VolumeAZ': 'us-east-1a', 'VolumeType': 'gp2', 'VolumeIops': 100, 'VolumeEncrypted': False, 'State': 'in-use', 'SnapshotId': 'snap-0b071e09e1285af85', 'VolumeFirstInstanceId': 'i-0c085fcc61457b5b3', 'volume_attachment': [{'InstanceId': 'i-0c085fcc61457b5b3', 'VolumeId': 'vol-01ad4919de3170e85', 'State': 'attached', 'Device': '/dev/sda1', 'resource_id': 'vol-01ad4919de3170e85..i-0c085fcc61457b5b3'}], 'resource_id': 'vol-01ad4919de3170e85'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973069349}
2021-06-06 12:51:17,950 - INFO - Calling modeler on-new-snapshot for timestamp 1622973077831 ...
2021-06-06 12:51:18,125 - INFO - Calling analyzer for timestamp 1622973077831 ...
2021-06-06 12:51:22,301 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:51:22,301 - INFO - Finished triggering everything for timestamp 1622973077831 after 4.41 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.17), ('analyzer', 4.15)]
2021-06-06 12:51:22,457 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:47.365Z, account_id: N/A, extra:{'instance-id': 'i-006dab3da6b657b68', 'state': 'running'}
2021-06-06 12:51:22,646 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:50.349Z, account_id: N/A, extra:{'instance-id': 'i-08405bcd1f1f290b2', 'state': 'pending'}
2021-06-06 12:51:22,850 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:41:55.485Z, account_id: N/A, extra:{'instance-id': 'i-0459367d7e3bc3ba4', 'state': 'pending'}
2021-06-06 12:51:23,054 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:36Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:36Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': 'ffc99600-c742-4a07-ab30-b26bd8187963', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': 'a437b18c-f2c4-4743-a03b-b9f30c6e434a', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:51:23,365 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyLoadBalancerAttributes in us-east-1 at 2021-06-06T09:41:57Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:41:57Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'ModifyLoadBalancerAttributes', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885', 'loadBalancerAttributes': {'connectionDraining': {'enabled': True, 'timeout': 300}}}, 'responseElements': {'loadBalancerAttributes': {'connectionDraining': {'enabled': True, 'timeout': 300}}, 'loadBalancerName': 'test-elb-2796885'}, 'requestID': '3b0c6f43-8aee-4586-b0c6-a0a77b6ed1e3', 'eventID': 'c2785535-9d06-4249-b6e7-bafa7e695771', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:51:23,366 - INFO - modify elb - []
2021-06-06 12:51:23,366 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'elb': {'filters': [{'name': 'LoadBalancerName', 'values': ['test-elb-2796885']}]}}}
2021-06-06 12:51:25,003 - INFO - scanned resources: {'elb': [{'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}], 'subnet_id': ['subnet-0794a2e17f9656258'], 'security_groups': ['sg-0af2498b5cbd583f6'], 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com'}]}
2021-06-06 12:51:25,038 - INFO - Get previous translated snapshot with timestamp 1622973077831 took 0.03 seconds
2021-06-06 12:51:25,042 - INFO - sub-event will be discarded because no change in resource configuration: {'DNSName': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-0f057794b5da52459', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0af2498b5cbd583f6'], 'subnet_id': ['subnet-0794a2e17f9656258'], 'target_instance': [{'InstanceId': 'i-0b26f2433f51be1c4', 'resource_id': 'test-elb-2796885-957413492.us-east-1.elb.amazonaws.com..i-0b26f2433f51be1c4'}]} 
2021-06-06 12:51:25,043 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973077831}
2021-06-06 12:51:25,925 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:42:17.374Z, account_id: N/A, extra:{'instance-id': 'i-0c085fcc61457b5b3', 'state': 'running'}
2021-06-06 12:51:26,079 - INFO - Invalid event id - User N/A (ec2.amazonaws.com) performed SharedSnapshotVolumeCreated in us-east-1 at 2021-06-06T09:41:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'accountId': '139614369439', 'invokedBy': 'ec2.amazonaws.com'}, 'eventTime': '2021-06-06T09:41:56Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'SharedSnapshotVolumeCreated', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ec2.amazonaws.com', 'userAgent': 'ec2.amazonaws.com', 'requestParameters': None, 'responseElements': None, 'eventID': '700c047c-df83-4e6d-888b-46d0681b2a47', 'readOnly': False, 'eventType': 'AwsServiceEvent', 'managementEvent': True, 'recipientAccountId': '139614369439', 'sharedEventID': 'fd99f532-c25b-4197-8adc-67c830047562', 'serviceEventDetails': {'snapshotId': 'snap-0b071e09e1285af85'}, 'eventCategory': 'Management'}
2021-06-06 12:51:26,233 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed AssociateAddress in us-east-1 at 2021-06-06T09:42:19Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:42:19Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AssociateAddress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-064cdc1e76e796802', 'allocationId': 'eipalloc-040b1d7c2d45c0746', 'privateIpAddress': '10.30.10.164'}, 'responseElements': {'requestId': '0bae3983-5005-4320-9cf4-6cb3bd0bceaa', '_return': True, 'associationId': 'eipassoc-06667c34c9975f65b'}, 'requestID': '0bae3983-5005-4320-9cf4-6cb3bd0bceaa', 'eventID': '152cda11-962e-4e10-be23-52204c7cbfee', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:51:26,233 - INFO - modify network_interface - []
2021-06-06 12:51:26,233 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': []}]}}}
2021-06-06 12:51:27,360 - INFO - scanned resources: {}
2021-06-06 12:51:27,360 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': []}]}}}
2021-06-06 12:51:27,392 - INFO - Get previous translated snapshot with timestamp 1622973077831 took 0.03 seconds
2021-06-06 12:51:27,398 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973077831}
2021-06-06 12:51:27,556 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:43:50.300Z, account_id: N/A, extra:{'attachments': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-05095d1d9d13f13f3'}, {'name': 'macAddress', 'value': '12:ed:f4:02:8a:4b'}, {'name': 'privateDnsName', 'value': 'ip-172-31-9-32.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.9.32'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:40:35.364Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710/454035b1-0f2b-4a6c-82da-a7dca7d542bd', 'lastStatus': 'RUNNING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': '51dbafc322d8c608971541349f1717b31e4ca026de3637b731118b2a8923f63d', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'networkInterfaces': [{'attachmentId': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'privateIpv4Address': '172.31.9.32'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:40:35.364Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'RUNNING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'pullStartedAt': '2021-06-06T09:43:44.036Z', 'pullStoppedAt': '2021-06-06T09:43:48.036Z', 'startedAt': '2021-06-06T09:43:50.036Z', 'startedBy': 'ecs-svc/4959225571735023063', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'updatedAt': '2021-06-06T09:43:50.036Z', 'version': 3}
2021-06-06 12:51:27,762 - INFO - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:43:50Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PTXLBH4KPM:i-0bedadb3dfadfbb56', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0bedadb3dfadfbb56', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2P22WQ7N5Q', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PTXLBH4KPM', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:39:24Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:43:50Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '54.144.245.121', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'requestParameters': {'cluster': 'test_ecs_cluster', 'task': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'status': 'RUNNING', 'reason': '', 'containers': [{'containerName': 'test_ecs_service', 'runtimeId': '51dbafc322d8c608971541349f1717b31e4ca026de3637b731118b2a8923f63d', 'networkBindings': [], 'status': 'RUNNING'}], 'pullStartedAt': 'Jun 6, 2021 9:43:44 AM', 'pullStoppedAt': 'Jun 6, 2021 9:43:48 AM'}, 'responseElements': {'acknowledgment': 'ack'}, 'requestID': '591f66d2-c590-47f8-9435-fa4acc64d4fa', 'eventID': '1f7a85a0-b03e-41ce-b9fa-5600694abaa7', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:51:27,763 - INFO - modify ecs - [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}]
2021-06-06 12:51:27,763 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'ecs': {'filters': [{'name': 'clusterArn', 'values': ['arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster']}]}}}
2021-06-06 12:51:31,871 - INFO - scanned resources: {'ecs': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'status': 'ACTIVE', 'registeredContainerInstancesCount': 3, 'pendingTasksCount': 0, 'runningTasksCount': 3, 'activeServicesCount': 2, 'container_instance': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id'}, {'name': 'ecs.instance-type', 'value': 't2.micro', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}], 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'launchType': 'EC2', 'pendingTasksCount': 0, 'runningTasksCount': 2, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/4959225571735023063', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'desiredCount': 2, 'pendingCount': 0, 'runningCount': 2, 'failedTasks': 0, 'launchType': 'EC2', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'status': 'ACTIVE', 'deployment': [{'id': 'ecs-svc/6347564329799363003', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'desiredCount': 1, 'pendingCount': 0, 'runningCount': 1, 'failedTasks': 0, 'launchType': 'FARGATE', 'rolloutState': 'COMPLETED', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003'}], 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}], 'task': [{'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710'}, {'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'EC2', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc'}, {'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'availabilityZone': 'us-east-1a', 'launchType': 'FARGATE', 'cpu': '256', 'memoryReservation': '512', 'attachment': [{'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface', 'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}]}
2021-06-06 12:51:31,906 - INFO - Get previous translated snapshot with timestamp 1622973077831 took 0.03 seconds
2021-06-06 12:51:31,912 - INFO - sub-event will be discarded because no change in resource configuration: {'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3', 'ec2InstanceId': 'i-09bd4d3233e68e8cc', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/c09c51d95cb84d1d840850d89f81a8f3'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 2, 'failedTasks': 0, 'id': 'ecs-svc/4959225571735023063', 'launchType': 'EC2', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/4959225571735023063', 'rolloutState': 'COMPLETED', 'runningCount': 2, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}], 'launchType': 'EC2', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'runningTasksCount': 2, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}]}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 1, 'failedTasks': 0, 'id': 'ecs-svc/6347564329799363003', 'launchType': 'FARGATE', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/6347564329799363003', 'rolloutState': 'COMPLETED', 'runningCount': 1, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22'}], 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'runningTasksCount': 1, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}]}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-05095d1d9d13f13f3', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..networkInterfaceId..eni-05095d1d9d13f13f3'}, {'detailName': 'macAddress', 'detailValue': '12:ed:f4:02:8a:4b', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..macAddress..12:ed:f4:02:8a:4b'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-32.ec2.internal', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateDnsName..ip-172-31-9-32.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.32', 'resource_id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0..privateIPv4Address..172.31.9.32'}], 'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710..b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/56378cf1ecc84d88a53f7a11bee90710', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-073e4f80decd5dd47', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..networkInterfaceId..eni-073e4f80decd5dd47'}, {'detailName': 'macAddress', 'detailValue': '12:85:60:3c:cb:13', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..macAddress..12:85:60:3c:cb:13'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-113.ec2.internal', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateDnsName..ip-172-31-10-113.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.113', 'resource_id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b..privateIPv4Address..172.31.10.113'}], 'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc..cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/618cf394d06f4ca0b7d936b173ff72fc', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:274'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-04402a82414953b52', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..networkInterfaceId..eni-04402a82414953b52'}, {'detailName': 'macAddress', 'detailValue': '12:ec:d8:a3:cc:55', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..macAddress..12:ec:d8:a3:cc:55'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-4-36.ec2.internal', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateDnsName..ip-172-31-4-36.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.4.36', 'resource_id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b..privateIPv4Address..172.31.4.36'}], 'id': '35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122..35637316-5f7c-4852-86f2-d3ae3bec9a0b', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'cpu': '256', 'launchType': 'FARGATE', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/901764ab013a4feaab7f6f2b5667f122', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:22'}]} 
2021-06-06 12:51:31,924 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622973077831}
2021-06-06 12:52:46,257 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:52:41.347Z, account_id: N/A, extra:{'agentConnected': False, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 7, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:52:41.025Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'attachments': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-073e4f80decd5dd47'}, {'name': 'macAddress', 'value': '12:85:60:3c:cb:13'}, {'name': 'privateDnsName', 'value': 'ip-172-31-10-113.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.10.113'}]}]}
2021-06-06 12:52:46,273 - ERROR - TTL crossed (401 seconds), trying to handle message from queue for last time before discarding it, retry num: 1
2021-06-06 12:52:46,273 - INFO - User N/A (AWS Internal) performed CreateOrUpdateTags in us-east-1 at 2021-06-06T09:41:36Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'ASIAIHVEMTHL3OEYZ5UQ', 'sessionContext': {'sessionIssuer': {}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:41:36Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'AWS Internal'}, 'eventTime': '2021-06-06T09:41:36Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'CreateOrUpdateTags', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'AWS Internal', 'userAgent': 'AWS Internal', 'requestParameters': {'tags': [{'propagateAtLaunch': True, 'key': 'AmazonECSManaged', 'resourceType': 'auto-scaling-group', 'resourceId': 'test_autoscaling_group'}]}, 'responseElements': None, 'requestID': '1659360d-eccf-4f0c-a82a-63a5fcb72809', 'eventID': 'e9318617-3328-4669-930e-9ae7c29e2679', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:52:46,286 - ERROR - After trying 1 times, failed to handle waiting message for last time. time passed is 401 seconds. discarding message. err: handling global tags event for resource id ['test_autoscaling_group'], but it doesnt exist in inventory
2021-06-06 12:52:46,899 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:52:41.389Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/7c421eb6b7cd407ab6309e011b17af86', 'ec2InstanceId': 'i-07e8ed8341d35c6b0', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 8, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:52:41.058Z', 'registeredAt': '2021-06-06T09:40:21.08Z', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'attachments': [{'id': 'cdd18675-4da1-443d-8ff2-eaab9173ea6b', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-073e4f80decd5dd47'}, {'name': 'macAddress', 'value': '12:85:60:3c:cb:13'}, {'name': 'privateDnsName', 'value': 'ip-172-31-10-113.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.10.113'}]}]}
2021-06-06 12:55:29,619 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:55:24.815Z, account_id: N/A, extra:{'agentConnected': False, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 7, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:55:24.404Z', 'registeredAt': '2021-06-06T09:40:32.186Z', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'attachments': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-05095d1d9d13f13f3'}, {'name': 'macAddress', 'value': '12:ed:f4:02:8a:4b'}, {'name': 'privateDnsName', 'value': 'ip-172-31-9-32.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.9.32'}]}]}
2021-06-06 12:55:30,632 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:55:25.722Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/d39465ee6aed48ad8da314611431c957', 'ec2InstanceId': 'i-0bedadb3dfadfbb56', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 8, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:55:25.437Z', 'registeredAt': '2021-06-06T09:40:32.186Z', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'attachments': [{'id': 'b689a700-9b8a-4d47-914c-83dc5a1266a0', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-05095d1d9d13f13f3'}, {'name': 'macAddress', 'value': '12:ed:f4:02:8a:4b'}, {'name': 'privateDnsName', 'value': 'ip-172-31-9-32.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.9.32'}]}]}




2021-06-06 12:21:50,117 - INFO - User N/A (console.amazonaws.com) performed LookupEvents in us-east-1 at 2021-06-06T09:21:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PRWHTKCXH', 'sessionContext': {'sessionIssuer': {}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T07:24:13Z', 'mfaAuthenticated': 'false'}}}, 'eventTime': '2021-06-06T09:21:41Z', 'eventSource': 'cloudtrail.amazonaws.com', 'eventName': 'LookupEvents', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'console.amazonaws.com', 'requestParameters': {'lookupAttributes': [{'attributeKey': 'ReadOnly', 'attributeValue': 'false'}], 'maxResults': 5}, 'responseElements': None, 'requestID': 'c3eece9a-de80-4212-a9c0-b5d084a1f630', 'eventID': 'c515947f-7e3c-4220-96b8-653022ad711f', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management', 'sessionCredentialFromConsole': 'true'}
2021-06-06 12:21:52,111 - INFO - User N/A (console.amazonaws.com) performed LookupEvents in us-east-1 at 2021-06-06T09:21:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PRWHTKCXH', 'sessionContext': {'sessionIssuer': {}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T07:24:13Z', 'mfaAuthenticated': 'false'}}}, 'eventTime': '2021-06-06T09:21:41Z', 'eventSource': 'cloudtrail.amazonaws.com', 'eventName': 'LookupEvents', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'console.amazonaws.com', 'requestParameters': {'eventCategory': 'insight', 'maxResults': 25}, 'responseElements': None, 'requestID': '960aaf2e-8fb4-41bf-9c23-252972d942b3', 'eventID': '7748174a-70c7-4ed5-a74d-2b612d02d64b', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management', 'sessionCredentialFromConsole': 'true'}
2021-06-06 12:23:08,717 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:03.933Z, account_id: N/A, extra:{'instance-id': 'i-01ebe8c99f478ce58', 'state': 'shutting-down'}
2021-06-06 12:23:08,717 - ERROR - TTL crossed (281 seconds), trying to handle message from queue for last time before discarding it, retry num: 1
2021-06-06 12:23:08,717 - INFO - User N/A (AWS Internal) performed CreateOrUpdateTags in us-east-1 at 2021-06-06T09:09:30Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'ASIAIU75MO4PXZAGPBQQ', 'sessionContext': {'sessionIssuer': {}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:09:30Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'AWS Internal'}, 'eventTime': '2021-06-06T09:09:30Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'CreateOrUpdateTags', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'AWS Internal', 'userAgent': 'AWS Internal', 'requestParameters': {'tags': [{'propagateAtLaunch': True, 'key': 'AmazonECSManaged', 'resourceType': 'auto-scaling-group', 'resourceId': 'test_autoscaling_group'}]}, 'responseElements': None, 'requestID': '01f0fa38-6877-44a6-8cd3-82b5a93328eb', 'eventID': 'f40f8307-b4d2-45fa-9e8f-53d61c3dabe2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:08,728 - ERROR - After trying 1 times, failed to handle waiting message for last time. time passed is 281 seconds. discarding message. err: handling global tags event for resource id ['test_autoscaling_group'], but it doesnt exist in inventory
2021-06-06 12:23:09,085 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:04.206Z, account_id: N/A, extra:{'instance-id': 'i-0167013933823206a', 'state': 'shutting-down'}
2021-06-06 12:23:09,509 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:04.186Z, account_id: N/A, extra:{'instance-id': 'i-0d85e45ef5c46f62f', 'state': 'shutting-down'}
2021-06-06 12:23:09,859 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteTargetGroup in us-east-1 at 2021-06-06T09:23:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:02Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteTargetGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/00e104c81d553da67e'}, 'responseElements': None, 'requestID': 'b7b85cff-3c5b-4414-adcb-8547f8c20090', 'eventID': '59ffc9ee-bed6-4f80-b061-7b56cd8910bf', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:09,860 - INFO - delete target_group - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/00e104c81d553da67e']
2021-06-06 12:23:09,903 - INFO - Get previous translated snapshot with timestamp 1622971193675 took 0.04 seconds
2021-06-06 12:23:09,908 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'target_group': [{'Port': 6081, 'Protocol': 'GENEVE', 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/00e104c81d553da67e', 'TargetGroupName': 'test-target-group', 'TargetType': 'instance', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-target-group/00e104c81d553da67e'}]}}}, 'previous_timestamp': 1622971193675}
2021-06-06 12:23:09,965 - INFO - Calling modeler on-new-snapshot for timestamp 1622971389860 ...
2021-06-06 12:23:10,049 - INFO - Calling analyzer for timestamp 1622971389860 ...
2021-06-06 12:23:13,381 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:13,381 - INFO - Finished triggering everything for timestamp 1622971389860 after 3.47 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.08), ('analyzer', 3.31)]
2021-06-06 12:23:13,541 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:04.733Z, account_id: N/A, extra:{'instance-id': 'i-027316ea5aa78f08b', 'state': 'shutting-down'}
2021-06-06 12:23:13,915 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:07.224Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'security-group', 'version': 4.0, 'tags': {}}
2021-06-06 12:23:14,077 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:02Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-01ebe8c99f478ce58', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '2226f266-5b7e-41b1-90d2-03bf3a6e662f', '_return': True}, 'requestID': '2226f266-5b7e-41b1-90d2-03bf3a6e662f', 'eventID': 'adb43167-665e-463f-a03e-288ba77a30db', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:14,078 - INFO - modify instance - [{'InstanceId': 'i-01ebe8c99f478ce58', 'resource_id': 'i-01ebe8c99f478ce58'}]
2021-06-06 12:23:14,103 - INFO - Get previous translated snapshot with timestamp 1622971389860 took 0.03 seconds
2021-06-06 12:23:14,110 - INFO - sub-event will be discarded because no change in resource configuration: {'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-01ebe8c99f478ce58', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.100.46', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'i-01ebe8c99f478ce58', 'tag': [{'Key': 'Name', 'Value': 'test-instance_vpce_s3', 'resource_id': 'i-01ebe8c99f478ce58..Name'}]} 
2021-06-06 12:23:14,112 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971389860}
2021-06-06 12:23:14,463 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:05.236Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'key-pair', 'version': 2.0, 'tags': {}}
2021-06-06 12:23:14,980 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:04.358Z, account_id: N/A, extra:{'instance-id': 'i-0a695efad9fed3af9', 'state': 'shutting-down'}
2021-06-06 12:23:15,143 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:04.374Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'elasticloadbalancing', 'resource-type': 'targetgroup', 'version': 1.0, 'tags': {}}
2021-06-06 12:23:15,386 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteDBInstance in us-east-1 at 2021-06-06T09:23:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:02Z', 'eventSource': 'rds.amazonaws.com', 'eventName': 'DeleteDBInstance', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'dBInstanceIdentifier': 'terraform-20210606090936358700000008', 'skipFinalSnapshot': True, 'deleteAutomatedBackups': True}, 'responseElements': {'dBInstanceIdentifier': 'terraform-20210606090936358700000008', 'dBInstanceClass': 'db.t2.micro', 'engine': 'mysql', 'dBInstanceStatus': 'deleting', 'masterUsername': 'demo', 'dBName': 'test_rds', 'endpoint': {'address': 'terraform-20210606090936358700000008.cbgrvnfvd7hc.us-east-1.rds.amazonaws.com', 'port': 3306, 'hostedZoneId': 'Z2R2ITUGPM61AM'}, 'allocatedStorage': 20, 'instanceCreateTime': 'Jun 6, 2021 9:13:45 AM', 'preferredBackupWindow': '07:34-08:04', 'backupRetentionPeriod': 0, 'dBSecurityGroups': [], 'vpcSecurityGroups': [{'vpcSecurityGroupId': 'sg-0aa68cd0fc33a9815', 'status': 'active'}], 'dBParameterGroups': [{'dBParameterGroupName': 'default.mysql5.7', 'parameterApplyStatus': 'in-sync'}], 'availabilityZone': 'us-east-1c', 'dBSubnetGroup': {'dBSubnetGroupName': 'test_db_subnet_group', 'dBSubnetGroupDescription': 'Managed by Terraform', 'vpcId': 'vpc-05c66fc27c8de6f73', 'subnetGroupStatus': 'Complete', 'subnets': [{'subnetIdentifier': 'subnet-021a1875159060d7b', 'subnetAvailabilityZone': {'name': 'us-east-1d'}, 'subnetOutpost': {}, 'subnetStatus': 'Active'}, {'subnetIdentifier': 'subnet-0427564926cbfc43f', 'subnetAvailabilityZone': {'name': 'us-east-1c'}, 'subnetOutpost': {}, 'subnetStatus': 'Active'}]}, 'preferredMaintenanceWindow': 'tue:04:48-tue:05:18', 'pendingModifiedValues': {}, 'multiAZ': False, 'engineVersion': '5.7.26', 'autoMinorVersionUpgrade': True, 'readReplicaDBInstanceIdentifiers': [], 'licenseModel': 'general-public-license', 'optionGroupMemberships': [{'optionGroupName': 'default:mysql-5-7', 'status': 'in-sync'}], 'publiclyAccessible': False, 'storageType': 'gp2', 'dbInstancePort': 0, 'storageEncrypted': False, 'dbiResourceId': 'db-B2VZ2MRX6XN756Z2RVF37MYANI', 'cACertificateIdentifier': '', 'domainMemberships': [], 'copyTagsToSnapshot': False, 'monitoringInterval': 0, 'dBInstanceArn': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008', 'iAMDatabaseAuthenticationEnabled': False, 'performanceInsightsEnabled': False, 'deletionProtection': False, 'associatedRoles': [], 'httpEndpointEnabled': False, 'tagList': [{'key': 'Name', 'value': 'test_rds'}], 'customerOwnedIpEnabled': False, 'networkType': 'IPV4'}, 'requestID': '035c71a1-9236-4f27-903b-16d793d45819', 'eventID': 'd8bbe2c2-9efe-422a-8eac-9758b781dd17', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:15,387 - INFO - delete rds - ['arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008']
2021-06-06 12:23:15,468 - INFO - Get previous translated snapshot with timestamp 1622971389860 took 0.08 seconds
2021-06-06 12:23:15,486 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'rds': [{'AvailabilityZone': 'us-east-1c', 'BackupRetentionPeriod': 0, 'DBInstanceArn': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008', 'DBInstanceClass': 'db.t2.micro', 'DBInstanceIdentifier': 'terraform-20210606090936358700000008', 'DBInstanceStatus': 'available', 'EndpointAddress': 'terraform-20210606090936358700000008.cbgrvnfvd7hc.us-east-1.rds.amazonaws.com', 'EndpointPort': 3306, 'Engine': 'mysql', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'MultiAZ': False, 'StorageEncrypted': False, 'StorageType': 'gp2', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008', 'tag': [{'Key': 'Name', 'Value': 'test_rds', 'resource_id': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008..Name'}]}]}}}, 'previous_timestamp': 1622971389860}
2021-06-06 12:23:15,951 - INFO - Calling modeler on-new-snapshot for timestamp 1622971395388 ...
2021-06-06 12:23:16,060 - INFO - Calling analyzer for timestamp 1622971395388 ...
2021-06-06 12:23:21,081 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:21,081 - INFO - Finished triggering everything for timestamp 1622971395388 after 5.59 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_sub_events', 0.04), ('store_ct_event', 0.1), ('modeler', 0.11), ('store_classified', 0.14), ('store_trans', 0.18), ('analyzer', 5.0)]
2021-06-06 12:23:21,307 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:02Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-0167013933823206a', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '357513d1-1018-42a4-bd9b-40fa26cfdae3', '_return': True}, 'requestID': '357513d1-1018-42a4-bd9b-40fa26cfdae3', 'eventID': '580729bf-4234-4021-8186-aa7c65d4f6df', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:21,309 - INFO - modify instance - [{'InstanceId': 'i-0167013933823206a', 'resource_id': 'i-0167013933823206a'}]
2021-06-06 12:23:21,344 - INFO - Get previous translated snapshot with timestamp 1622971395388 took 0.03 seconds
2021-06-06 12:23:21,348 - INFO - sub-event will be discarded because no change in resource configuration: {'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-0167013933823206a', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.10.145', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0d3d1a7eb7bc2053f', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'i-0167013933823206a', 'tag': [{'Key': 'Name', 'Value': 'test-instance_3', 'resource_id': 'i-0167013933823206a..Name'}]} 
2021-06-06 12:23:21,349 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971395388}
2021-06-06 12:23:21,509 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSecurityGroup in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-031c8030095e1115b'}, 'responseElements': {'requestId': '10488f18-d8b5-4d8c-9170-cac3a1c2be41', '_return': True}, 'requestID': '10488f18-d8b5-4d8c-9170-cac3a1c2be41', 'eventID': '1f12e47e-06dc-41ac-88e1-faca7d73160e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:21,510 - INFO - delete security_group - ['sg-031c8030095e1115b']
2021-06-06 12:23:21,539 - INFO - Get previous translated snapshot with timestamp 1622971395388 took 0.03 seconds
2021-06-06 12:23:21,546 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'security_group': [{'GroupId': 'sg-031c8030095e1115b', 'GroupName': 'test_security_group_nat', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'sg-031c8030095e1115b', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-031c8030095e1115b..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-031c8030095e1115b..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_nat', 'resource_id': 'sg-031c8030095e1115b..Name'}]}]}}}, 'previous_timestamp': 1622971395388}
2021-06-06 12:23:21,611 - INFO - Calling modeler on-new-snapshot for timestamp 1622971401510 ...
2021-06-06 12:23:21,661 - INFO - Calling analyzer for timestamp 1622971401510 ...
2021-06-06 12:23:25,483 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:25,483 - INFO - Finished triggering everything for timestamp 1622971401510 after 3.93 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('set_complete', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.05), ('analyzer', 3.78)]
2021-06-06 12:23:25,656 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNatGateway in us-east-1 at 2021-06-06T09:23:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:04Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNatGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'DeleteNatGatewayRequest': {'NatGatewayId': 'nat-03cc65840c5d87198'}}, 'responseElements': {'DeleteNatGatewayResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': '29b39e9b-2581-4354-8de3-277dbda15b02', 'natGatewayId': 'nat-03cc65840c5d87198'}}, 'requestID': '29b39e9b-2581-4354-8de3-277dbda15b02', 'eventID': '9eea6feb-9433-4b07-bd89-b00954b2b750', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:25,657 - INFO - delete nat_gateway - ['nat-03cc65840c5d87198']
2021-06-06 12:23:25,705 - INFO - Get previous translated snapshot with timestamp 1622971401510 took 0.05 seconds
2021-06-06 12:23:25,722 - INFO - delete network_interface: eni-04ba1cd6fa075f6e3 (deleted by key: Description, value: Interface for NAT Gateway nat-03cc65840c5d87198)
2021-06-06 12:23:25,724 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'nat_gateway': [{'NatGatewayId': 'nat-03cc65840c5d87198', 'State': 'available', 'SubnetId': 'subnet-08c5e41d5c820a59f', 'VpcId': 'vpc-0073beecbc61fd56a', 'nat_gateway_address': [{'AllocationId': 'eipalloc-035398b001106e9f9', 'NetworkInterfaceId': 'eni-04ba1cd6fa075f6e3', 'PrivateIp': '10.40.10.68', 'PublicIp': '34.195.13.123', 'resource_id': 'nat-03cc65840c5d87198..eni-04ba1cd6fa075f6e3'}], 'resource_id': 'nat-03cc65840c5d87198', 'tag': [{'Key': 'Name', 'Value': 'test_nat_gw', 'resource_id': 'nat-03cc65840c5d87198..Name'}]}], 'network_interface': [{'AttachmentId': 'ela-attach-0d51232aa4dc51e0c', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1c', 'Description': 'Interface for NAT Gateway nat-03cc65840c5d87198', 'DeviceIndex': 1, 'DnsName': 'ip-10-40-10-68.ec2.internal', 'GroupId': [], 'InterfaceType': 'nat_gateway', 'MacAddress': '0e:aa:e3:94:69:f3', 'NetworkInterfaceId': 'eni-04ba1cd6fa075f6e3', 'PrivateIpAddress': '10.40.10.68', 'PublicDnsName': 'ec2-34-195-13-123.compute-1.amazonaws.com', 'PublicIpAddress': '34.195.13.123', 'SourceDestCheck': False, 'SubnetId': 'subnet-08c5e41d5c820a59f', 'VpcId': 'vpc-0073beecbc61fd56a', 'private_ip_address': [{'NetworkInterfaceId': 'eni-04ba1cd6fa075f6e3', 'PrivateIpAddress': '10.40.10.68', 'resource_id': 'eni-04ba1cd6fa075f6e3..10.40.10.68'}], 'resource_id': 'eni-04ba1cd6fa075f6e3'}]}}}, 'previous_timestamp': 1622971401510}
2021-06-06 12:23:25,950 - INFO - Calling modeler on-new-snapshot for timestamp 1622971405659 ...
2021-06-06 12:23:26,147 - INFO - Calling analyzer for timestamp 1622971405659 ...
2021-06-06 12:23:30,473 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:30,474 - INFO - Finished triggering everything for timestamp 1622971405659 after 4.76 seconds! times: [('store_ct_event', 0.02), ('store_sub_events', 0.02), ('set_complete', 0.02), ('validate_timestamp', 0.02), ('store_classified', 0.06), ('store_trans', 0.13), ('modeler', 0.2), ('analyzer', 4.29)]
2021-06-06 12:23:30,637 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteKeyPair in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteKeyPair', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'keyName': 'test_key_key'}, 'responseElements': {'requestId': '253ddd51-ba5e-478d-9bde-41c29c80852a', '_return': True}, 'requestID': '253ddd51-ba5e-478d-9bde-41c29c80852a', 'eventID': '6630e300-03cb-4d7f-8d1e-4546ea53c215', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:30,805 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-01ebe8c99f478ce58'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-01ebe8c99f478ce58', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': 'c9744ee6-9bac-4cb5-84a1-b8b4be60eeb1', 'eventID': '4f006372-65c6-4db3-a635-7e7b993411cd', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:30,807 - INFO - delete instance - ['i-01ebe8c99f478ce58']
2021-06-06 12:23:30,843 - INFO - Get previous translated snapshot with timestamp 1622971405659 took 0.03 seconds
2021-06-06 12:23:30,875 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-01ebe8c99f478ce58', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.100.46', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'i-01ebe8c99f478ce58', 'tag': [{'Key': 'Name', 'Value': 'test-instance_vpce_s3', 'resource_id': 'i-01ebe8c99f478ce58..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0113b1da11f07e8c2', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-100-46.ec2.internal', 'GroupId': ['sg-0bf342c26b99f93f2'], 'InstanceId': 'i-01ebe8c99f478ce58', 'InterfaceType': 'interface', 'MacAddress': '12:ce:dc:40:59:27', 'NetworkInterfaceId': 'eni-0de590e5164d4e8b3', 'PrivateIpAddress': '10.20.100.46', 'SourceDestCheck': True, 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0de590e5164d4e8b3', 'PrivateIpAddress': '10.20.100.46', 'resource_id': 'eni-0de590e5164d4e8b3..10.20.100.46'}], 'resource_id': 'eni-0de590e5164d4e8b3', 'tag': [{'Key': 'Name', 'Value': 'test_interface_vpce_1', 'resource_id': 'eni-0de590e5164d4e8b3..Name'}]}]}}}, 'previous_timestamp': 1622971405659}
2021-06-06 12:23:30,962 - INFO - Calling modeler on-new-snapshot for timestamp 1622971410809 ...
2021-06-06 12:23:31,078 - INFO - Calling analyzer for timestamp 1622971410809 ...
2021-06-06 12:23:37,011 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:37,011 - INFO - Finished triggering everything for timestamp 1622971410809 after 6.14 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.03), ('store_classified', 0.03), ('modeler', 0.12), ('analyzer', 5.91)]
2021-06-06 12:23:37,734 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-0a695efad9fed3af9'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-0a695efad9fed3af9', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': 'ff7e6330-b9bc-4868-9c04-edb1e9c4a6a4', 'eventID': '04931f10-6d23-488e-8ade-928887c36a8d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:37,736 - INFO - delete instance - ['i-0a695efad9fed3af9']
2021-06-06 12:23:37,774 - INFO - Get previous translated snapshot with timestamp 1622971410809 took 0.04 seconds
2021-06-06 12:23:37,790 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-0a695efad9fed3af9', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.110.131', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'i-0a695efad9fed3af9', 'tag': [{'Key': 'Name', 'Value': 'test-instance_kinesis', 'resource_id': 'i-0a695efad9fed3af9..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0d47ae5057311e36e', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-110-131.ec2.internal', 'GroupId': ['sg-0bf342c26b99f93f2'], 'InstanceId': 'i-0a695efad9fed3af9', 'InterfaceType': 'interface', 'MacAddress': '0a:02:76:2e:d6:f5', 'NetworkInterfaceId': 'eni-04abc10c3b5f8f558', 'PrivateIpAddress': '10.20.110.131', 'SourceDestCheck': True, 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-04abc10c3b5f8f558', 'PrivateIpAddress': '10.20.110.131', 'resource_id': 'eni-04abc10c3b5f8f558..10.20.110.131'}], 'resource_id': 'eni-04abc10c3b5f8f558', 'tag': [{'Key': 'Name', 'Value': 'test_interface_kinesis', 'resource_id': 'eni-04abc10c3b5f8f558..Name'}]}]}}}, 'previous_timestamp': 1622971410809}
2021-06-06 12:23:37,858 - INFO - Calling modeler on-new-snapshot for timestamp 1622971417737 ...
2021-06-06 12:23:37,934 - INFO - Calling analyzer for timestamp 1622971417737 ...
2021-06-06 12:23:44,193 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:44,193 - INFO - Finished triggering everything for timestamp 1622971417737 after 6.41 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.08), ('analyzer', 6.24)]
2021-06-06 12:23:44,352 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-0d85e45ef5c46f62f'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-0d85e45ef5c46f62f', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': 'bdb90a10-ef04-495e-b7d9-f970c2586eb4', 'eventID': 'd28a6520-d888-4c9c-90a7-50304056f472', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:44,353 - INFO - delete instance - ['i-0d85e45ef5c46f62f']
2021-06-06 12:23:44,379 - INFO - Get previous translated snapshot with timestamp 1622971417737 took 0.03 seconds
2021-06-06 12:23:44,396 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-0d85e45ef5c46f62f', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.10.10.12', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'i-0d85e45ef5c46f62f', 'tag': [{'Key': 'Name', 'Value': 'test-instance_2', 'resource_id': 'i-0d85e45ef5c46f62f..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0bce65e932482e604', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'DeviceIndex': 0, 'DnsName': 'ip-10-10-10-12.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InstanceId': 'i-0d85e45ef5c46f62f', 'InterfaceType': 'interface', 'MacAddress': '16:04:5e:72:19:65', 'NetworkInterfaceId': 'eni-04dc995f4339a463c', 'PrivateIpAddress': '10.10.10.12', 'SourceDestCheck': True, 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-04dc995f4339a463c', 'PrivateIpAddress': '10.10.10.12', 'resource_id': 'eni-04dc995f4339a463c..10.10.10.12'}], 'resource_id': 'eni-04dc995f4339a463c', 'tag': [{'Key': 'Name', 'Value': 'test_interface_2', 'resource_id': 'eni-04dc995f4339a463c..Name'}]}]}}}, 'previous_timestamp': 1622971417737}
2021-06-06 12:23:44,463 - INFO - Calling modeler on-new-snapshot for timestamp 1622971424353 ...
2021-06-06 12:23:44,554 - INFO - Calling analyzer for timestamp 1622971424353 ...
2021-06-06 12:23:51,320 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:51,320 - INFO - Finished triggering everything for timestamp 1622971424353 after 6.92 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.09), ('analyzer', 6.75)]
2021-06-06 12:23:51,485 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteLoadBalancer in us-east-1 at 2021-06-06T09:23:05Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:05Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerName': 'test-elb-2796885'}, 'responseElements': None, 'requestID': 'ce5e3f46-d020-417c-93e7-fea2c0f6b85c', 'eventID': 'b2f89a2e-1ef2-4d4d-bfbe-d77a77a2b9e4', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2012-06-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:51,486 - INFO - delete elb - []
2021-06-06 12:23:51,508 - INFO - Get previous translated snapshot with timestamp 1622971424353 took 0.02 seconds
2021-06-06 12:23:51,513 - INFO - delete elb: test-elb-2796885-666512964.us-east-1.elb.amazonaws.com (deleted by key: LoadBalancerName, value: test-elb-2796885)
2021-06-06 12:23:51,514 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'elb': [{'DNSName': 'test-elb-2796885-666512964.us-east-1.elb.amazonaws.com', 'LoadBalancerName': 'test-elb-2796885', 'VpcId': 'vpc-05c66fc27c8de6f73', 'listener_elb': [{'InstancePort': 8000, 'InstanceProtocol': 'HTTP', 'LoadBalancerPort': 80, 'Protocol': 'HTTP', 'resource_id': 'test-elb-2796885-666512964.us-east-1.elb.amazonaws.com..80'}], 'resource_id': 'test-elb-2796885-666512964.us-east-1.elb.amazonaws.com', 'security_groups': ['sg-0aa68cd0fc33a9815'], 'subnet_id': ['subnet-0627eacfcbd2561b0'], 'target_instance': [{'InstanceId': 'i-036266a196e3f9d88', 'resource_id': 'test-elb-2796885-666512964.us-east-1.elb.amazonaws.com..i-036266a196e3f9d88'}]}]}}}, 'previous_timestamp': 1622971424353}
2021-06-06 12:23:51,584 - INFO - Calling modeler on-new-snapshot for timestamp 1622971431486 ...
2021-06-06 12:23:51,619 - INFO - Calling analyzer for timestamp 1622971431486 ...
2021-06-06 12:23:54,864 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:54,865 - INFO - Finished triggering everything for timestamp 1622971431486 after 3.34 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.22)]
2021-06-06 12:23:55,030 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeregisterTargets in us-east-1 at 2021-06-06T09:23:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:02Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeregisterTargets', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba', 'targets': [{'id': 'i-0d9f92ed9e44352fb', 'port': 6081}]}, 'responseElements': None, 'requestID': 'c59d5f1f-6e3c-4443-904b-6c4f4a5172e2', 'eventID': '6b4b0c41-9257-4d4a-b5a0-54b4499acf19', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:55,030 - INFO - remove target - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba..i-0d9f92ed9e44352fb..6081']
2021-06-06 12:23:55,051 - INFO - Get previous translated snapshot with timestamp 1622971431486 took 0.02 seconds
2021-06-06 12:23:55,056 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'target_group': [{'Port': 6081, 'Protocol': 'GENEVE', 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba', 'TargetGroupName': 'test-tg-glb', 'TargetType': 'instance', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba', 'target': []}]}, 'deleted': {}}}, 'previous_timestamp': 1622971431486}
2021-06-06 12:23:55,119 - INFO - Calling modeler on-new-snapshot for timestamp 1622971435030 ...
2021-06-06 12:23:55,185 - INFO - Calling analyzer for timestamp 1622971435030 ...
2021-06-06 12:23:58,437 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:23:58,437 - INFO - Finished triggering everything for timestamp 1622971435030 after 3.38 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.07), ('analyzer', 3.22)]
2021-06-06 12:23:59,576 - INFO - User N/A (aws-internal/3 aws-sdk-java/1.11.955 Linux/4.14.231-173.361.amzn2.x86_64 OpenJDK_64-Bit_Server_VM/25.282-b08 java/1.8.0_282 vendor/Oracle_Corporation) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:05Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PS5JUXCA4N:749678902839', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_lambda/749678902839', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PUZ77CT7M', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PS5JUXCA4N', 'arn': 'arn:aws:iam::139614369439:role/test_role_lambda', 'accountId': '139614369439', 'userName': 'test_role_lambda'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:05Z', 'mfaAuthenticated': 'false'}}}, 'eventTime': '2021-06-06T09:23:05Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '34.226.122.130', 'userAgent': 'aws-internal/3 aws-sdk-java/1.11.955 Linux/4.14.231-173.361.amzn2.x86_64 OpenJDK_64-Bit_Server_VM/25.282-b08 java/1.8.0_282 vendor/Oracle_Corporation', 'requestParameters': {'networkInterfaceId': 'eni-0bd850637b45ea963'}, 'responseElements': {'requestId': 'c2616f9c-0d3c-48d5-9927-701aab17515b', '_return': True}, 'requestID': 'c2616f9c-0d3c-48d5-9927-701aab17515b', 'eventID': '16c05cc8-bd1c-4c77-8c50-ae14f4483062', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:23:59,576 - INFO - delete network_interface - ['eni-0bd850637b45ea963']
2021-06-06 12:23:59,600 - INFO - Get previous translated snapshot with timestamp 1622971435030 took 0.02 seconds
2021-06-06 12:23:59,605 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-016da236dd8cb37fb', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'Description': 'AWS Lambda VPC ENI-test_lambda_function-86dcc739-5d6a-482c-b05a-c5b2cf0d1753', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-10-176.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InterfaceType': 'lambda', 'MacAddress': '16:ef:4d:18:48:b5', 'NetworkInterfaceId': 'eni-0bd850637b45ea963', 'PrivateIpAddress': '10.10.10.176', 'SourceDestCheck': True, 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0bd850637b45ea963', 'PrivateIpAddress': '10.10.10.176', 'resource_id': 'eni-0bd850637b45ea963..10.10.10.176'}], 'resource_id': 'eni-0bd850637b45ea963'}]}}}, 'previous_timestamp': 1622971435030}
2021-06-06 12:23:59,663 - INFO - Calling modeler on-new-snapshot for timestamp 1622971439578 ...
2021-06-06 12:23:59,718 - INFO - Calling analyzer for timestamp 1622971439578 ...
2021-06-06 12:24:05,000 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:05,000 - INFO - Finished triggering everything for timestamp 1622971439578 after 5.40 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.05), ('analyzer', 5.26)]
2021-06-06 12:24:05,160 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:32.488Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '9ee159b9-faef-466f-897f-5a6b344cd164'}
2021-06-06 12:24:05,814 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:45.185Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '6f389c43-311d-47ae-868c-c00b46808804'}
2021-06-06 12:24:05,977 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:45Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:44Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:45Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0e2e0ddd65fc08bb7'}, 'responseElements': {'requestId': 'c8cc3c5b-3b45-4538-96a3-d0daf0e24024', '_return': True}, 'requestID': 'c8cc3c5b-3b45-4538-96a3-d0daf0e24024', 'eventID': 'd28256f3-1d57-43be-aaf3-879ca7758087', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:05,978 - INFO - delete network_interface - ['eni-0e2e0ddd65fc08bb7']
2021-06-06 12:24:06,002 - INFO - Get previous translated snapshot with timestamp 1622971439578 took 0.02 seconds
2021-06-06 12:24:06,007 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-0c84353c9d04fcd38', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'Description': 'ELB net/test-nlb/52d92dae5a980e86', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-50-177.ec2.internal', 'GroupId': [], 'InterfaceType': 'network_load_balancer', 'MacAddress': '16:1a:82:20:c6:0d', 'NetworkInterfaceId': 'eni-0e2e0ddd65fc08bb7', 'PrivateIpAddress': '10.10.50.177', 'PublicDnsName': 'ec2-3-226-20-49.compute-1.amazonaws.com', 'PublicIpAddress': '3.226.20.49', 'SourceDestCheck': False, 'SubnetId': 'subnet-098c87b4a9a29cc5f', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0e2e0ddd65fc08bb7', 'PrivateIpAddress': '10.10.50.177', 'resource_id': 'eni-0e2e0ddd65fc08bb7..10.10.50.177'}], 'resource_id': 'eni-0e2e0ddd65fc08bb7'}]}}}, 'previous_timestamp': 1622971439578}
2021-06-06 12:24:06,060 - INFO - Calling modeler on-new-snapshot for timestamp 1622971445979 ...
2021-06-06 12:24:06,091 - INFO - Calling analyzer for timestamp 1622971445979 ...
2021-06-06 12:24:11,411 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:11,411 - INFO - Finished triggering everything for timestamp 1622971445979 after 5.41 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 5.3)]
2021-06-06 12:24:11,572 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteListener in us-east-1 at 2021-06-06T09:23:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:48Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteListener', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'listenerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/53d838234c69cdf6/8d922a94a2f5c740'}, 'responseElements': None, 'requestID': '41279ca3-2f37-4368-91c1-966c5f59c4e8', 'eventID': 'bed6088e-da72-4ecc-a5c5-4a69dd20a425', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:11,573 - INFO - remove listener_glb - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6..arn:aws:elasticloadbalancing:us-east-1:139614369439:listener/gwy/test-glb/53d838234c69cdf6/8d922a94a2f5c740']
2021-06-06 12:24:11,594 - INFO - Get previous translated snapshot with timestamp 1622971445979 took 0.02 seconds
2021-06-06 12:24:11,599 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'glb': [{'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6', 'LoadBalancerName': 'test-glb', 'StateCode': 'provisioning', 'Type': 'gateway', 'VpcId': 'vpc-05c66fc27c8de6f73', 'availability_zone': [{'SubnetId': 'subnet-080bf67267388f92d', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6..subnet-080bf67267388f92d'}, {'SubnetId': 'subnet-0754334dae5682f73', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6..subnet-0754334dae5682f73'}], 'listener_glb': [], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6'}]}, 'deleted': {}}}, 'previous_timestamp': 1622971445979}
2021-06-06 12:24:11,658 - INFO - Calling modeler on-new-snapshot for timestamp 1622971451573 ...
2021-06-06 12:24:11,712 - INFO - Calling analyzer for timestamp 1622971451573 ...
2021-06-06 12:24:14,832 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:14,832 - INFO - Finished triggering everything for timestamp 1622971451573 after 3.23 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.05), ('analyzer', 3.1)]
2021-06-06 12:24:14,993 - INFO - User N/A ([APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]) performed DeleteBucket in us-east-1 at 2021-06-06T09:23:47Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:47Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'DeleteBucket', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': '[APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]', 'requestParameters': {'bucketName': 'll-test-bucket-public-2796885', 'Host': 'll-test-bucket-public-2796885.s3.amazonaws.com'}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 0, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'BVbNCRinIrVtizfokzqLSu8bunHYEpsJ6FPY4+Of+1U0fcGO2A2hOrXXanpnVZT6gtXqt3bvtas=', 'bytesTransferredOut': 0}, 'requestID': 'JSFYAQGGNP7EWEHQ', 'eventID': '064936b3-5758-4d8d-903e-c1545c8eaad9', 'readOnly': False, 'resources': [{'accountId': '139614369439', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::ll-test-bucket-public-2796885'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:14,994 - INFO - delete s3_bucket - ['arn:aws:s3:::ll-test-bucket-public-2796885']
2021-06-06 12:24:15,017 - INFO - Get previous translated snapshot with timestamp 1622971451573 took 0.02 seconds
2021-06-06 12:24:15,022 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'s3_bucket': [{'BucketArn': 'arn:aws:s3:::ll-test-bucket-public-2796885', 'IsPublic': True, 'Location': 'us-east-1', 'Name': 'll-test-bucket-public-2796885', 'acl': [{'GranteeDisplayName': 'automation', 'GranteeType': 'CanonicalUser', 'Permission': 'FULL_CONTROL', 'resource_id': 'arn:aws:s3:::ll-test-bucket-public-2796885..CanonicalUser..FULL_CONTROL'}, {'GranteeType': 'Group', 'GranteeURI': 'http://acs.amazonaws.com/groups/global/AllUsers', 'Permission': 'READ', 'resource_id': 'arn:aws:s3:::ll-test-bucket-public-2796885..Group..READ'}], 'resource_id': 'arn:aws:s3:::ll-test-bucket-public-2796885'}]}}}, 'previous_timestamp': 1622971451573}
2021-06-06 12:24:15,077 - INFO - Calling modeler on-new-snapshot for timestamp 1622971454994 ...
2021-06-06 12:24:15,134 - INFO - Calling analyzer for timestamp 1622971454994 ...
2021-06-06 12:24:19,772 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:19,772 - INFO - Finished triggering everything for timestamp 1622971454994 after 4.76 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.06), ('analyzer', 4.62)]
2021-06-06 12:24:19,951 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:52Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:52Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-0c2da8cb9553c4563'}, 'responseElements': {'requestId': '8cf4cdb6-19ee-400b-a554-b690a69260f5', '_return': True}, 'requestID': '8cf4cdb6-19ee-400b-a554-b690a69260f5', 'eventID': 'd31c000f-7133-4612-9c52-46d259eec832', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:19,952 - INFO - delete network_interface - ['eni-0c2da8cb9553c4563']
2021-06-06 12:24:19,976 - INFO - Get previous translated snapshot with timestamp 1622971454994 took 0.02 seconds
2021-06-06 12:24:19,980 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AvailabilityZone': 'us-east-1f', 'DnsName': 'ip-10-10-10-82.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InterfaceType': 'interface', 'MacAddress': '16:4e:72:2d:01:91', 'NetworkInterfaceId': 'eni-0c2da8cb9553c4563', 'PrivateIpAddress': '10.10.10.82', 'SourceDestCheck': True, 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0c2da8cb9553c4563', 'PrivateIpAddress': '10.10.10.82', 'resource_id': 'eni-0c2da8cb9553c4563..10.10.10.82'}], 'resource_id': 'eni-0c2da8cb9553c4563', 'tag': [{'Key': 'Name', 'Value': 'test_interface_nat_ec2', 'resource_id': 'eni-0c2da8cb9553c4563..Name'}]}]}}}, 'previous_timestamp': 1622971454994}
2021-06-06 12:24:20,038 - INFO - Calling modeler on-new-snapshot for timestamp 1622971459952 ...
2021-06-06 12:24:20,067 - INFO - Calling analyzer for timestamp 1622971459952 ...
2021-06-06 12:24:23,087 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:23,087 - INFO - Finished triggering everything for timestamp 1622971459952 after 3.12 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.0)]
2021-06-06 12:24:23,880 - INFO - Ignoring failed event - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachNetworkInterface in us-east-1 at 2021-06-06T09:23:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:08Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'errorCode': 'Client.AuthFailure', 'errorMessage': 'You do not have permission to access the specified resource.', 'requestParameters': {'attachmentId': 'eni-attach-021ee4cbd72c35800', 'force': True}, 'responseElements': None, 'requestID': '64276035-a89a-4c0a-8f86-03fe978b9d20', 'eventID': '2bb61d75-66a4-4d05-bbc6-d8cd20c8b04f', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.AuthFailure, message: You do not have permission to access the specified resource.)
2021-06-06 12:24:24,062 - INFO - Ignoring failed event - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:14Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:14Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:14Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'errorCode': 'Client.InvalidParameterValue', 'errorMessage': "Network interface 'eni-096f8f06c65612728' is currently in use.", 'requestParameters': {'networkInterfaceId': 'eni-096f8f06c65612728'}, 'responseElements': None, 'requestID': '7d4c3528-ecd5-47e9-8dea-c5792378a289', 'eventID': '5460018d-da38-48b6-802c-5ebdc81eac4b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.InvalidParameterValue, message: Network interface 'eni-096f8f06c65612728' is currently in use.)
2021-06-06 12:24:24,224 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachRolePolicy in us-east-1 at 2021-06-06T09:23:38Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:38Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DetachRolePolicy', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role_ecs', 'policyArn': 'arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role'}, 'responseElements': None, 'requestID': '48bcb50b-7e04-4a56-81d9-9530659b6854', 'eventID': 'f4888d64-2eda-4eea-9713-aab9f7b6d365', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:24,227 - INFO - hard-modify iam_role - 
2021-06-06 12:24:24,228 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_ecs']}]}}}
2021-06-06 12:24:26,557 - INFO - scanned resources: {'iam_role': [{'RoleName': 'test_role_ecs', 'RoleId': 'AROASBANKG2PWKCFXY3QR', 'Arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'Path': '/', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_ecs'}]}
2021-06-06 12:24:26,592 - INFO - Get previous translated snapshot with timestamp 1622971459952 took 0.03 seconds
2021-06-06 12:24:26,596 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {'iam_role': [{'RoleName': 'test_role_ecs', 'RoleId': 'AROASBANKG2PWKCFXY3QR', 'Arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'Path': '/', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_ecs'}]}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971459952}
2021-06-06 12:24:26,657 - INFO - Calling modeler on-new-snapshot for timestamp 1622971466558 ...
2021-06-06 12:24:26,897 - INFO - Calling analyzer for timestamp 1622971466558 ...
2021-06-06 12:24:30,043 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:30,043 - INFO - Finished triggering everything for timestamp 1622971466558 after 3.45 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.24), ('analyzer', 3.12)]
2021-06-06 12:24:30,206 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:41.983Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'launch-template', 'version': 2.0, 'tags': {}}
2021-06-06 12:24:30,368 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteLaunchTemplate in us-east-1 at 2021-06-06T09:23:37Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:37Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteLaunchTemplate', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'DeleteLaunchTemplateRequest': {'LaunchTemplateId': 'lt-0490583fb47a3e768'}}, 'responseElements': {'DeleteLaunchTemplateResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': '73f46c28-5483-4ab6-b0db-9ad03af244c0', 'launchTemplate': {'createTime': '2021-06-06T09:07:03.000Z', 'createdBy': 'arn:aws:iam::139614369439:root', 'launchTemplateId': 'lt-0490583fb47a3e768', 'latestVersionNumber': 1, 'defaultVersionNumber': 1, 'launchTemplateName': 'test_launch_template'}}}, 'requestID': '73f46c28-5483-4ab6-b0db-9ad03af244c0', 'eventID': '8c78a391-25a0-490a-b369-8b85598e64a1', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:30,368 - INFO - delete launch_template - ['lt-0490583fb47a3e768']
2021-06-06 12:24:30,394 - INFO - Get previous translated snapshot with timestamp 1622971466558 took 0.03 seconds
2021-06-06 12:24:30,399 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'launch_template': [{'LaunchTemplateId': 'lt-0490583fb47a3e768', 'LaunchTemplateName': 'test_launch_template', 'resource_id': 'lt-0490583fb47a3e768', 'template_version': [{'DefaultVersion': 1, 'ImageId': 'ami-00ddb0e5626798373', 'InstanceType': 't2.micro', 'LaunchTemplateId': 'lt-0490583fb47a3e768', 'VersionNumber': 1, 'resource_id': 'lt-0490583fb47a3e768..1'}]}]}}}, 'previous_timestamp': 1622971466558}
2021-06-06 12:24:30,462 - INFO - Calling modeler on-new-snapshot for timestamp 1622971470368 ...
2021-06-06 12:24:30,502 - INFO - Calling analyzer for timestamp 1622971470368 ...
2021-06-06 12:24:33,609 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:33,609 - INFO - Finished triggering everything for timestamp 1622971470368 after 3.21 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 3.09)]
2021-06-06 12:24:33,781 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DisassociateAddress in us-east-1 at 2021-06-06T09:23:49Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:49Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DisassociateAddress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'eipassoc-08b0fc867f441d1b3'}, 'responseElements': {'requestId': 'cd0c53d7-cdac-4c47-9f87-5977989a4f52', '_return': True}, 'requestID': 'cd0c53d7-cdac-4c47-9f87-5977989a4f52', 'eventID': '7005bedc-ed5c-40f4-b2bc-da693cf16f8f', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:33,942 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:02.583Z, account_id: N/A, extra:{'attachments': [{'id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-06f56ed6ae2441c1a'}, {'name': 'macAddress', 'value': '12:05:3f:55:b9:67'}, {'name': 'privateDnsName', 'value': 'ip-172-31-10-216.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.10.216'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:07:31.704Z', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5/26f42af7-c017-41dd-ba39-990bb7251ee0', 'exitCode': 137, 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': 'd1e1021ba7f94e1ebc65385be8ed26c5-1576263027', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'networkInterfaces': [{'attachmentId': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'privateIpv4Address': '172.31.10.216'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:07:22.969Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'ephemeralStorage': {'sizeInGiB': 20}, 'executionStoppedAt': '2021-06-06T09:23:52.293Z', 'group': 'service:test_ecs_service_fargate', 'launchType': 'FARGATE', 'lastStatus': 'DEPROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'platformVersion': '1.4.0', 'pullStartedAt': '2021-06-06T09:07:54.432Z', 'pullStoppedAt': '2021-06-06T09:07:58.959Z', 'startedAt': '2021-06-06T09:08:01.314Z', 'startedBy': 'ecs-svc/8114543020074586516', 'stoppingAt': '2021-06-06T09:23:21.009Z', 'stoppedReason': 'Scaling activity initiated by (deployment ecs-svc/8114543020074586516)', 'stopCode': 'ServiceSchedulerInitiated', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'updatedAt': '2021-06-06T09:24:02.338Z', 'version': 5}
2021-06-06 12:24:34,645 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteInternetGateway in us-east-1 at 2021-06-06T09:24:01Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:01Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-0f610ccbce4fbec4f'}, 'responseElements': {'requestId': '761a7881-71e5-4276-a23e-c6d80ffaa79c', '_return': True}, 'requestID': '761a7881-71e5-4276-a23e-c6d80ffaa79c', 'eventID': 'cb57d8c2-f9cd-4f75-995a-ec32b8798dbd', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:34,646 - INFO - delete internet_gateway - ['igw-0f610ccbce4fbec4f']
2021-06-06 12:24:34,670 - INFO - Get previous translated snapshot with timestamp 1622971470368 took 0.02 seconds
2021-06-06 12:24:34,675 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'internet_gateway': [{'InternetGatewayId': 'igw-0f610ccbce4fbec4f', 'internet_gateway_attachment': [{'InternetGatewayId': 'igw-0f610ccbce4fbec4f', 'State': 'available', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'igw-0f610ccbce4fbec4f..vpc-00ee3246072e19077'}], 'resource_id': 'igw-0f610ccbce4fbec4f', 'tag': [{'Key': 'Name', 'Value': 'test_gw_2', 'resource_id': 'igw-0f610ccbce4fbec4f..Name'}]}]}}}, 'previous_timestamp': 1622971470368}
2021-06-06 12:24:34,738 - INFO - Calling modeler on-new-snapshot for timestamp 1622971474647 ...
2021-06-06 12:24:34,756 - INFO - Calling analyzer for timestamp 1622971474647 ...
2021-06-06 12:24:37,716 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:37,716 - INFO - Finished triggering everything for timestamp 1622971474647 after 3.05 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.94)]
2021-06-06 12:24:37,956 - INFO - User N/A ([APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]) performed DeleteBucket in us-east-1 at 2021-06-06T09:24:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:00Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'DeleteBucket', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': '[APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]', 'requestParameters': {'bucketName': 'll-test-bucket-2796885', 'Host': 'll-test-bucket-2796885.s3.amazonaws.com'}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 0, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'i7AWlWKsTVXlUnR1AbGrYTaVAuJ21DYXLAgvTP92WUOyYhW/ItGXpScZE05yTlyGCdRRPivaLqM=', 'bytesTransferredOut': 0}, 'requestID': 'V8SQK4GW7NJCS089', 'eventID': 'a8fd763f-e8a9-4797-8834-357a453cb8fe', 'readOnly': False, 'resources': [{'accountId': '139614369439', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::ll-test-bucket-2796885'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:37,957 - INFO - delete s3_bucket - ['arn:aws:s3:::ll-test-bucket-2796885']
2021-06-06 12:24:37,978 - INFO - Get previous translated snapshot with timestamp 1622971474647 took 0.02 seconds
2021-06-06 12:24:37,982 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'s3_bucket': [{'BucketArn': 'arn:aws:s3:::ll-test-bucket-2796885', 'IsPublic': False, 'Location': 'us-east-1', 'Name': 'll-test-bucket-2796885', 'acl': [{'GranteeDisplayName': 'automation', 'GranteeType': 'CanonicalUser', 'Permission': 'FULL_CONTROL', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885..CanonicalUser..FULL_CONTROL'}], 'inline_policy_bucket': [{'Arn': 'arn:aws:s3:::ll-test-bucket-2796885', 'IsBucketPolicy': True, 'PolicyName': 'll-test-bucket-2796885', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885', 'statement': [{'Action': 's3:PutObject', 'Effect': 'Allow', 'Principal': {'AWS': 'arn:aws:iam::127311923021:root'}, 'Resource': 'arn:aws:s3:::ll-test-bucket-2796885/AWSLogs/*', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'}]}], 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796885'}]}}}, 'previous_timestamp': 1622971474647}
2021-06-06 12:24:38,044 - INFO - Calling modeler on-new-snapshot for timestamp 1622971477957 ...
2021-06-06 12:24:38,083 - INFO - Calling analyzer for timestamp 1622971477957 ...
2021-06-06 12:24:43,920 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:43,921 - INFO - Finished triggering everything for timestamp 1622971477957 after 5.95 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 5.82)]
2021-06-06 12:24:44,088 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:06.815Z, account_id: N/A, extra:{'instance-id': 'i-07600a9b4869cc2a2', 'state': 'shutting-down'}
2021-06-06 12:24:44,560 - INFO - Ignoring failed event - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:08Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:08Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'errorCode': 'Client.InvalidParameterValue', 'errorMessage': "Network interface 'eni-09ebea27747e819f1' is currently in use.", 'requestParameters': {'networkInterfaceId': 'eni-09ebea27747e819f1'}, 'responseElements': None, 'requestID': 'fcd0936f-42fd-4192-bdfe-740d6772a724', 'eventID': '5bd61cbc-4f05-4696-ae83-b1168367dbe2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.InvalidParameterValue, message: Network interface 'eni-09ebea27747e819f1' is currently in use.)
2021-06-06 12:24:44,718 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed UpdateService in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'UpdateService', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'cluster': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'desiredCount': 0, 'forceNewDeployment': False, 'service': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}, 'responseElements': {'service': {'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'loadBalancers': [], 'serviceRegistries': [], 'status': 'ACTIVE', 'desiredCount': 0, 'runningCount': 1, 'pendingCount': 0, 'launchType': 'FARGATE', 'platformVersion': 'LATEST', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'deploymentConfiguration': {'deploymentCircuitBreaker': {'enable': False, 'rollback': False}, 'maximumPercent': 200, 'minimumHealthyPercent': 100}, 'deployments': [{'id': 'ecs-svc/8114543020074586516', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'desiredCount': 0, 'pendingCount': 0, 'runningCount': 1, 'failedTasks': 0, 'createdAt': 'Jun 6, 2021 9:07:19 AM', 'updatedAt': 'Jun 6, 2021 9:08:04 AM', 'launchType': 'FARGATE', 'platformVersion': '1.4.0', 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'ENABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'rolloutState': 'COMPLETED', 'rolloutStateReason': 'ECS deployment ecs-svc/8114543020074586516 completed.'}], 'roleArn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'version': 0, 'events': [{'id': '456bb58a-ffec-4e3e-b285-83da23dc0801', 'createdAt': 'Jun 6, 2021 9:08:04 AM', 'message': '(service test_ecs_service_fargate) has reached a steady state.'}, {'id': 'd6778f34-6591-4d62-a88b-56e5ccb4deb1', 'createdAt': 'Jun 6, 2021 9:08:04 AM', 'message': '(service test_ecs_service_fargate) (deployment ecs-svc/8114543020074586516) deployment completed.'}, {'id': 'd9124d3a-d51e-48ca-9325-f6c139735739', 'createdAt': 'Jun 6, 2021 9:07:23 AM', 'message': '(service test_ecs_service_fargate) has started 1 tasks: (task d1e1021ba7f94e1ebc65385be8ed26c5).'}], 'createdAt': 'Jun 6, 2021 9:07:19 AM', 'placementConstraints': [], 'placementStrategy': [], 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'ENABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'schedulingStrategy': 'REPLICA', 'createdBy': 'arn:aws:iam::139614369439:root', 'enableECSManagedTags': False, 'propagateTags': 'NONE', 'enableExecuteCommand': False}}, 'requestID': '2f0494da-c81a-4e78-b8c1-0681bdb0b4a6', 'eventID': 'c10eebdd-8008-4f47-bb47-7d29fac44bc3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:44,720 - INFO - modify service - [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'launchType': 'FARGATE', 'deployment': [{'launchType': 'FARGATE', 'id': 'ecs-svc/8114543020074586516', 'rolloutState': 'COMPLETED', 'failedTasks': 0, 'status': 'PRIMARY', 'desiredCount': 0, 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'pendingCount': 0, 'runningCount': 1, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/8114543020074586516'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}]
2021-06-06 12:24:44,745 - INFO - Get previous translated snapshot with timestamp 1622971477957 took 0.03 seconds
2021-06-06 12:24:44,750 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'ecs': [{'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'ec2InstanceId': 'i-0bc9c6152477ce465', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'ec2InstanceId': 'i-09e2d3e3d9fdb48cf', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 2, 'failedTasks': 0, 'id': 'ecs-svc/3384641070202511327', 'launchType': 'EC2', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/3384641070202511327', 'rolloutState': 'COMPLETED', 'runningCount': 2, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}], 'launchType': 'EC2', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'runningTasksCount': 2, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}]}, {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'launchType': 'FARGATE', 'id': 'ecs-svc/8114543020074586516', 'rolloutState': 'COMPLETED', 'failedTasks': 0, 'status': 'PRIMARY', 'desiredCount': 0, 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'pendingCount': 0, 'runningCount': 1, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..ecs-svc/8114543020074586516'}], 'launchType': 'FARGATE', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'runningTasksCount': 1, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service_fargate', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate..Name'}]}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-026ba384964109468', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..networkInterfaceId..eni-026ba384964109468'}, {'detailName': 'macAddress', 'detailValue': '12:5a:b8:61:34:4f', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..macAddress..12:5a:b8:61:34:4f'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-5-40.ec2.internal', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..privateDnsName..ip-172-31-5-40.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.5.40', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..privateIPv4Address..172.31.5.40'}], 'id': '37b6cac5-fc31-463f-89cc-3184f05413d5', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21..37b6cac5-fc31-463f-89cc-3184f05413d5', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-0ba19af047fb45c0c', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..networkInterfaceId..eni-0ba19af047fb45c0c'}, {'detailName': 'macAddress', 'detailValue': '12:80:55:19:0c:3f', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..macAddress..12:80:55:19:0c:3f'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-79.ec2.internal', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..privateDnsName..ip-172-31-9-79.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.79', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..privateIPv4Address..172.31.9.79'}], 'id': '05272592-c932-43c2-ba7f-60effa478cc1', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c..05272592-c932-43c2-ba7f-60effa478cc1', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-06f56ed6ae2441c1a', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..networkInterfaceId..eni-06f56ed6ae2441c1a'}, {'detailName': 'macAddress', 'detailValue': '12:05:3f:55:b9:67', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..macAddress..12:05:3f:55:b9:67'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-216.ec2.internal', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..privateDnsName..ip-172-31-10-216.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.216', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..privateIPv4Address..172.31.10.216'}], 'id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5..32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'cpu': '256', 'launchType': 'FARGATE', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622971477957}
2021-06-06 12:24:44,871 - INFO - Calling modeler on-new-snapshot for timestamp 1622971484720 ...
2021-06-06 12:24:44,973 - INFO - Calling analyzer for timestamp 1622971484720 ...
2021-06-06 12:24:48,298 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:48,299 - INFO - Finished triggering everything for timestamp 1622971484720 after 3.54 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_classified', 0.06), ('modeler', 0.1), ('analyzer', 3.3)]
2021-06-06 12:24:49,222 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteFunction20150331 in us-east-1 at 2021-06-06T09:23:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:04Z', 'eventSource': 'lambda.amazonaws.com', 'eventName': 'DeleteFunction20150331', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'functionName': 'test_lambda_function'}, 'responseElements': None, 'requestID': '8e654ab6-a341-430e-b470-7ab9c57859a3', 'eventID': '24bc88d7-707c-43a6-85ff-1d14f9229c80', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:49,224 - INFO - delete lambda_function - ['arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function']
2021-06-06 12:24:49,249 - INFO - Get previous translated snapshot with timestamp 1622971484720 took 0.02 seconds
2021-06-06 12:24:49,255 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'lambda_function': [{'Description': '', 'FunctionArn': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function', 'FunctionName': 'test_lambda_function', 'Role': 'arn:aws:iam::139614369439:role/test_role_lambda', 'Runtime': 'nodejs12.x', 'SecurityGroupIds': ['sg-0aa68cd0fc33a9815'], 'SubnetIds': ['subnet-0627eacfcbd2561b0'], 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'arn:aws:lambda:us-east-1:139614369439:function:test_lambda_function'}]}}}, 'previous_timestamp': 1622971484720}
2021-06-06 12:24:49,316 - INFO - Calling modeler on-new-snapshot for timestamp 1622971489225 ...
2021-06-06 12:24:49,386 - INFO - Calling analyzer for timestamp 1622971489225 ...
2021-06-06 12:24:53,912 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:53,912 - INFO - Finished triggering everything for timestamp 1622971489225 after 4.65 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.07), ('analyzer', 4.5)]
2021-06-06 12:24:54,068 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:18.460Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'elasticloadbalancing', 'resource-type': 'loadbalancer', 'version': 1.0, 'tags': {}}
2021-06-06 12:24:54,228 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteService in us-east-1 at 2021-06-06T09:23:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:04Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DeleteService', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'cluster': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'service': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate'}, 'responseElements': {'service': {'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate', 'serviceName': 'test_ecs_service_fargate', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'loadBalancers': [], 'serviceRegistries': [], 'status': 'DRAINING', 'desiredCount': 0, 'runningCount': 1, 'pendingCount': 0, 'launchType': 'FARGATE', 'platformVersion': 'LATEST', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'deploymentConfiguration': {'deploymentCircuitBreaker': {'enable': False, 'rollback': False}, 'maximumPercent': 200, 'minimumHealthyPercent': 100}, 'deployments': [{'id': 'ecs-svc/8114543020074586516', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'desiredCount': 0, 'pendingCount': 0, 'runningCount': 1, 'failedTasks': 0, 'createdAt': 'Jun 6, 2021 9:07:19 AM', 'updatedAt': 'Jun 6, 2021 9:23:03 AM', 'launchType': 'FARGATE', 'platformVersion': '1.4.0', 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'ENABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'rolloutState': 'COMPLETED', 'rolloutStateReason': 'ECS deployment ecs-svc/8114543020074586516 completed.'}], 'roleArn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'version': 0, 'events': [{'id': '456bb58a-ffec-4e3e-b285-83da23dc0801', 'createdAt': 'Jun 6, 2021 9:08:04 AM', 'message': '(service test_ecs_service_fargate) has reached a steady state.'}, {'id': 'd6778f34-6591-4d62-a88b-56e5ccb4deb1', 'createdAt': 'Jun 6, 2021 9:08:04 AM', 'message': '(service test_ecs_service_fargate) (deployment ecs-svc/8114543020074586516) deployment completed.'}, {'id': 'd9124d3a-d51e-48ca-9325-f6c139735739', 'createdAt': 'Jun 6, 2021 9:07:23 AM', 'message': '(service test_ecs_service_fargate) has started 1 tasks: (task d1e1021ba7f94e1ebc65385be8ed26c5).'}], 'createdAt': 'Jun 6, 2021 9:07:19 AM', 'placementConstraints': [], 'placementStrategy': [], 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'ENABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'schedulingStrategy': 'REPLICA', 'createdBy': 'arn:aws:iam::139614369439:root', 'enableECSManagedTags': False, 'propagateTags': 'NONE', 'enableExecuteCommand': False}}, 'requestID': 'e77a15dd-1b0c-42b0-8131-625a9baa8654', 'eventID': 'f6defe8e-0ce0-476d-8d03-f363d1549f58', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:54,229 - INFO - remove service - ['arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service_fargate']
2021-06-06 12:24:54,253 - INFO - Get previous translated snapshot with timestamp 1622971489225 took 0.02 seconds
2021-06-06 12:24:54,259 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'ecs': [{'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'ec2InstanceId': 'i-0bc9c6152477ce465', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'ec2InstanceId': 'i-09e2d3e3d9fdb48cf', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 2, 'failedTasks': 0, 'id': 'ecs-svc/3384641070202511327', 'launchType': 'EC2', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/3384641070202511327', 'rolloutState': 'COMPLETED', 'runningCount': 2, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}], 'launchType': 'EC2', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'runningTasksCount': 2, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}]}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-026ba384964109468', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..networkInterfaceId..eni-026ba384964109468'}, {'detailName': 'macAddress', 'detailValue': '12:5a:b8:61:34:4f', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..macAddress..12:5a:b8:61:34:4f'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-5-40.ec2.internal', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..privateDnsName..ip-172-31-5-40.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.5.40', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..privateIPv4Address..172.31.5.40'}], 'id': '37b6cac5-fc31-463f-89cc-3184f05413d5', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21..37b6cac5-fc31-463f-89cc-3184f05413d5', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-0ba19af047fb45c0c', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..networkInterfaceId..eni-0ba19af047fb45c0c'}, {'detailName': 'macAddress', 'detailValue': '12:80:55:19:0c:3f', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..macAddress..12:80:55:19:0c:3f'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-79.ec2.internal', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..privateDnsName..ip-172-31-9-79.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.79', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..privateIPv4Address..172.31.9.79'}], 'id': '05272592-c932-43c2-ba7f-60effa478cc1', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c..05272592-c932-43c2-ba7f-60effa478cc1', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-06f56ed6ae2441c1a', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..networkInterfaceId..eni-06f56ed6ae2441c1a'}, {'detailName': 'macAddress', 'detailValue': '12:05:3f:55:b9:67', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..macAddress..12:05:3f:55:b9:67'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-216.ec2.internal', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..privateDnsName..ip-172-31-10-216.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.216', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..privateIPv4Address..172.31.10.216'}], 'id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5..32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'cpu': '256', 'launchType': 'FARGATE', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622971489225}
2021-06-06 12:24:54,362 - INFO - Calling modeler on-new-snapshot for timestamp 1622971494229 ...
2021-06-06 12:24:54,464 - INFO - Calling analyzer for timestamp 1622971494229 ...
2021-06-06 12:24:57,876 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:24:57,877 - INFO - Finished triggering everything for timestamp 1622971494229 after 3.61 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.05), ('modeler', 0.1), ('analyzer', 3.39)]
2021-06-06 12:24:58,034 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:26.693Z, account_id: N/A, extra:{'EventCategories': ['availability'], 'SourceType': 'DB_INSTANCE', 'SourceArn': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008', 'Date': '2021-06-06T09:23:20.440Z', 'Message': 'DB instance shutdown', 'SourceIdentifier': 'terraform-20210606090936358700000008', 'EventID': 'RDS-EVENT-0004'}
2021-06-06 12:24:58,206 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpcEndpoints in us-east-1 at 2021-06-06T09:23:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpcEndpoints', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'DeleteVpcEndpointsRequest': {'VpcEndpointId': {'tag': 1, 'content': 'vpce-0ea2cb489c0a32713'}}}, 'responseElements': {'DeleteVpcEndpointsResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': 'd6c47af0-2b78-4998-8bf0-c4c6ef041b20', 'unsuccessful': ''}}, 'requestID': 'd6c47af0-2b78-4998-8bf0-c4c6ef041b20', 'eventID': 'cdf880f2-82af-4ef8-aa26-350627f797a8', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:24:58,208 - INFO - delete vpc_endpoint - ['vpce-0ea2cb489c0a32713']
2021-06-06 12:24:58,287 - INFO - Get previous translated snapshot with timestamp 1622971494229 took 0.08 seconds
2021-06-06 12:24:58,297 - INFO - delete network_interface: eni-00678c9e1e2e3e950 (deleted by key: Description, value: VPC Endpoint Interface vpce-0ea2cb489c0a32713)
2021-06-06 12:24:58,297 - INFO - delete network_interface: eni-0dd256e6cd9f067e8 (deleted by key: Description, value: VPC Endpoint Interface vpce-0ea2cb489c0a32713)
2021-06-06 12:24:58,298 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-0578b498e7241f53e', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'Description': 'VPC Endpoint Interface vpce-0ea2cb489c0a32713', 'DeviceIndex': 1, 'DnsName': 'ip-10-20-110-225.ec2.internal', 'GroupId': ['sg-054bffda9ef94c861'], 'InterfaceType': 'vpc_endpoint', 'MacAddress': '0a:17:2a:c4:85:27', 'NetworkInterfaceId': 'eni-00678c9e1e2e3e950', 'PrivateIpAddress': '10.20.110.225', 'SourceDestCheck': True, 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-00678c9e1e2e3e950', 'PrivateIpAddress': '10.20.110.225', 'resource_id': 'eni-00678c9e1e2e3e950..10.20.110.225'}], 'resource_id': 'eni-00678c9e1e2e3e950'}, {'AttachmentId': 'ela-attach-07d3c247f1fd73441', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'VPC Endpoint Interface vpce-0ea2cb489c0a32713', 'DeviceIndex': 1, 'DnsName': 'ip-10-20-100-32.ec2.internal', 'GroupId': ['sg-054bffda9ef94c861'], 'InterfaceType': 'vpc_endpoint', 'MacAddress': '12:02:fa:c1:fe:43', 'NetworkInterfaceId': 'eni-0dd256e6cd9f067e8', 'PrivateIpAddress': '10.20.100.32', 'SourceDestCheck': True, 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0dd256e6cd9f067e8', 'PrivateIpAddress': '10.20.100.32', 'resource_id': 'eni-0dd256e6cd9f067e8..10.20.100.32'}], 'resource_id': 'eni-0dd256e6cd9f067e8'}], 'vpc_endpoint': [{'NetworkInterfaceIds': ['eni-0dd256e6cd9f067e8', 'eni-00678c9e1e2e3e950'], 'RouteTableIds': [], 'ServiceName': 'com.amazonaws.us-east-1.kinesis-streams', 'VpcEndpointId': 'vpce-0ea2cb489c0a32713', 'VpcEndpointType': 'Interface', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'vpce-0ea2cb489c0a32713', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_kinesis', 'resource_id': 'vpce-0ea2cb489c0a32713..Name'}]}]}}}, 'previous_timestamp': 1622971494229}
2021-06-06 12:24:58,381 - INFO - Calling modeler on-new-snapshot for timestamp 1622971498209 ...
2021-06-06 12:24:58,484 - INFO - Calling analyzer for timestamp 1622971498209 ...
2021-06-06 12:25:02,343 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:02,343 - INFO - Finished triggering everything for timestamp 1622971498209 after 4.03 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.1), ('analyzer', 3.83)]
2021-06-06 12:25:02,498 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:45.230Z, account_id: N/A, extra:{'instance-id': 'i-027316ea5aa78f08b', 'state': 'terminated'}
2021-06-06 12:25:02,668 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpcEndpoints in us-east-1 at 2021-06-06T09:23:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:48Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpcEndpoints', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'DeleteVpcEndpointsRequest': {'VpcEndpointId': {'tag': 1, 'content': 'vpce-07f2a8fb449c88337'}}}, 'responseElements': {'DeleteVpcEndpointsResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': '45429b25-eaa9-412e-98c8-8081c331c290', 'unsuccessful': ''}}, 'requestID': '45429b25-eaa9-412e-98c8-8081c331c290', 'eventID': '6fa27959-719b-4014-9e07-1e68e8f66f5d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:02,668 - INFO - delete vpc_endpoint - ['vpce-07f2a8fb449c88337']
2021-06-06 12:25:02,693 - INFO - Get previous translated snapshot with timestamp 1622971498209 took 0.02 seconds
2021-06-06 12:25:02,702 - WARNING - didn't find resource network_interface with Description value of VPC Endpoint Interface vpce-07f2a8fb449c88337 to delete
2021-06-06 12:25:02,703 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'vpc_endpoint': [{'NetworkInterfaceIds': '', 'RouteTableIds': ['rtb-0674b00afe56d1ab8'], 'ServiceName': 'com.amazonaws.us-east-1.dynamodb', 'VpcEndpointId': 'vpce-07f2a8fb449c88337', 'VpcEndpointType': 'Gateway', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'vpce-07f2a8fb449c88337', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_dynamodb', 'resource_id': 'vpce-07f2a8fb449c88337..Name'}]}]}}}, 'previous_timestamp': 1622971498209}
2021-06-06 12:25:02,766 - INFO - Calling modeler on-new-snapshot for timestamp 1622971502668 ...
2021-06-06 12:25:02,805 - INFO - Calling analyzer for timestamp 1622971502668 ...
2021-06-06 12:25:08,111 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:08,111 - INFO - Finished triggering everything for timestamp 1622971502668 after 5.40 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 5.28)]
2021-06-06 12:25:08,266 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteTable in us-east-1 at 2021-06-06T09:23:36Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:36Z', 'eventSource': 'dynamodb.amazonaws.com', 'eventName': 'DeleteTable', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'tableName': 'test_dynamodb'}, 'responseElements': {'tableDescription': {'tableId': '947f605c-0655-4b22-a68d-303601e987bb', 'provisionedThroughput': {'readCapacityUnits': 0.0, 'writeCapacityUnits': 0.0, 'numberOfDecreasesToday': 0.0}, 'tableName': 'test_dynamodb', 'billingModeSummary': {'billingMode': 'PAY_PER_REQUEST', 'lastUpdateToPayPerRequestDateTime': 'Jun 6, 2021, 9:07:15 AM'}, 'tableSizeBytes': 0.0, 'tableStatus': 'DELETING', 'tableThroughputModeSummary': {'tableThroughputMode': 'PAY_PER_REQUEST', 'lastUpdateToPayPerRequestDateTime': 'Jun 6, 2021, 9:07:15 AM'}, 'tableArn': 'arn:aws:dynamodb:us-east-1:139614369439:table/test_dynamodb', 'itemCount': 0.0}}, 'requestID': 'UOQIJ6AMHC7PH0G8TNRHHO4NVBVV4KQNSO5AEMVJF66Q9ASUAAJG', 'eventID': 'bb51e3ba-9c2f-494b-871a-7e82918330cb', 'readOnly': False, 'resources': [{'accountId': '139614369439', 'type': 'AWS::DynamoDB::Table', 'ARN': 'arn:aws:dynamodb:us-east-1:139614369439:table/test_dynamodb'}], 'eventType': 'AwsApiCall', 'apiVersion': '2012-08-10', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:08,266 - INFO - delete dynamodb_table - ['arn:aws:dynamodb:us-east-1:139614369439:table/test_dynamodb']
2021-06-06 12:25:08,288 - INFO - Get previous translated snapshot with timestamp 1622971502668 took 0.02 seconds
2021-06-06 12:25:08,293 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'dynamodb_table': [{'NumberOfDecreasesToday': 0.0, 'ReadCapacityUnits': 0.0, 'TableArn': 'arn:aws:dynamodb:us-east-1:139614369439:table/test_dynamodb', 'TableName': 'test_dynamodb', 'TableSizeBytes': 0.0, 'WriteCapacityUnits': 0.0, 'resource_id': 'arn:aws:dynamodb:us-east-1:139614369439:table/test_dynamodb'}]}}}, 'previous_timestamp': 1622971502668}
2021-06-06 12:25:08,361 - INFO - Calling modeler on-new-snapshot for timestamp 1622971508267 ...
2021-06-06 12:25:08,386 - INFO - Calling analyzer for timestamp 1622971508267 ...
2021-06-06 12:25:13,425 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:13,425 - INFO - Finished triggering everything for timestamp 1622971508267 after 5.13 seconds! times: [('store_ct_event', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 5.01)]
2021-06-06 12:25:14,268 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:21.373Z, account_id: N/A, extra:{'attachments': [{'id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-06f56ed6ae2441c1a'}, {'name': 'macAddress', 'value': '12:05:3f:55:b9:67'}, {'name': 'privateDnsName', 'value': 'ip-172-31-10-216.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.10.216'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:07:31.704Z', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5/26f42af7-c017-41dd-ba39-990bb7251ee0', 'lastStatus': 'RUNNING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': 'd1e1021ba7f94e1ebc65385be8ed26c5-1576263027', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'networkInterfaces': [{'attachmentId': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'privateIpv4Address': '172.31.10.216'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:07:22.969Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'ephemeralStorage': {'sizeInGiB': 20}, 'group': 'service:test_ecs_service_fargate', 'launchType': 'FARGATE', 'lastStatus': 'RUNNING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'platformVersion': '1.4.0', 'pullStartedAt': '2021-06-06T09:07:54.432Z', 'pullStoppedAt': '2021-06-06T09:07:58.959Z', 'startedAt': '2021-06-06T09:08:01.314Z', 'startedBy': 'ecs-svc/8114543020074586516', 'stoppingAt': '2021-06-06T09:23:21.009Z', 'stoppedReason': 'Scaling activity initiated by (deployment ecs-svc/8114543020074586516)', 'stopCode': 'ServiceSchedulerInitiated', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'updatedAt': '2021-06-06T09:23:21.009Z', 'version': 4}
2021-06-06 12:25:14,426 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteCapacityProvider in us-east-1 at 2021-06-06T09:23:09Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:09Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DeleteCapacityProvider', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'capacityProvider': 'arn:aws:ecs:us-east-1:139614369439:capacity-provider/test_ecs_capacity_provider'}, 'responseElements': {'capacityProvider': {'capacityProviderArn': 'arn:aws:ecs:us-east-1:139614369439:capacity-provider/test_ecs_capacity_provider', 'name': 'test_ecs_capacity_provider', 'status': 'ACTIVE', 'autoScalingGroupProvider': {'autoScalingGroupArn': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group', 'managedScaling': {'status': 'DISABLED', 'targetCapacity': 100, 'minimumScalingStepSize': 1, 'maximumScalingStepSize': 10000, 'instanceWarmupPeriod': 300}, 'managedTerminationProtection': 'DISABLED'}, 'updateStatus': 'DELETE_IN_PROGRESS', 'tags': []}}, 'requestID': '8bf5c402-ab0c-4997-940a-5881efb130c3', 'eventID': '39851373-5376-4fd3-85ff-1c6129545df3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:14,589 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteStream in us-east-1 at 2021-06-06T09:23:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:04Z', 'eventSource': 'kinesis.amazonaws.com', 'eventName': 'DeleteStream', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'streamName': 'test_kinesis', 'enforceConsumerDeletion': False}, 'responseElements': None, 'requestID': 'e3f9b25d-a023-ec73-bacf-246560bf5dc7', 'eventID': 'c2dc1a89-40f4-4844-bf32-f836357fb770', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:14,589 - INFO - delete kinesis - ['arn:aws:kinesis:us-east-1:139614369439:stream/test_kinesis']
2021-06-06 12:25:14,611 - INFO - Get previous translated snapshot with timestamp 1622971508267 took 0.02 seconds
2021-06-06 12:25:14,615 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'kinesis': [{'StreamARN': 'arn:aws:kinesis:us-east-1:139614369439:stream/test_kinesis', 'StreamName': 'test_kinesis', 'resource_id': 'arn:aws:kinesis:us-east-1:139614369439:stream/test_kinesis'}]}}}, 'previous_timestamp': 1622971508267}
2021-06-06 12:25:14,666 - INFO - Calling modeler on-new-snapshot for timestamp 1622971514590 ...
2021-06-06 12:25:14,688 - INFO - Calling analyzer for timestamp 1622971514590 ...
2021-06-06 12:25:19,724 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:19,724 - INFO - Finished triggering everything for timestamp 1622971514590 after 5.10 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('modeler', 0.02), ('analyzer', 5.01)]
2021-06-06 12:25:19,879 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:20Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:20Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:20Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-096f8f06c65612728'}, 'responseElements': {'requestId': 'e32bd0b4-ace0-43e6-866a-ff67ecd1ee89', '_return': True}, 'requestID': 'e32bd0b4-ace0-43e6-866a-ff67ecd1ee89', 'eventID': 'c49ea5cf-14c6-4f4f-8843-212405e06243', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:19,879 - INFO - delete network_interface - ['eni-096f8f06c65612728']
2021-06-06 12:25:19,905 - INFO - Get previous translated snapshot with timestamp 1622971514590 took 0.03 seconds
2021-06-06 12:25:19,912 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'eni-attach-021ee4cbd72c35800', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'Description': 'ELB test-elb-2796885', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-10-25.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InterfaceType': 'interface', 'MacAddress': '16:ed:7d:32:cc:ab', 'NetworkInterfaceId': 'eni-096f8f06c65612728', 'PrivateIpAddress': '10.10.10.25', 'PublicDnsName': 'ec2-54-165-254-126.compute-1.amazonaws.com', 'PublicIpAddress': '54.165.254.126', 'SourceDestCheck': True, 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-096f8f06c65612728', 'PrivateIpAddress': '10.10.10.25', 'resource_id': 'eni-096f8f06c65612728..10.10.10.25'}], 'resource_id': 'eni-096f8f06c65612728'}]}}}, 'previous_timestamp': 1622971514590}
2021-06-06 12:25:19,985 - INFO - Calling modeler on-new-snapshot for timestamp 1622971519880 ...
2021-06-06 12:25:20,033 - INFO - Calling analyzer for timestamp 1622971519880 ...
2021-06-06 12:25:23,350 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:23,350 - INFO - Finished triggering everything for timestamp 1622971519880 after 3.45 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.02), ('store_trans', 0.03), ('modeler', 0.05), ('analyzer', 3.3)]
2021-06-06 12:25:23,505 - INFO - Invalid event id - User N/A (N/A) performed SERVICE_STEADY_STATE in N/A at 2021-06-06T09:23:31.864Z, account_id: N/A, extra:{'eventType': 'INFO', 'eventName': 'SERVICE_STEADY_STATE', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'createdAt': '2021-06-06T09:23:30.908Z'}
2021-06-06 12:25:23,659 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:47.719Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'elasticloadbalancing', 'resource-type': 'loadbalancer', 'version': 1.0, 'tags': {}}
2021-06-06 12:25:23,813 - INFO - Ignoring failed event - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:45Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'errorCode': 'Client.InvalidParameterValue', 'errorMessage': "Network interface 'eni-0dae474beda0eb01e' is currently in use.", 'requestParameters': {'networkInterfaceId': 'eni-0dae474beda0eb01e'}, 'responseElements': None, 'requestID': '6590f590-811b-4251-bf8d-a5afc75b3878', 'eventID': 'f826d71d-23f4-47e0-8ea4-cdbf0d7f6bf2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.InvalidParameterValue, message: Network interface 'eni-0dae474beda0eb01e' is currently in use.)
2021-06-06 12:25:23,968 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReleaseAddress in us-east-1 at 2021-06-06T09:23:50Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:50Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReleaseAddress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'allocationId': 'eipalloc-0c5e86bedf1efb855', 'networkBorderGroup': 'us-east-1'}, 'responseElements': {'requestId': '7a45c28a-d906-44a1-b43e-ef3b6ea1d3aa', '_return': True}, 'requestID': '7a45c28a-d906-44a1-b43e-ef3b6ea1d3aa', 'eventID': 'bc9dd728-d7d6-4cef-b2b4-880dc60fdb9c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:24,125 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:23:50Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:50Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-098ca7ae34579341f'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-098ca7ae34579341f', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '8853b174-bf3c-4b5b-9c20-690f32ac7ef1', 'eventID': '027e8fd6-28b1-4591-b0de-3f340a2b6c6c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:24,125 - INFO - delete instance - ['i-098ca7ae34579341f']
2021-06-06 12:25:24,149 - INFO - Get previous translated snapshot with timestamp 1622971519880 took 0.02 seconds
2021-06-06 12:25:24,171 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-098ca7ae34579341f', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.100.113', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'i-098ca7ae34579341f', 'tag': [{'Key': 'Name', 'Value': 'test-instance_sqs', 'resource_id': 'i-098ca7ae34579341f..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-07ad3b5f8102be29d', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-100-113.ec2.internal', 'GroupId': ['sg-0bf342c26b99f93f2'], 'InstanceId': 'i-098ca7ae34579341f', 'InterfaceType': 'interface', 'MacAddress': '12:94:3e:0b:48:73', 'NetworkInterfaceId': 'eni-0e3f3fb9dcdfac2b0', 'PrivateIpAddress': '10.20.100.113', 'SourceDestCheck': True, 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0e3f3fb9dcdfac2b0', 'PrivateIpAddress': '10.20.100.113', 'resource_id': 'eni-0e3f3fb9dcdfac2b0..10.20.100.113'}], 'resource_id': 'eni-0e3f3fb9dcdfac2b0', 'tag': [{'Key': 'Name', 'Value': 'test_interface_sqs', 'resource_id': 'eni-0e3f3fb9dcdfac2b0..Name'}]}]}}}, 'previous_timestamp': 1622971519880}
2021-06-06 12:25:24,244 - INFO - Calling modeler on-new-snapshot for timestamp 1622971524126 ...
2021-06-06 12:25:24,358 - INFO - Calling analyzer for timestamp 1622971524126 ...
2021-06-06 12:25:30,673 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:30,673 - INFO - Finished triggering everything for timestamp 1622971524126 after 6.49 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.11), ('analyzer', 6.29)]
2021-06-06 12:25:30,830 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:56.177Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:25:31,680 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-0a695efad9fed3af9', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '26d32fa7-4200-4afc-bcaa-b4aa1a14db60', '_return': True}, 'requestID': '26d32fa7-4200-4afc-bcaa-b4aa1a14db60', 'eventID': '331154fa-cdb9-45a5-8ce4-f38d31ff56dc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:31,680 - INFO - modify instance - [{'InstanceId': 'i-0a695efad9fed3af9', 'resource_id': 'i-0a695efad9fed3af9'}]
2021-06-06 12:25:31,704 - INFO - Get previous translated snapshot with timestamp 1622971524126 took 0.02 seconds
2021-06-06 12:25:31,708 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:25:31,708 - WARNING - Failed to handle message: tried to modify an old resource i-0a695efad9fed3af9, but it doesn't exist.
2021-06-06 12:25:31,708 - INFO - adding message to failed events queue for retry
2021-06-06 12:25:31,884 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-0d85e45ef5c46f62f', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '90fcb20c-d85a-412e-9ad2-5c443aaed9d5', '_return': True}, 'requestID': '90fcb20c-d85a-412e-9ad2-5c443aaed9d5', 'eventID': '1751167d-6676-434c-a021-09f47d8312af', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:31,884 - INFO - modify instance - [{'InstanceId': 'i-0d85e45ef5c46f62f', 'resource_id': 'i-0d85e45ef5c46f62f'}]
2021-06-06 12:25:31,916 - INFO - Get previous translated snapshot with timestamp 1622971524126 took 0.03 seconds
2021-06-06 12:25:31,920 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:25:31,920 - WARNING - Failed to handle message: tried to modify an old resource i-0d85e45ef5c46f62f, but it doesn't exist.
2021-06-06 12:25:31,920 - INFO - adding message to failed events queue for retry
2021-06-06 12:25:32,089 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-027316ea5aa78f08b'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-027316ea5aa78f08b', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '15faa43c-3e90-4809-9e98-1eda166eec0b', 'eventID': '3405d38e-c34a-4405-9382-e0ebd7b89621', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:32,090 - INFO - delete instance - ['i-027316ea5aa78f08b']
2021-06-06 12:25:32,126 - INFO - Get previous translated snapshot with timestamp 1622971524126 took 0.03 seconds
2021-06-06 12:25:32,141 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-027316ea5aa78f08b', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.10.80.152', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0427564926cbfc43f', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'i-027316ea5aa78f08b', 'tag': [{'Key': 'Name', 'Value': 'test-instance_rds', 'resource_id': 'i-027316ea5aa78f08b..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-01b7940febc805a72', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1c', 'DeviceIndex': 0, 'DnsName': 'ip-10-10-80-152.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InstanceId': 'i-027316ea5aa78f08b', 'InterfaceType': 'interface', 'MacAddress': '0e:84:71:67:ac:e1', 'NetworkInterfaceId': 'eni-0f71530a3fcf6e27a', 'PrivateIpAddress': '10.10.80.152', 'SourceDestCheck': True, 'SubnetId': 'subnet-0427564926cbfc43f', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0f71530a3fcf6e27a', 'PrivateIpAddress': '10.10.80.152', 'resource_id': 'eni-0f71530a3fcf6e27a..10.10.80.152'}], 'resource_id': 'eni-0f71530a3fcf6e27a', 'tag': [{'Key': 'Name', 'Value': 'test_interface_rds', 'resource_id': 'eni-0f71530a3fcf6e27a..Name'}]}]}}}, 'previous_timestamp': 1622971524126}
2021-06-06 12:25:32,210 - INFO - Calling modeler on-new-snapshot for timestamp 1622971532092 ...
2021-06-06 12:25:32,316 - INFO - Calling analyzer for timestamp 1622971532092 ...
2021-06-06 12:25:37,809 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:37,810 - INFO - Finished triggering everything for timestamp 1622971532092 after 5.67 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.11), ('analyzer', 5.47)]
2021-06-06 12:25:37,974 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteLoadBalancer in us-east-1 at 2021-06-06T09:23:15Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:15Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/52d92dae5a980e86'}, 'responseElements': None, 'requestID': '166c8d5e-dc8c-4361-8c95-1a53e7280325', 'eventID': '5f5650c9-4cc5-476b-8244-b12fe8b5816f', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:37,974 - INFO - delete nlb - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/52d92dae5a980e86']
2021-06-06 12:25:38,002 - INFO - Get previous translated snapshot with timestamp 1622971532092 took 0.03 seconds
2021-06-06 12:25:38,008 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'nlb': [{'DNSName': 'test-nlb-52d92dae5a980e86.elb.us-east-1.amazonaws.com', 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/52d92dae5a980e86', 'LoadBalancerName': 'test-nlb', 'Scheme': 'internet-facing', 'StateCode': 'provisioning', 'Type': 'network', 'VpcId': 'vpc-05c66fc27c8de6f73', 'availability_zone': [{'SubnetId': 'subnet-01c70bc44616f42d1', 'ZoneName': 'us-east-1e', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/52d92dae5a980e86..subnet-01c70bc44616f42d1'}, {'SubnetId': 'subnet-098c87b4a9a29cc5f', 'ZoneName': 'us-east-1f', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/52d92dae5a980e86..subnet-098c87b4a9a29cc5f'}], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/net/test-nlb/52d92dae5a980e86'}]}}}, 'previous_timestamp': 1622971532092}
2021-06-06 12:25:38,082 - INFO - Calling modeler on-new-snapshot for timestamp 1622971537975 ...
2021-06-06 12:25:38,126 - INFO - Calling analyzer for timestamp 1622971537975 ...
2021-06-06 12:25:41,403 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:41,403 - INFO - Finished triggering everything for timestamp 1622971537975 after 3.39 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 3.26)]
2021-06-06 12:25:41,574 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:21Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:21Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:21Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-09ebea27747e819f1'}, 'responseElements': {'requestId': '31e1f6e0-5c92-4873-bcf7-5647cd11deed', '_return': True}, 'requestID': '31e1f6e0-5c92-4873-bcf7-5647cd11deed', 'eventID': 'fdb17175-f52f-4b5b-9f58-154a8a816970', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:41,575 - INFO - delete network_interface - ['eni-09ebea27747e819f1']
2021-06-06 12:25:41,606 - INFO - Get previous translated snapshot with timestamp 1622971537975 took 0.03 seconds
2021-06-06 12:25:41,611 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'eni-attach-00197bd3cfcaf9f12', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'Description': 'ELB test-elb-2796885', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-10-239.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InterfaceType': 'interface', 'MacAddress': '16:89:3b:4a:a6:f5', 'NetworkInterfaceId': 'eni-09ebea27747e819f1', 'PrivateIpAddress': '10.10.10.239', 'PublicDnsName': 'ec2-52-45-94-217.compute-1.amazonaws.com', 'PublicIpAddress': '52.45.94.217', 'SourceDestCheck': True, 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-09ebea27747e819f1', 'PrivateIpAddress': '10.10.10.239', 'resource_id': 'eni-09ebea27747e819f1..10.10.10.239'}], 'resource_id': 'eni-09ebea27747e819f1'}]}}}, 'previous_timestamp': 1622971537975}
2021-06-06 12:25:41,671 - INFO - Calling modeler on-new-snapshot for timestamp 1622971541576 ...
2021-06-06 12:25:41,701 - INFO - Calling analyzer for timestamp 1622971541576 ...
2021-06-06 12:25:44,857 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:44,858 - INFO - Finished triggering everything for timestamp 1622971541576 after 3.25 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.13)]
2021-06-06 12:25:45,047 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:51.713Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'elasticloadbalancing', 'resource-type': 'listener', 'version': 1.0, 'tags': {}}
2021-06-06 12:25:45,203 - INFO - Ignoring failed event - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachNetworkInterface in us-east-1 at 2021-06-06T09:23:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'errorCode': 'Client.AuthFailure', 'errorMessage': 'You do not have permission to access the specified resource.', 'requestParameters': {'attachmentId': 'eni-attach-087ad9a2d5455a73a', 'force': True}, 'responseElements': None, 'requestID': '73ed8398-c36d-4973-9f67-985be7f2432b', 'eventID': '9cb4dd5f-780e-466d-aff1-41e6ec73501e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.AuthFailure, message: You do not have permission to access the specified resource.)
2021-06-06 12:25:45,391 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachInternetGateway in us-east-1 at 2021-06-06T09:24:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:00Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-0f610ccbce4fbec4f', 'vpcId': 'vpc-00ee3246072e19077'}, 'responseElements': {'requestId': '58197aa7-5428-4935-90de-ff5eee687e89', '_return': True}, 'requestID': '58197aa7-5428-4935-90de-ff5eee687e89', 'eventID': '4d583639-293e-4e98-ac8a-1ed45cfa5cb9', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:45,392 - INFO - remove internet_gateway_attachment - ['igw-0f610ccbce4fbec4f..vpc-00ee3246072e19077']
2021-06-06 12:25:45,421 - INFO - Get previous translated snapshot with timestamp 1622971541576 took 0.03 seconds
2021-06-06 12:25:45,425 - WARNING - Failed to handle message: tried to get modify subresource of type internet_gateway_attachment but didn't find its parent igw-0f610ccbce4fbec4f
2021-06-06 12:25:45,425 - INFO - adding message to failed events queue for retry
2021-06-06 12:25:45,595 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:03.736Z, account_id: N/A, extra:{'agentConnected': False, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'ec2InstanceId': 'i-09e2d3e3d9fdb48cf', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 9, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:03.449Z', 'registeredAt': '2021-06-06T09:08:26.326Z', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'attachments': [{'id': '05272592-c932-43c2-ba7f-60effa478cc1', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-0ba19af047fb45c0c'}, {'name': 'macAddress', 'value': '12:80:55:19:0c:3f'}, {'name': 'privateDnsName', 'value': 'ip-172-31-9-79.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.9.79'}]}]}
2021-06-06 12:25:45,800 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:24:01Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:01Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-09e2d3e3d9fdb48cf', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': 'f0d15749-ebab-487e-97e8-4a06e77018d7', '_return': True}, 'requestID': 'f0d15749-ebab-487e-97e8-4a06e77018d7', 'eventID': 'e150b930-2346-47bd-95f0-ad7f54f397a6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:45,801 - INFO - modify instance - [{'InstanceId': 'i-09e2d3e3d9fdb48cf', 'resource_id': 'i-09e2d3e3d9fdb48cf'}]
2021-06-06 12:25:45,822 - INFO - Get previous translated snapshot with timestamp 1622971541576 took 0.02 seconds
2021-06-06 12:25:45,826 - INFO - sub-event will be discarded because no change in resource configuration: {'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-09e2d3e3d9fdb48cf', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.3.178', 'PublicDnsName': 'ec2-3-86-243-83.compute-1.amazonaws.com', 'PublicIpAddress': '3.86.243.83', 'SourceDestCheck': True, 'State': 'running', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-09e2d3e3d9fdb48cf', 'tag': [{'Key': 'Name', 'Value': 'test-instance_ecs', 'resource_id': 'i-09e2d3e3d9fdb48cf..Name'}]} 
2021-06-06 12:25:45,827 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971541576}
2021-06-06 12:25:46,510 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:06.293Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ecs', 'resource-type': 'service', 'version': 105.0, 'tags': {}}
2021-06-06 12:25:46,667 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-0167013933823206a'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-0167013933823206a', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '1988e075-e4b1-4dcb-9344-627547bdd747', 'eventID': 'be9b39a2-f57c-4229-834f-1cf2a50e2934', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:46,667 - INFO - delete instance - ['i-0167013933823206a']
2021-06-06 12:25:46,696 - INFO - Get previous translated snapshot with timestamp 1622971541576 took 0.03 seconds
2021-06-06 12:25:46,747 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-0167013933823206a', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.10.145', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0d3d1a7eb7bc2053f', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'i-0167013933823206a', 'tag': [{'Key': 'Name', 'Value': 'test-instance_3', 'resource_id': 'i-0167013933823206a..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0d48795c563649699', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1c', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-10-145.ec2.internal', 'GroupId': ['sg-0ab93aaa7a4f34f49'], 'InstanceId': 'i-0167013933823206a', 'InterfaceType': 'interface', 'MacAddress': '0e:09:25:28:7c:31', 'NetworkInterfaceId': 'eni-04f12fbe3d839a33c', 'PrivateIpAddress': '10.20.10.145', 'SourceDestCheck': True, 'SubnetId': 'subnet-0d3d1a7eb7bc2053f', 'VpcId': 'vpc-00ee3246072e19077', 'private_ip_address': [{'NetworkInterfaceId': 'eni-04f12fbe3d839a33c', 'PrivateIpAddress': '10.20.10.145', 'resource_id': 'eni-04f12fbe3d839a33c..10.20.10.145'}], 'resource_id': 'eni-04f12fbe3d839a33c', 'tag': [{'Key': 'Name', 'Value': 'test_interface_3', 'resource_id': 'eni-04f12fbe3d839a33c..Name'}]}]}}}, 'previous_timestamp': 1622971541576}
2021-06-06 12:25:46,820 - INFO - Calling modeler on-new-snapshot for timestamp 1622971546668 ...
2021-06-06 12:25:46,909 - INFO - Calling analyzer for timestamp 1622971546668 ...
2021-06-06 12:25:50,855 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:50,855 - INFO - Finished triggering everything for timestamp 1622971546668 after 4.12 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.09), ('analyzer', 3.93)]
2021-06-06 12:25:51,013 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-027316ea5aa78f08b', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '23e46e95-d068-46b7-a113-70bd51ed0ce1', '_return': True}, 'requestID': '23e46e95-d068-46b7-a113-70bd51ed0ce1', 'eventID': '0bfa37d3-4f9e-40d4-8af4-b83c8494d5c7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:51,015 - INFO - modify instance - [{'InstanceId': 'i-027316ea5aa78f08b', 'resource_id': 'i-027316ea5aa78f08b'}]
2021-06-06 12:25:51,055 - INFO - Get previous translated snapshot with timestamp 1622971546668 took 0.04 seconds
2021-06-06 12:25:51,059 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:25:51,059 - WARNING - Failed to handle message: tried to modify an old resource i-027316ea5aa78f08b, but it doesn't exist.
2021-06-06 12:25:51,059 - INFO - adding message to failed events queue for retry
2021-06-06 12:25:51,223 - INFO - User N/A ([APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]) performed DeleteBucket in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'DeleteBucket', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': '[APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]', 'requestParameters': {'bucketName': 'll-test-bucket-2796886', 'Host': 'll-test-bucket-2796886.s3.amazonaws.com'}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 0, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'x/Xxfw1DasaOTG5ZY7XiqfIBI91BW4UL1jxtM8Xl7QqB+rHr6Ik2FubSllcEL+lesUDXwPtcoAQ=', 'bytesTransferredOut': 0}, 'requestID': 'JD1E5VREH7VCBE12', 'eventID': '0a00f768-9062-4e83-88f0-3067f9ba4390', 'readOnly': False, 'resources': [{'accountId': '139614369439', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::ll-test-bucket-2796886'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:51,223 - INFO - delete s3_bucket - ['arn:aws:s3:::ll-test-bucket-2796886']
2021-06-06 12:25:51,246 - INFO - Get previous translated snapshot with timestamp 1622971546668 took 0.02 seconds
2021-06-06 12:25:51,251 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'s3_bucket': [{'BucketArn': 'arn:aws:s3:::ll-test-bucket-2796886', 'IsPublic': False, 'Location': 'us-east-1', 'Name': 'll-test-bucket-2796886', 'acl': [{'GranteeDisplayName': 'automation', 'GranteeType': 'CanonicalUser', 'Permission': 'FULL_CONTROL', 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796886..CanonicalUser..FULL_CONTROL'}], 'resource_id': 'arn:aws:s3:::ll-test-bucket-2796886'}]}}}, 'previous_timestamp': 1622971546668}
2021-06-06 12:25:51,319 - INFO - Calling modeler on-new-snapshot for timestamp 1622971551224 ...
2021-06-06 12:25:51,350 - INFO - Calling analyzer for timestamp 1622971551224 ...
2021-06-06 12:25:55,848 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:25:55,848 - INFO - Finished triggering everything for timestamp 1622971551224 after 4.60 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 4.48)]
2021-06-06 12:25:56,070 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:23:11.928Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'ecs', 'resource-type': 'capacity-provider', 'version': 53.0, 'tags': {}}
2021-06-06 12:25:56,241 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:32.298Z, account_id: N/A, extra:{'instance-id': 'i-0d85e45ef5c46f62f', 'state': 'terminated'}
2021-06-06 12:25:56,452 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachRolePolicy in us-east-1 at 2021-06-06T09:23:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:39Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DetachRolePolicy', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role', 'policyArn': 'arn:aws:iam::139614369439:policy/test_iam_policy'}, 'responseElements': None, 'requestID': '02b2174d-5d53-45d6-8f22-06c615294e78', 'eventID': '47cc31a5-83f4-4b8b-9ceb-937c2323ece0', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:25:56,453 - INFO - hard-modify iam_role - 
2021-06-06 12:25:56,453 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role']}]}}}
2021-06-06 12:25:58,158 - INFO - scanned resources: {'iam_role': [{'RoleName': 'test_role', 'RoleId': 'AROASBANKG2P3IMZGGK33', 'Arn': 'arn:aws:iam::139614369439:role/test_role', 'Path': '/', 'resource_id': 'arn:aws:iam::139614369439:role/test_role'}]}
2021-06-06 12:25:58,182 - INFO - Get previous translated snapshot with timestamp 1622971551224 took 0.02 seconds
2021-06-06 12:25:58,187 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {'iam_role': [{'RoleName': 'test_role', 'RoleId': 'AROASBANKG2P3IMZGGK33', 'Arn': 'arn:aws:iam::139614369439:role/test_role', 'Path': '/', 'resource_id': 'arn:aws:iam::139614369439:role/test_role'}]}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971551224}
2021-06-06 12:25:58,261 - INFO - Calling modeler on-new-snapshot for timestamp 1622971558159 ...
2021-06-06 12:25:58,458 - INFO - Calling analyzer for timestamp 1622971558159 ...
2021-06-06 12:26:03,362 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:03,363 - INFO - Finished triggering everything for timestamp 1622971558159 after 5.17 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.2), ('analyzer', 4.88)]
2021-06-06 12:26:03,528 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:38Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:38Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:38Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0ca8b33d4e904dbff'}, 'responseElements': {'requestId': 'f27b0c9d-b3ab-4d6f-98fe-c921291f44a5', '_return': True}, 'requestID': 'f27b0c9d-b3ab-4d6f-98fe-c921291f44a5', 'eventID': 'fee9b003-b0b5-4461-bdeb-2781b6cb901d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:03,529 - INFO - delete network_interface - ['eni-0ca8b33d4e904dbff']
2021-06-06 12:26:03,553 - INFO - Get previous translated snapshot with timestamp 1622971558159 took 0.02 seconds
2021-06-06 12:26:03,558 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-0fd4d16bf9666bfd8', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1e', 'Description': 'ELB net/test-nlb/52d92dae5a980e86', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-40-184.ec2.internal', 'GroupId': [], 'InterfaceType': 'network_load_balancer', 'MacAddress': '06:45:9a:3d:03:93', 'NetworkInterfaceId': 'eni-0ca8b33d4e904dbff', 'PrivateIpAddress': '10.10.40.184', 'PublicDnsName': 'ec2-34-193-34-114.compute-1.amazonaws.com', 'PublicIpAddress': '34.193.34.114', 'SourceDestCheck': False, 'SubnetId': 'subnet-01c70bc44616f42d1', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0ca8b33d4e904dbff', 'PrivateIpAddress': '10.10.40.184', 'resource_id': 'eni-0ca8b33d4e904dbff..10.10.40.184'}], 'resource_id': 'eni-0ca8b33d4e904dbff'}]}}}, 'previous_timestamp': 1622971558159}
2021-06-06 12:26:03,619 - INFO - Calling modeler on-new-snapshot for timestamp 1622971563530 ...
2021-06-06 12:26:03,653 - INFO - Calling analyzer for timestamp 1622971563530 ...
2021-06-06 12:26:09,443 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:09,443 - INFO - Finished triggering everything for timestamp 1622971563530 after 5.87 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 5.76)]
2021-06-06 12:26:10,363 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRolePolicy in us-east-1 at 2021-06-06T09:23:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:41Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeleteRolePolicy', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role_ecs', 'policyName': 'test_policy_ecs'}, 'responseElements': None, 'requestID': '995b7fbb-c66e-47bc-892b-f9f1f7caad87', 'eventID': '9928a9c3-614c-4f8f-b78b-b1111b8eb2c6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:10,364 - INFO - hard-modify inline_policy_role - 
2021-06-06 12:26:10,364 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_ecs']}]}}}
2021-06-06 12:26:12,089 - INFO - scanned resources: {'iam_role': [{'RoleName': 'test_role_ecs', 'RoleId': 'AROASBANKG2PWKCFXY3QR', 'Arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'Path': '/', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_ecs'}]}
2021-06-06 12:26:12,113 - INFO - Get previous translated snapshot with timestamp 1622971563530 took 0.02 seconds
2021-06-06 12:26:12,116 - INFO - sub-event will be discarded because no change in resource configuration: {'Arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'Path': '/', 'RoleId': 'AROASBANKG2PWKCFXY3QR', 'RoleName': 'test_role_ecs', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_ecs'} 
2021-06-06 12:26:12,117 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971563530}
2021-06-06 12:26:12,319 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:23:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-04268c20aa77717ee', 'routeTableId': 'rtb-07befda2b178ed496'}, 'responseElements': {'requestId': 'be39f56c-3e60-4b30-a22c-d257c2f29123', 'newAssociationId': 'rtbassoc-027edfc57c2a0d93c', 'associationState': {'state': 'associated'}}, 'requestID': 'be39f56c-3e60-4b30-a22c-d257c2f29123', 'eventID': 'ff2d7d4d-e3eb-4dcc-b79d-b2bf6f7fb1a9', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:12,320 - INFO - hard-modify route_table - 
2021-06-06 12:26:12,344 - INFO - Got 1 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-07befda2b178ed496$'}]
2021-06-06 12:26:12,344 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-057a5616a3c33b91f']}]}}}
2021-06-06 12:26:14,557 - INFO - scanned resources: {}
2021-06-06 12:26:14,557 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-057a5616a3c33b91f']}]}}}
2021-06-06 12:26:14,578 - INFO - Get previous translated snapshot with timestamp 1622971563530 took 0.02 seconds
2021-06-06 12:26:14,582 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'route_table': [{'RouteTableId': 'rtb-07befda2b178ed496', 'route_table_association': [{'RouteTableId': 'rtb-07befda2b178ed496', 'AssociationId': 'rtbassoc-027edfc57c2a0d93c', 'resource_id': 'rtb-07befda2b178ed496..rtbassoc-027edfc57c2a0d93c'}], 'resource_id': 'rtb-07befda2b178ed496'}]}, 'deleted': {}}}, 'previous_timestamp': 1622971563530}
2021-06-06 12:26:14,648 - INFO - Calling modeler on-new-snapshot for timestamp 1622971574557 ...
2021-06-06 12:26:14,673 - INFO - Calling analyzer for timestamp 1622971574557 ...
2021-06-06 12:26:17,678 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:17,678 - INFO - Finished triggering everything for timestamp 1622971574557 after 3.10 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 2.98)]
2021-06-06 12:26:20,837 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:04.661Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'internet-gateway', 'version': 4.0, 'tags': {}}
2021-06-06 12:26:21,031 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachRolePolicy in us-east-1 at 2021-06-06T09:24:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:04Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DetachRolePolicy', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role_lambda', 'policyArn': 'arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole'}, 'responseElements': None, 'requestID': 'a0cc9073-2fde-4118-9f55-a320bf745f6f', 'eventID': 'a59d1735-04e6-4b0a-9aaf-02cf6f309a9f', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:21,031 - INFO - hard-modify iam_role - 
2021-06-06 12:26:21,031 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_lambda']}]}}}
2021-06-06 12:26:26,080 - INFO - scanned resources: {}
2021-06-06 12:26:26,080 - WARNING - no resources returned by scan 139614369439/Global: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_lambda']}]}}}
2021-06-06 12:26:26,103 - INFO - Get previous translated snapshot with timestamp 1622971574557 took 0.02 seconds
2021-06-06 12:26:26,108 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {'iam_role': [{'RoleName': 'test_role_lambda', 'Arn': 'arn:aws:iam::139614369439:role/test_role_lambda', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_lambda'}]}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971574557}
2021-06-06 12:26:26,169 - INFO - Calling modeler on-new-snapshot for timestamp 1622971586080 ...
2021-06-06 12:26:26,285 - INFO - Calling analyzer for timestamp 1622971586080 ...
2021-06-06 12:26:29,193 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:29,193 - INFO - Finished triggering everything for timestamp 1622971586080 after 3.09 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.12), ('analyzer', 2.89)]
2021-06-06 12:26:31,133 - INFO - User N/A (ecs.amazonaws.com) performed DetachNetworkInterface in us-east-1 at 2021-06-06T09:24:07Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:06Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:07Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'attachmentId': 'eni-attach-0e2e0f9084acdcb88', 'force': True}, 'responseElements': {'requestId': 'a5e19a31-56c8-439e-bcbe-d2b7d2d4ab8e', '_return': True}, 'requestID': 'a5e19a31-56c8-439e-bcbe-d2b7d2d4ab8e', 'eventID': '4381d203-7289-4047-98b0-a11a58987d22', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:31,133 - INFO - hard-modify network_interface - 
2021-06-06 12:26:31,146 - INFO - Got 1 inventory resources for type network_interface and attributes [{'key': 'AttachmentId', 'value': '^eni-attach-0e2e0f9084acdcb88$'}]
2021-06-06 12:26:31,146 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0ba19af047fb45c0c']}]}}}
2021-06-06 12:26:32,019 - INFO - scanned resources: {}
2021-06-06 12:26:32,019 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-0ba19af047fb45c0c']}]}}}
2021-06-06 12:26:32,075 - INFO - Get previous translated snapshot with timestamp 1622971586080 took 0.06 seconds
2021-06-06 12:26:32,079 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971586080}
2021-06-06 12:26:32,229 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:13.306Z, account_id: N/A, extra:{'instance-id': 'i-036266a196e3f9d88', 'state': 'shutting-down'}
2021-06-06 12:26:32,380 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:10Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:10Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-0d9f92ed9e44352fb'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-0d9f92ed9e44352fb', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': 'd624175f-3260-4a3c-91e8-094ce8534ea7', 'eventID': '2886ec8a-cbb0-413f-8366-d3bdff5f8edc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:32,381 - INFO - delete instance - ['i-0d9f92ed9e44352fb']
2021-06-06 12:26:32,401 - INFO - Get previous translated snapshot with timestamp 1622971586080 took 0.02 seconds
2021-06-06 12:26:32,413 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-0d9f92ed9e44352fb', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.10.60.107', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0754334dae5682f73', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'i-0d9f92ed9e44352fb', 'tag': [{'Key': 'Name', 'Value': 'test-instance_glb', 'resource_id': 'i-0d9f92ed9e44352fb..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0052f2c3ea76c42c1', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-10-10-60-107.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InstanceId': 'i-0d9f92ed9e44352fb', 'InterfaceType': 'interface', 'MacAddress': '12:99:02:a2:64:e3', 'NetworkInterfaceId': 'eni-084ffd9aa0295b237', 'PrivateIpAddress': '10.10.60.107', 'SourceDestCheck': True, 'SubnetId': 'subnet-0754334dae5682f73', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-084ffd9aa0295b237', 'PrivateIpAddress': '10.10.60.107', 'resource_id': 'eni-084ffd9aa0295b237..10.10.60.107'}], 'resource_id': 'eni-084ffd9aa0295b237', 'tag': [{'Key': 'Name', 'Value': 'test_interface_glb', 'resource_id': 'eni-084ffd9aa0295b237..Name'}]}]}}}, 'previous_timestamp': 1622971586080}
2021-06-06 12:26:32,478 - INFO - Calling modeler on-new-snapshot for timestamp 1622971592382 ...
2021-06-06 12:26:32,555 - INFO - Calling analyzer for timestamp 1622971592382 ...
2021-06-06 12:26:44,276 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:44,276 - INFO - Finished triggering everything for timestamp 1622971592382 after 11.87 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.08), ('analyzer', 11.7)]
2021-06-06 12:26:44,437 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:28.647Z, account_id: N/A, extra:{'agentConnected': True, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 4, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:27.604Z', 'registeredAt': '2021-06-06T09:08:47.166Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:26:44,595 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRouteTable in us-east-1 at 2021-06-06T09:24:27Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:27Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteRouteTable', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-058c517f31fc2e518'}, 'responseElements': {'requestId': 'b3424045-6d42-4955-aae3-65d34a1c3535', '_return': True}, 'requestID': 'b3424045-6d42-4955-aae3-65d34a1c3535', 'eventID': '176e6154-5b5d-46a1-8fde-9fa253d7fc36', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:44,596 - INFO - delete route_table - ['rtb-058c517f31fc2e518']
2021-06-06 12:26:44,623 - INFO - Get previous translated snapshot with timestamp 1622971592382 took 0.03 seconds
2021-06-06 12:26:44,629 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'route_table': [{'RouteTableId': 'rtb-058c517f31fc2e518', 'VpcId': 'vpc-057a5616a3c33b91f', 'resource_id': 'rtb-058c517f31fc2e518', 'route': [{'DestinationCidrBlock': '10.30.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-058c517f31fc2e518..10.30.0.0/16'}, {'DestinationCidrBlock': '0.0.0.0/0', 'GatewayId': 'igw-020d848d62f02cfc0', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-058c517f31fc2e518..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-04268c20aa77717ee', 'Main': True, 'RouteTableId': 'rtb-058c517f31fc2e518', 'resource_id': 'rtb-058c517f31fc2e518..rtbassoc-04268c20aa77717ee'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_3', 'resource_id': 'rtb-058c517f31fc2e518..Name'}]}]}}}, 'previous_timestamp': 1622971592382}
2021-06-06 12:26:44,716 - INFO - Calling modeler on-new-snapshot for timestamp 1622971604597 ...
2021-06-06 12:26:44,745 - INFO - Calling analyzer for timestamp 1622971604597 ...
2021-06-06 12:26:49,674 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:49,674 - INFO - Finished triggering everything for timestamp 1622971604597 after 5.05 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_classified', 0.02), ('store_ct_event', 0.03), ('store_trans', 0.03), ('modeler', 0.03), ('analyzer', 4.91)]
2021-06-06 12:26:49,811 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:32.978Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'route-table', 'version': 2.0, 'tags': {}}
2021-06-06 12:26:49,965 - INFO - User N/A (ecs.amazonaws.com) performed AttachNetworkInterface in us-east-1 at 2021-06-06T09:24:33Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:31Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:33Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AttachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-03cb776612d14e182', 'instanceId': 'i-0de0fd033ca956c3f', 'deviceIndex': 1}, 'responseElements': {'requestId': '9b2daadd-6f74-4ca2-9616-0e33456cd9aa', 'attachmentId': 'eni-attach-025fdbb263e661b56'}, 'requestID': '9b2daadd-6f74-4ca2-9616-0e33456cd9aa', 'eventID': '0bd8f19d-4eeb-408e-a875-efd67148867d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:49,965 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-03cb776612d14e182', 'InstanceId': 'i-0de0fd033ca956c3f', 'resource_id': 'eni-03cb776612d14e182'}]
2021-06-06 12:26:49,965 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03cb776612d14e182']}]}}}
2021-06-06 12:26:51,095 - INFO - scanned resources: {}
2021-06-06 12:26:51,096 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03cb776612d14e182']}]}}}
2021-06-06 12:26:51,134 - INFO - Get previous translated snapshot with timestamp 1622971604597 took 0.04 seconds
2021-06-06 12:26:51,141 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:26:51,141 - WARNING - Failed to handle message: tried to modify an old resource eni-03cb776612d14e182, but it doesn't exist.
2021-06-06 12:26:51,141 - INFO - adding message to failed events queue for retry
2021-06-06 12:26:51,298 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:39.494Z, account_id: N/A, extra:{'attachments': [{'id': '05272592-c932-43c2-ba7f-60effa478cc1', 'type': 'eni', 'status': 'DELETED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-0ba19af047fb45c0c'}, {'name': 'macAddress', 'value': '12:80:55:19:0c:3f'}, {'name': 'privateDnsName', 'value': 'ip-172-31-9-79.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.9.79'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:08:32.833Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c/10013233-aa14-4e87-815b-06230fe6c03a', 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': 'a2f527ca96f216d9ffc19d04e9b9fe7c2c466a5cfbf1ac383ca8a6ffa1448fd3', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'networkInterfaces': [{'attachmentId': '05272592-c932-43c2-ba7f-60effa478cc1', 'privateIpv4Address': '172.31.9.79'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:08:32.833Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'STOPPED', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'pullStartedAt': '2021-06-06T09:08:51.298Z', 'pullStoppedAt': '2021-06-06T09:08:56.298Z', 'startedAt': '2021-06-06T09:08:57.298Z', 'startedBy': 'ecs-svc/3384641070202511327', 'stoppingAt': '2021-06-06T09:24:04.374Z', 'stoppedAt': '2021-06-06T09:24:39.062Z', 'stoppedReason': 'Host EC2 (instance i-09e2d3e3d9fdb48cf) terminated.', 'stopCode': 'TerminationNotice', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:24:39.062Z', 'version': 5}
2021-06-06 12:26:51,917 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:23:43Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:43Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-0521e2055e4dcfe4b', 'routeTableId': 'rtb-0b3e7b0bf3a50d9fe'}, 'responseElements': {'requestId': '7d4ec0c4-38eb-41da-a759-baa0a9d48ab0', 'newAssociationId': 'rtbassoc-08a5f366dbf4f422d', 'associationState': {'state': 'associated'}}, 'requestID': '7d4ec0c4-38eb-41da-a759-baa0a9d48ab0', 'eventID': 'ac00b3fd-e38a-487f-941f-fda1ad480868', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:51,918 - INFO - hard-modify route_table - 
2021-06-06 12:26:51,949 - INFO - Got 1 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-0b3e7b0bf3a50d9fe$'}]
2021-06-06 12:26:51,950 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-00ee3246072e19077']}]}}}
2021-06-06 12:26:52,887 - INFO - scanned resources: {}
2021-06-06 12:26:52,887 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-00ee3246072e19077']}]}}}
2021-06-06 12:26:52,929 - INFO - Get previous translated snapshot with timestamp 1622971604597 took 0.04 seconds
2021-06-06 12:26:52,937 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'route_table': [{'RouteTableId': 'rtb-0b3e7b0bf3a50d9fe', 'route_table_association': [{'RouteTableId': 'rtb-0b3e7b0bf3a50d9fe', 'AssociationId': 'rtbassoc-08a5f366dbf4f422d', 'resource_id': 'rtb-0b3e7b0bf3a50d9fe..rtbassoc-08a5f366dbf4f422d'}], 'resource_id': 'rtb-0b3e7b0bf3a50d9fe'}]}, 'deleted': {}}}, 'previous_timestamp': 1622971604597}
2021-06-06 12:26:53,045 - INFO - Calling modeler on-new-snapshot for timestamp 1622971612889 ...
2021-06-06 12:26:53,102 - INFO - Calling analyzer for timestamp 1622971612889 ...
2021-06-06 12:26:56,725 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:26:56,725 - INFO - Finished triggering everything for timestamp 1622971612889 after 3.79 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.03), ('store_classified', 0.05), ('modeler', 0.06), ('analyzer', 3.6)]
2021-06-06 12:26:56,871 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReplaceRouteTableAssociation in us-east-1 at 2021-06-06T09:23:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReplaceRouteTableAssociation', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'associationId': 'rtbassoc-00f17634a9c8cce79', 'routeTableId': 'rtb-0f4b67442dc0847bc'}, 'responseElements': {'requestId': 'ed3950af-5510-4c28-9ae1-0914428a4ef7', 'newAssociationId': 'rtbassoc-0a8b470d4119c0c89', 'associationState': {'state': 'associated'}}, 'requestID': 'ed3950af-5510-4c28-9ae1-0914428a4ef7', 'eventID': '56d8260d-ccfe-4953-96d9-0902182a07dd', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:26:56,871 - INFO - hard-modify route_table - 
2021-06-06 12:26:56,890 - INFO - Got 1 inventory resources for type route_table and attributes [{'key': 'RouteTableId', 'value': '^rtb-0f4b67442dc0847bc$'}]
2021-06-06 12:26:56,891 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-05c66fc27c8de6f73']}]}}}
2021-06-06 12:26:58,463 - INFO - scanned resources: {}
2021-06-06 12:26:58,463 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'route_table': {'filters': [{'name': 'VpcId', 'values': ['vpc-05c66fc27c8de6f73']}]}}}
2021-06-06 12:26:58,524 - INFO - Get previous translated snapshot with timestamp 1622971612889 took 0.05 seconds
2021-06-06 12:26:58,529 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'route_table': [{'RouteTableId': 'rtb-0f4b67442dc0847bc', 'route_table_association': [{'RouteTableId': 'rtb-0f4b67442dc0847bc', 'AssociationId': 'rtbassoc-0a8b470d4119c0c89', 'resource_id': 'rtb-0f4b67442dc0847bc..rtbassoc-0a8b470d4119c0c89'}], 'resource_id': 'rtb-0f4b67442dc0847bc'}]}, 'deleted': {}}}, 'previous_timestamp': 1622971612889}
2021-06-06 12:26:58,601 - INFO - Calling modeler on-new-snapshot for timestamp 1622971618479 ...
2021-06-06 12:26:58,650 - INFO - Calling analyzer for timestamp 1622971618479 ...
2021-06-06 12:27:01,832 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:01,832 - INFO - Finished triggering everything for timestamp 1622971618479 after 3.30 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.05), ('analyzer', 3.16)]
2021-06-06 12:27:02,041 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteLoadBalancer in us-east-1 at 2021-06-06T09:23:44Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:44Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/4ceeb03b06092870'}, 'responseElements': None, 'requestID': 'f27b4ba2-bbcf-4fae-8797-cb5eab3f8f4f', 'eventID': '6e2565fc-bbeb-4231-af5e-89d1a415c917', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:02,041 - INFO - delete alb - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/4ceeb03b06092870']
2021-06-06 12:27:02,067 - INFO - Get previous translated snapshot with timestamp 1622971618479 took 0.03 seconds
2021-06-06 12:27:02,071 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'alb': [{'DNSName': 'test-alb-1938080567.us-east-1.elb.amazonaws.com', 'GroupId': [{'security_group_id': ['sg-0aa68cd0fc33a9815']}], 'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/4ceeb03b06092870', 'LoadBalancerName': 'test-alb', 'Scheme': 'internet-facing', 'StateCode': 'provisioning', 'Type': 'application', 'VpcId': 'vpc-05c66fc27c8de6f73', 'availability_zone': [{'SubnetId': 'subnet-0a4f64f15f34bcc51', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/4ceeb03b06092870..subnet-0a4f64f15f34bcc51'}, {'SubnetId': 'subnet-0c24281e12e370c44', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/4ceeb03b06092870..subnet-0c24281e12e370c44'}], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/app/test-alb/4ceeb03b06092870'}]}}}, 'previous_timestamp': 1622971618479}
2021-06-06 12:27:02,129 - INFO - Calling modeler on-new-snapshot for timestamp 1622971622042 ...
2021-06-06 12:27:02,164 - INFO - Calling analyzer for timestamp 1622971622042 ...
2021-06-06 12:27:05,365 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:05,365 - INFO - Finished triggering everything for timestamp 1622971622042 after 3.29 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.18)]
2021-06-06 12:27:05,518 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:23:51.003Z, account_id: N/A, extra:{'instance-id': 'i-098ca7ae34579341f', 'state': 'shutting-down'}
2021-06-06 12:27:05,720 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:49Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:49Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-098ca7ae34579341f', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': 'b8a5ed7f-4755-4a18-9cba-bc7346f8851b', '_return': True}, 'requestID': 'b8a5ed7f-4755-4a18-9cba-bc7346f8851b', 'eventID': 'b024bd38-66f9-497f-a51a-817543936424', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:05,720 - INFO - modify instance - [{'InstanceId': 'i-098ca7ae34579341f', 'resource_id': 'i-098ca7ae34579341f'}]
2021-06-06 12:27:05,751 - INFO - Get previous translated snapshot with timestamp 1622971622042 took 0.03 seconds
2021-06-06 12:27:05,755 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:27:05,755 - WARNING - Failed to handle message: tried to modify an old resource i-098ca7ae34579341f, but it doesn't exist.
2021-06-06 12:27:05,755 - INFO - adding message to failed events queue for retry
2021-06-06 12:27:05,904 - INFO - Ignoring failed event - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:01Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:02Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'errorCode': 'Client.InvalidParameterValue', 'errorMessage': "Network interface 'eni-0dae474beda0eb01e' is currently in use.", 'requestParameters': {'networkInterfaceId': 'eni-0dae474beda0eb01e'}, 'responseElements': None, 'requestID': 'b5a94722-fb9f-4106-b2d7-bdff0350070f', 'eventID': '8dfab2bd-dfa5-4e7e-892b-2112fa041639', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.InvalidParameterValue, message: Network interface 'eni-0dae474beda0eb01e' is currently in use.)
2021-06-06 12:27:06,055 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRoute in us-east-1 at 2021-06-06T09:24:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteRoute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-0304b06dc7ba9bb22', 'destinationCidrBlock': '0.0.0.0/0'}, 'responseElements': {'requestId': 'd824bd01-1b72-43c5-a4ec-835c9020f06a', '_return': True}, 'requestID': 'd824bd01-1b72-43c5-a4ec-835c9020f06a', 'eventID': 'fe31a509-6c5e-401f-9365-230d07fcb0fd', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:06,056 - INFO - modify route_table - [{'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'route': [{'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0304b06dc7ba9bb22..0.0.0.0/0'}], 'resource_id': 'rtb-0304b06dc7ba9bb22'}]
2021-06-06 12:27:06,057 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-0304b06dc7ba9bb22']}]}}}
2021-06-06 12:27:08,292 - INFO - scanned resources: {}
2021-06-06 12:27:08,292 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'route_table': {'filters': [{'name': 'RouteTableId', 'values': ['rtb-0304b06dc7ba9bb22']}]}}}
2021-06-06 12:27:08,316 - INFO - Get previous translated snapshot with timestamp 1622971622042 took 0.02 seconds
2021-06-06 12:27:08,320 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'route_table': [{'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'rtb-0304b06dc7ba9bb22', 'route': [{'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'DestinationCidrBlock': '0.0.0.0/0', 'resource_id': 'rtb-0304b06dc7ba9bb22..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-00f17634a9c8cce79', 'Main': True, 'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'resource_id': 'rtb-0304b06dc7ba9bb22..rtbassoc-00f17634a9c8cce79'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0304b06dc7ba9bb22..Name'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622971622042}
2021-06-06 12:27:08,385 - INFO - Calling modeler on-new-snapshot for timestamp 1622971628292 ...
2021-06-06 12:27:08,498 - INFO - Calling analyzer for timestamp 1622971628292 ...
2021-06-06 12:27:12,727 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:12,727 - INFO - Finished triggering everything for timestamp 1622971628292 after 4.41 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.11), ('analyzer', 4.21)]
2021-06-06 12:27:12,878 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:11.373Z, account_id: N/A, extra:{'agentConnected': False, 'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role'}], 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'ec2InstanceId': 'i-0bc9c6152477ce465', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 7, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:11.089Z', 'registeredAt': '2021-06-06T09:08:43.39Z', 'pendingTasksCount': 0, 'runningTasksCount': 1, 'attachments': [{'id': '37b6cac5-fc31-463f-89cc-3184f05413d5', 'type': 'eni', 'status': 'ATTACHED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-026ba384964109468'}, {'name': 'macAddress', 'value': '12:5a:b8:61:34:4f'}, {'name': 'privateDnsName', 'value': 'ip-172-31-5-40.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.5.40'}]}]}
2021-06-06 12:27:13,040 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:13.456Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '68477506-1e60-44fc-ac85-6253de30bdc8'}
2021-06-06 12:27:13,193 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:24:09Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:09Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-0d9f92ed9e44352fb', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': 'b53d503e-e1a1-4a6b-b722-94081dca556e', '_return': True}, 'requestID': 'b53d503e-e1a1-4a6b-b722-94081dca556e', 'eventID': '4a8e6edf-1630-49c2-ba28-36f7ca405093', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:13,193 - INFO - modify instance - [{'InstanceId': 'i-0d9f92ed9e44352fb', 'resource_id': 'i-0d9f92ed9e44352fb'}]
2021-06-06 12:27:13,225 - INFO - Get previous translated snapshot with timestamp 1622971628292 took 0.03 seconds
2021-06-06 12:27:13,229 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:27:13,229 - WARNING - Failed to handle message: tried to modify an old resource i-0d9f92ed9e44352fb, but it doesn't exist.
2021-06-06 12:27:13,229 - INFO - adding message to failed events queue for retry
2021-06-06 12:27:13,707 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:06Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:06Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-07600a9b4869cc2a2'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-07600a9b4869cc2a2', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '247da8bf-262c-42d3-a238-576ad6da6a9b', 'eventID': 'cbaaa0c5-e71a-44a6-a9b7-70439644b417', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:13,708 - INFO - delete instance - ['i-07600a9b4869cc2a2']
2021-06-06 12:27:13,729 - INFO - Get previous translated snapshot with timestamp 1622971628292 took 0.02 seconds
2021-06-06 12:27:13,743 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-07600a9b4869cc2a2', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.20.110.236', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'i-07600a9b4869cc2a2', 'tag': [{'Key': 'Name', 'Value': 'test-instance_dynamo_db', 'resource_id': 'i-07600a9b4869cc2a2..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-04ed8513398f9e7d0', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'DeviceIndex': 0, 'DnsName': 'ip-10-20-110-236.ec2.internal', 'GroupId': ['sg-0bf342c26b99f93f2'], 'InstanceId': 'i-07600a9b4869cc2a2', 'InterfaceType': 'interface', 'MacAddress': '0a:90:d7:d6:04:05', 'NetworkInterfaceId': 'eni-064f1d287f7b216bd', 'PrivateIpAddress': '10.20.110.236', 'SourceDestCheck': True, 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-064f1d287f7b216bd', 'PrivateIpAddress': '10.20.110.236', 'resource_id': 'eni-064f1d287f7b216bd..10.20.110.236'}], 'resource_id': 'eni-064f1d287f7b216bd', 'tag': [{'Key': 'Name', 'Value': 'test_interface_dynamo', 'resource_id': 'eni-064f1d287f7b216bd..Name'}]}]}}}, 'previous_timestamp': 1622971628292}
2021-06-06 12:27:13,806 - INFO - Calling modeler on-new-snapshot for timestamp 1622971633708 ...
2021-06-06 12:27:13,890 - INFO - Calling analyzer for timestamp 1622971633708 ...
2021-06-06 12:27:18,564 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:18,564 - INFO - Finished triggering everything for timestamp 1622971633708 after 4.82 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.08), ('analyzer', 4.66)]
2021-06-06 12:27:18,761 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:10.880Z, account_id: N/A, extra:{'instance-id': 'i-0d9f92ed9e44352fb', 'state': 'shutting-down'}
2021-06-06 12:27:19,013 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:10Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:09Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:10Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0dae474beda0eb01e'}, 'responseElements': {'requestId': '0e0012ab-5f24-4c3f-a29a-6a23d5a9016f', '_return': True}, 'requestID': '0e0012ab-5f24-4c3f-a29a-6a23d5a9016f', 'eventID': '1fc58fcc-39a0-420c-a966-1d34cd391aa0', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:19,013 - INFO - delete network_interface - ['eni-0dae474beda0eb01e']
2021-06-06 12:27:19,043 - INFO - Get previous translated snapshot with timestamp 1622971633708 took 0.03 seconds
2021-06-06 12:27:19,047 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'eni-attach-087ad9a2d5455a73a', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'ELB app/test-alb/4ceeb03b06092870', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-20-19.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InterfaceType': 'interface', 'MacAddress': '12:c7:24:ae:54:bf', 'NetworkInterfaceId': 'eni-0dae474beda0eb01e', 'PrivateIpAddress': '10.10.20.19', 'PublicDnsName': 'ec2-18-213-214-62.compute-1.amazonaws.com', 'PublicIpAddress': '18.213.214.62', 'SourceDestCheck': True, 'SubnetId': 'subnet-0c24281e12e370c44', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0dae474beda0eb01e', 'PrivateIpAddress': '10.10.20.19', 'resource_id': 'eni-0dae474beda0eb01e..10.10.20.19'}], 'resource_id': 'eni-0dae474beda0eb01e'}]}}}, 'previous_timestamp': 1622971633708}
2021-06-06 12:27:19,107 - INFO - Calling modeler on-new-snapshot for timestamp 1622971639013 ...
2021-06-06 12:27:19,143 - INFO - Calling analyzer for timestamp 1622971639013 ...
2021-06-06 12:27:23,961 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:23,961 - INFO - Finished triggering everything for timestamp 1622971639013 after 4.92 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 4.79)]
2021-06-06 12:27:24,111 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeregisterScalableTarget in us-east-1 at 2021-06-06T09:24:01Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:01Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'DeregisterScalableTarget', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'resourceId': 'service/test_ecs_cluster/test_ecs_service', 'serviceNamespace': 'ecs', 'scalableDimension': 'ecs:service:DesiredCount'}, 'responseElements': None, 'additionalEventData': {'service': 'application-autoscaling'}, 'requestID': '519b6270-57b6-4cec-9df5-793778424a5f', 'eventID': '13947e7c-d2e4-416f-b0f6-5a6600d04798', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:24,266 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:27.863Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'iam', 'resource-type': 'policy', 'version': 47.0, 'tags': {}}
2021-06-06 12:27:24,414 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed UpdateAutoScalingGroup in us-east-1 at 2021-06-06T09:24:18Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:18Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'UpdateAutoScalingGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'maxSize': 0, 'minSize': 0, 'desiredCapacity': 0, 'autoScalingGroupName': 'test_autoscaling_group'}, 'responseElements': None, 'requestID': '70593c95-4999-41ee-aac7-fe50bcdac2db', 'eventID': '6af20a06-58b0-4c54-bf4a-9b144ec62a67', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:24,415 - INFO - modify auto_scaling_group - []
2021-06-06 12:27:24,415 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'auto_scaling_group': {'filters': [{'name': 'AutoScalingGroupName', 'values': ['test_autoscaling_group']}]}}}
2021-06-06 12:27:26,579 - INFO - scanned resources: {'auto_scaling_group': [{'AutoScalingGroupName': 'test_autoscaling_group', 'AutoScalingGroupARN': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group', 'LaunchConfigurationName': 'terraform-20210606090725817600000006', 'MinSize': 0, 'MaxSize': 0, 'DefaultCooldown': 300, 'DesiredCapacity': 0, 'HealthCheckType': 'EC2', 'HealthCheckGracePeriod': 300, 'tag': [{'Key': 'AmazonECSManaged', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group..AmazonECSManaged'}], 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group'}]}
2021-06-06 12:27:26,601 - INFO - Get previous translated snapshot with timestamp 1622971639013 took 0.02 seconds
2021-06-06 12:27:26,605 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'auto_scaling_group': [{'AutoScalingGroupARN': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group', 'AutoScalingGroupName': 'test_autoscaling_group', 'DefaultCooldown': 300, 'DesiredCapacity': 0, 'HealthCheckGracePeriod': 300, 'HealthCheckType': 'EC2', 'LaunchConfigurationName': 'terraform-20210606090725817600000006', 'MaxSize': 0, 'MinSize': 0, 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group', 'tag': [{'Key': 'AmazonECSManaged', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group..AmazonECSManaged'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622971639013}
2021-06-06 12:27:26,680 - INFO - Calling modeler on-new-snapshot for timestamp 1622971646581 ...
2021-06-06 12:27:26,749 - INFO - Calling analyzer for timestamp 1622971646581 ...
2021-06-06 12:27:29,778 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:29,778 - INFO - Finished triggering everything for timestamp 1622971646581 after 3.18 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.07), ('analyzer', 3.01)]
2021-06-06 12:27:29,975 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:40.047Z, account_id: N/A, extra:{'instance-id': 'i-0bc9c6152477ce465', 'state': 'shutting-down'}
2021-06-06 12:27:30,181 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:24:35Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:35Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0a4f64f15f34bcc51'}, 'responseElements': {'requestId': '95a1a7a0-b893-4061-a816-99bd6a77e795', '_return': True}, 'requestID': '95a1a7a0-b893-4061-a816-99bd6a77e795', 'eventID': '169da000-7ccb-49e7-89ce-1dcf7ecb5722', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:30,181 - INFO - delete subnet - ['subnet-0a4f64f15f34bcc51']
2021-06-06 12:27:30,207 - INFO - Get previous translated snapshot with timestamp 1622971646581 took 0.03 seconds
2021-06-06 12:27:30,211 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1b', 'CidrBlock': '10.10.30.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0a4f64f15f34bcc51', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-0a4f64f15f34bcc51', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_alb_2', 'resource_id': 'subnet-0a4f64f15f34bcc51..Name'}]}]}}}, 'previous_timestamp': 1622971646581}
2021-06-06 12:27:30,268 - INFO - Calling modeler on-new-snapshot for timestamp 1622971650182 ...
2021-06-06 12:27:30,289 - INFO - Calling analyzer for timestamp 1622971650182 ...
2021-06-06 12:27:33,542 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:33,542 - INFO - Finished triggering everything for timestamp 1622971650182 after 3.33 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('validate_timestamp', 0.02), ('analyzer', 3.22)]
2021-06-06 12:27:33,719 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteTargetGroup in us-east-1 at 2021-06-06T09:24:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:40Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteTargetGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'targetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba'}, 'responseElements': None, 'requestID': '9c6bbb02-278e-4852-bc5a-c4cf938b98c9', 'eventID': 'c0a3f56e-f8f3-48b1-8a58-f9f14d9a1bd3', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:33,719 - INFO - delete target_group - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba']
2021-06-06 12:27:33,775 - INFO - Get previous translated snapshot with timestamp 1622971650182 took 0.06 seconds
2021-06-06 12:27:33,780 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'target_group': [{'Port': 6081, 'Protocol': 'GENEVE', 'TargetGroupArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba', 'TargetGroupName': 'test-tg-glb', 'TargetType': 'instance', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:targetgroup/test-tg-glb/00dcf5c503406dd9ba', 'target': []}]}}}, 'previous_timestamp': 1622971650182}
2021-06-06 12:27:33,851 - INFO - Calling modeler on-new-snapshot for timestamp 1622971653720 ...
2021-06-06 12:27:33,885 - INFO - Calling analyzer for timestamp 1622971653720 ...
2021-06-06 12:27:37,079 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:37,079 - INFO - Finished triggering everything for timestamp 1622971653720 after 3.29 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.17)]
2021-06-06 12:27:37,238 - INFO - User N/A (ecs.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:38Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:06Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:38Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0ba19af047fb45c0c'}, 'responseElements': {'requestId': '2c9fd6b8-c147-43a7-82d8-468ea32ae5b1', '_return': True}, 'requestID': '2c9fd6b8-c147-43a7-82d8-468ea32ae5b1', 'eventID': '5c4b4755-9517-4b2b-b7df-8d5ab1317955', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:37,238 - INFO - delete network_interface - ['eni-0ba19af047fb45c0c']
2021-06-06 12:27:37,268 - INFO - Get previous translated snapshot with timestamp 1622971653720 took 0.03 seconds
2021-06-06 12:27:37,273 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'eni-attach-0e2e0f9084acdcb88', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/05272592-c932-43c2-ba7f-60effa478cc1', 'DeviceIndex': 1, 'DnsName': 'ip-172-31-9-79.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-09e2d3e3d9fdb48cf', 'InterfaceType': 'interface', 'MacAddress': '12:80:55:19:0c:3f', 'NetworkInterfaceId': 'eni-0ba19af047fb45c0c', 'PrivateIpAddress': '172.31.9.79', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0ba19af047fb45c0c', 'PrivateIpAddress': '172.31.9.79', 'resource_id': 'eni-0ba19af047fb45c0c..172.31.9.79'}], 'resource_id': 'eni-0ba19af047fb45c0c'}]}}}, 'previous_timestamp': 1622971653720}
2021-06-06 12:27:37,334 - INFO - Calling modeler on-new-snapshot for timestamp 1622971657239 ...
2021-06-06 12:27:37,376 - INFO - Calling analyzer for timestamp 1622971657239 ...
2021-06-06 12:27:42,352 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:42,352 - INFO - Finished triggering everything for timestamp 1622971657239 after 5.07 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 4.95)]
2021-06-06 12:27:42,802 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:40.373Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': 'd8a5cae9-1c69-4a6c-89a0-c97f41472d32'}
2021-06-06 12:27:42,953 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:43.413Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'elasticloadbalancing', 'resource-type': 'loadbalancer', 'version': 1.0, 'tags': {}}
2021-06-06 12:27:43,103 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:43.750Z, account_id: N/A, extra:{'attachments': [], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17/5f88ada6-6f0f-4b44-9c4c-e52eb52222e4', 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17', 'networkInterfaces': [], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:24:27.599Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'DEPROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'startedBy': 'ecs-svc/3384641070202511327', 'stoppingAt': '2021-06-06T09:24:43.551Z', 'stoppedReason': 'Host EC2 (instance i-0de0fd033ca956c3f) terminated.', 'stopCode': 'TerminationNotice', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:24:43.551Z', 'version': 2}
2021-06-06 12:27:43,256 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:44.086Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'INACTIVE', 'version': 6, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:43.551Z', 'registeredAt': '2021-06-06T09:08:47.166Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:27:43,410 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteLoadBalancer in us-east-1 at 2021-06-06T09:24:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:40Z', 'eventSource': 'elasticloadbalancing.amazonaws.com', 'eventName': 'DeleteLoadBalancer', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'loadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6'}, 'responseElements': None, 'requestID': '960f0ee2-5655-4cf9-bcea-9c62d24e3626', 'eventID': '88d57ce5-3a8a-4379-8fcb-aeb46995e252', 'readOnly': False, 'eventType': 'AwsApiCall', 'apiVersion': '2015-12-01', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:43,411 - INFO - delete glb - ['arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6']
2021-06-06 12:27:43,458 - INFO - Get previous translated snapshot with timestamp 1622971657239 took 0.05 seconds
2021-06-06 12:27:43,465 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'glb': [{'LoadBalancerArn': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6', 'LoadBalancerName': 'test-glb', 'StateCode': 'provisioning', 'Type': 'gateway', 'VpcId': 'vpc-05c66fc27c8de6f73', 'availability_zone': [{'SubnetId': 'subnet-080bf67267388f92d', 'ZoneName': 'us-east-1b', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6..subnet-080bf67267388f92d'}, {'SubnetId': 'subnet-0754334dae5682f73', 'ZoneName': 'us-east-1a', 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6..subnet-0754334dae5682f73'}], 'listener_glb': [], 'resource_id': 'arn:aws:elasticloadbalancing:us-east-1:139614369439:loadbalancer/gwy/test-glb/53d838234c69cdf6'}]}}}, 'previous_timestamp': 1622971657239}
2021-06-06 12:27:43,599 - INFO - Calling modeler on-new-snapshot for timestamp 1622971663412 ...
2021-06-06 12:27:43,684 - INFO - Calling analyzer for timestamp 1622971663412 ...
2021-06-06 12:27:47,013 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:47,013 - INFO - Finished triggering everything for timestamp 1622971663412 after 3.54 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_sub_events', 0.02), ('store_ct_event', 0.03), ('store_classified', 0.04), ('store_trans', 0.05), ('modeler', 0.08), ('analyzer', 3.3)]
2021-06-06 12:27:47,162 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:24:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-098c87b4a9a29cc5f'}, 'responseElements': {'requestId': '9bee475a-85c7-4cab-989c-3dcf28c30ef3', '_return': True}, 'requestID': '9bee475a-85c7-4cab-989c-3dcf28c30ef3', 'eventID': '5c497d25-f1fa-4f2c-9d50-15f6e36d0a32', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:47,162 - INFO - delete subnet - ['subnet-098c87b4a9a29cc5f']
2021-06-06 12:27:47,185 - INFO - Get previous translated snapshot with timestamp 1622971663412 took 0.02 seconds
2021-06-06 12:27:47,190 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1f', 'CidrBlock': '10.10.50.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-098c87b4a9a29cc5f', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-098c87b4a9a29cc5f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nlb_2', 'resource_id': 'subnet-098c87b4a9a29cc5f..Name'}]}]}}}, 'previous_timestamp': 1622971663412}
2021-06-06 12:27:47,252 - INFO - Calling modeler on-new-snapshot for timestamp 1622971667163 ...
2021-06-06 12:27:47,274 - INFO - Calling analyzer for timestamp 1622971667163 ...
2021-06-06 12:27:50,493 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:50,493 - INFO - Finished triggering everything for timestamp 1622971667163 after 3.30 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 3.2)]
2021-06-06 12:27:50,642 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:24:44Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:44Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-01c70bc44616f42d1'}, 'responseElements': {'requestId': '11712cd0-3288-4b14-9f4e-d820b0470b61', '_return': True}, 'requestID': '11712cd0-3288-4b14-9f4e-d820b0470b61', 'eventID': '9b7bfec0-d99e-4be0-9778-0cf69a022f35', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:50,642 - INFO - delete subnet - ['subnet-01c70bc44616f42d1']
2021-06-06 12:27:50,669 - INFO - Get previous translated snapshot with timestamp 1622971667163 took 0.03 seconds
2021-06-06 12:27:50,676 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1e', 'CidrBlock': '10.10.40.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-01c70bc44616f42d1', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-01c70bc44616f42d1', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nlb_1', 'resource_id': 'subnet-01c70bc44616f42d1..Name'}]}]}}}, 'previous_timestamp': 1622971667163}
2021-06-06 12:27:50,747 - INFO - Calling modeler on-new-snapshot for timestamp 1622971670643 ...
2021-06-06 12:27:50,774 - INFO - Calling analyzer for timestamp 1622971670643 ...
2021-06-06 12:27:54,183 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:54,183 - INFO - Finished triggering everything for timestamp 1622971670643 after 3.49 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.38)]
2021-06-06 12:27:54,330 - INFO - User N/A (ecs.amazonaws.com) performed DetachNetworkInterface in us-east-1 at 2021-06-06T09:24:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:47Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:48Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'attachmentId': 'eni-attach-025fdbb263e661b56', 'force': True}, 'responseElements': {'requestId': 'a231c97b-cd34-40ad-a212-fe680ebc06f6', '_return': True}, 'requestID': 'a231c97b-cd34-40ad-a212-fe680ebc06f6', 'eventID': '6c929b3f-f635-4ce1-9606-7eb5662e7874', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:54,330 - INFO - hard-modify network_interface - 
2021-06-06 12:27:54,352 - INFO - Got 0 inventory resources for type network_interface and attributes [{'key': 'AttachmentId', 'value': '^eni-attach-025fdbb263e661b56$'}]
2021-06-06 12:27:54,352 - WARNING - nothing to scan for dependent scan {'resource': 'network_interface', 'depends_on': [{'resource': 'network_interface', 'attr': 'NetworkInterfaceId', 'inventory_attr': 'AttachmentId', 'attr_location': ['requestParameters', 'attachmentId']}]}
2021-06-06 12:27:54,378 - INFO - Get previous translated snapshot with timestamp 1622971670643 took 0.03 seconds
2021-06-06 12:27:54,381 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971670643}
2021-06-06 12:27:54,542 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:51.402Z, account_id: N/A, extra:{'instance-id': 'i-01ebe8c99f478ce58', 'state': 'terminated'}
2021-06-06 12:27:54,735 - INFO - Ignoring failed event - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:24:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PWKCFXY3QR:i-0de0fd033ca956c3f', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PTWJOV2HX', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PWKCFXY3QR', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:07:40Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:24:48Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '52.91.254.137', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'errorCode': 'AccessDenied', 'errorMessage': 'User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'requestParameters': None, 'responseElements': None, 'requestID': '37986378-2343-43b4-a580-a3b57608d91c', 'eventID': '14f50d95-22cf-4d76-ae93-bad67fb12fce', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: AccessDenied, message: User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster)
2021-06-06 12:27:56,459 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpcEndpoints in us-east-1 at 2021-06-06T09:23:52Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:52Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpcEndpoints', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'DeleteVpcEndpointsRequest': {'VpcEndpointId': {'tag': 1, 'content': 'vpce-0771eec70504795e8'}}}, 'responseElements': {'DeleteVpcEndpointsResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': '5b749833-7b72-4938-8b89-7ebfbb3b362c', 'unsuccessful': ''}}, 'requestID': '5b749833-7b72-4938-8b89-7ebfbb3b362c', 'eventID': '3d151613-44ec-48de-832e-f37c77eacda8', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:27:56,459 - INFO - delete vpc_endpoint - ['vpce-0771eec70504795e8']
2021-06-06 12:27:56,490 - INFO - Get previous translated snapshot with timestamp 1622971670643 took 0.03 seconds
2021-06-06 12:27:56,496 - WARNING - didn't find resource network_interface with Description value of VPC Endpoint Interface vpce-0771eec70504795e8 to delete
2021-06-06 12:27:56,496 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'vpc_endpoint': [{'NetworkInterfaceIds': '', 'RouteTableIds': ['rtb-0674b00afe56d1ab8'], 'ServiceName': 'com.amazonaws.us-east-1.s3', 'VpcEndpointId': 'vpce-0771eec70504795e8', 'VpcEndpointType': 'Gateway', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'vpce-0771eec70504795e8', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_s3', 'resource_id': 'vpce-0771eec70504795e8..Name'}]}]}}}, 'previous_timestamp': 1622971670643}
2021-06-06 12:27:56,549 - INFO - Calling modeler on-new-snapshot for timestamp 1622971676460 ...
2021-06-06 12:27:56,581 - INFO - Calling analyzer for timestamp 1622971676460 ...
2021-06-06 12:27:59,824 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:27:59,825 - INFO - Finished triggering everything for timestamp 1622971676460 after 3.33 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.03), ('analyzer', 3.21)]
2021-06-06 12:28:00,064 - INFO - Ignoring failed event - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:23:54Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:23:54Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:23:54Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'errorCode': 'Client.InvalidParameterValue', 'errorMessage': "Network interface 'eni-0dae474beda0eb01e' is currently in use.", 'requestParameters': {'networkInterfaceId': 'eni-0dae474beda0eb01e'}, 'responseElements': None, 'requestID': 'b965d234-039e-4d7b-90bd-2316182839d2', 'eventID': 'e12923c9-9060-4d2f-8777-186dee15e7d7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: Client.InvalidParameterValue, message: Network interface 'eni-0dae474beda0eb01e' is currently in use.)
2021-06-06 12:28:00,205 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteQueue in us-east-1 at 2021-06-06T09:23:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:48Z', 'eventSource': 'sqs.amazonaws.com', 'eventName': 'DeleteQueue', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'queueUrl': 'https://sqs.us-east-1.amazonaws.com/139614369439/test_sqs'}, 'responseElements': None, 'requestID': '1483ad4f-db3a-51de-b086-f4794d5e3083', 'eventID': '8c2c0291-01ed-4a81-9e7a-7da3c2a856d9', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:00,205 - INFO - delete sqs - ['https://sqs.us-east-1.amazonaws.com/139614369439/test_sqs']
2021-06-06 12:28:00,236 - INFO - Get previous translated snapshot with timestamp 1622971676460 took 0.03 seconds
2021-06-06 12:28:00,240 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'sqs': [{'QueueName': 'test_sqs', 'QueueUrl': 'https://sqs.us-east-1.amazonaws.com/139614369439/test_sqs', 'resource_id': 'https://sqs.us-east-1.amazonaws.com/139614369439/test_sqs'}]}}}, 'previous_timestamp': 1622971676460}
2021-06-06 12:28:00,295 - INFO - Calling modeler on-new-snapshot for timestamp 1622971680205 ...
2021-06-06 12:28:00,318 - INFO - Calling analyzer for timestamp 1622971680205 ...
2021-06-06 12:28:04,769 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:04,769 - INFO - Finished triggering everything for timestamp 1622971680205 after 4.52 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('modeler', 0.02), ('analyzer', 4.43)]
2021-06-06 12:28:04,918 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:04.831Z, account_id: N/A, extra:{'attachments': [], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:08:32.833Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c/10013233-aa14-4e87-815b-06230fe6c03a', 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': 'a2f527ca96f216d9ffc19d04e9b9fe7c2c466a5cfbf1ac383ca8a6ffa1448fd3', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'networkInterfaces': [], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:08:32.833Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'DEPROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'pullStartedAt': '2021-06-06T09:08:51.298Z', 'pullStoppedAt': '2021-06-06T09:08:56.298Z', 'startedAt': '2021-06-06T09:08:57.298Z', 'startedBy': 'ecs-svc/3384641070202511327', 'stoppingAt': '2021-06-06T09:24:04.374Z', 'stoppedReason': 'Host EC2 (instance i-09e2d3e3d9fdb48cf) terminated.', 'stopCode': 'TerminationNotice', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:24:04.374Z', 'version': 4}
2021-06-06 12:28:06,195 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:04.867Z, account_id: N/A, extra:{'agentConnected': False, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'ec2InstanceId': 'i-09e2d3e3d9fdb48cf', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'INACTIVE', 'version': 10, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:04.373Z', 'registeredAt': '2021-06-06T09:08:26.326Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:28:06,399 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:02Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-09e2d3e3d9fdb48cf'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-09e2d3e3d9fdb48cf', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '4a3e3281-0e37-4dc6-afeb-20191827a7e4', 'eventID': '7d67048d-f1f7-426b-afe5-70c6edc1b158', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:06,399 - INFO - delete instance - ['i-09e2d3e3d9fdb48cf']
2021-06-06 12:28:06,431 - INFO - Get previous translated snapshot with timestamp 1622971680205 took 0.03 seconds
2021-06-06 12:28:06,437 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-09e2d3e3d9fdb48cf', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.3.178', 'PublicDnsName': 'ec2-3-86-243-83.compute-1.amazonaws.com', 'PublicIpAddress': '3.86.243.83', 'SourceDestCheck': True, 'State': 'running', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-09e2d3e3d9fdb48cf', 'tag': [{'Key': 'Name', 'Value': 'test-instance_ecs', 'resource_id': 'i-09e2d3e3d9fdb48cf..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-08e4d3d8fc621348d', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-172-31-3-178.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-09e2d3e3d9fdb48cf', 'InterfaceType': 'interface', 'MacAddress': '12:17:cc:8d:f9:5b', 'NetworkInterfaceId': 'eni-0740711902692c579', 'PrivateIpAddress': '172.31.3.178', 'PublicDnsName': 'ec2-3-86-243-83.compute-1.amazonaws.com', 'PublicIpAddress': '3.86.243.83', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0740711902692c579', 'PrivateIpAddress': '172.31.3.178', 'resource_id': 'eni-0740711902692c579..172.31.3.178'}], 'resource_id': 'eni-0740711902692c579'}]}}}, 'previous_timestamp': 1622971680205}
2021-06-06 12:28:06,503 - INFO - Calling modeler on-new-snapshot for timestamp 1622971686400 ...
2021-06-06 12:28:06,604 - INFO - Calling analyzer for timestamp 1622971686400 ...
2021-06-06 12:28:11,420 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:11,420 - INFO - Finished triggering everything for timestamp 1622971686400 after 4.99 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.1), ('analyzer', 4.8)]
2021-06-06 12:28:11,635 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:24:12Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:12Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-036266a196e3f9d88', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '5f66f69f-4393-4fdc-9bf8-57d07958c6b8', '_return': True}, 'requestID': '5f66f69f-4393-4fdc-9bf8-57d07958c6b8', 'eventID': '6b7ca912-9d83-4382-9d2a-4febc7576105', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:11,636 - INFO - modify instance - [{'InstanceId': 'i-036266a196e3f9d88', 'resource_id': 'i-036266a196e3f9d88'}]
2021-06-06 12:28:11,657 - INFO - Get previous translated snapshot with timestamp 1622971686400 took 0.02 seconds
2021-06-06 12:28:11,660 - INFO - sub-event will be discarded because no change in resource configuration: {'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-036266a196e3f9d88', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.10.10.230', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'i-036266a196e3f9d88', 'tag': [{'Key': 'Name', 'Value': 'test-instance_1', 'resource_id': 'i-036266a196e3f9d88..Name'}]} 
2021-06-06 12:28:11,661 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971686400}
2021-06-06 12:28:11,815 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:30.036Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'route-table', 'version': 2.0, 'tags': {}}
2021-06-06 12:28:16,641 - INFO - User N/A (rds.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:29Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PVTMOOHZ6U:SLRManagement', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForRDS/SLRManagement', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PVTMOOHZ6U', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/rds.amazonaws.com/AWSServiceRoleForRDS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForRDS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:29Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'rds.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:29Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'rds.amazonaws.com', 'userAgent': 'rds.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-01d1dffd1267ff0ea'}, 'responseElements': {'requestId': '9affac4a-6dd6-41ce-b592-cdad6dd5329d', '_return': True}, 'requestID': '9affac4a-6dd6-41ce-b592-cdad6dd5329d', 'eventID': '0e7a2d21-5f0d-4df2-bf18-8ee5b77fe9e2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:16,642 - INFO - delete network_interface - ['eni-01d1dffd1267ff0ea']
2021-06-06 12:28:16,668 - INFO - Get previous translated snapshot with timestamp 1622971686400 took 0.02 seconds
2021-06-06 12:28:16,671 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'eni-attach-02c65dc44bac049ec', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1c', 'Description': 'RDSNetworkInterface', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-80-225.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InterfaceType': 'interface', 'MacAddress': '0e:ab:f7:1e:a5:f7', 'NetworkInterfaceId': 'eni-01d1dffd1267ff0ea', 'PrivateIpAddress': '10.10.80.225', 'SourceDestCheck': True, 'SubnetId': 'subnet-0427564926cbfc43f', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-01d1dffd1267ff0ea', 'PrivateIpAddress': '10.10.80.225', 'resource_id': 'eni-01d1dffd1267ff0ea..10.10.80.225'}], 'resource_id': 'eni-01d1dffd1267ff0ea'}]}}}, 'previous_timestamp': 1622971686400}
2021-06-06 12:28:16,731 - INFO - Calling modeler on-new-snapshot for timestamp 1622971696644 ...
2021-06-06 12:28:16,769 - INFO - Calling analyzer for timestamp 1622971696644 ...
2021-06-06 12:28:20,210 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:20,210 - INFO - Finished triggering everything for timestamp 1622971696644 after 3.55 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.04), ('analyzer', 3.42)]
2021-06-06 12:28:20,364 - INFO - User N/A (ecs.amazonaws.com) performed CreateNetworkInterface in us-east-1 at 2021-06-06T09:24:32Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:31Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:32Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'CreateNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'subnetId': 'subnet-0e7e54192b01b1ed0', 'description': 'arn:aws:ecs:us-east-1:139614369439:attachment/de002c3f-dae2-44ed-a079-6a05cda8e208', 'groupSet': {}, 'privateIpAddressesSet': {}}, 'responseElements': {'requestId': 'a148a9fc-0def-4593-a580-43cf88fc2062', 'networkInterface': {'networkInterfaceId': 'eni-03cb776612d14e182', 'subnetId': 'subnet-0e7e54192b01b1ed0', 'vpcId': 'vpc-3a02dc47', 'availabilityZone': 'us-east-1a', 'description': 'arn:aws:ecs:us-east-1:139614369439:attachment/de002c3f-dae2-44ed-a079-6a05cda8e208', 'ownerId': '139614369439', 'requesterId': '578734482556', 'requesterManaged': True, 'status': 'pending', 'macAddress': '12:e9:e3:cc:21:5f', 'privateIpAddress': '172.31.7.163', 'privateDnsName': 'ip-172-31-7-163.ec2.internal', 'sourceDestCheck': True, 'interfaceType': 'interface', 'groupSet': {'items': [{'groupId': 'sg-fee06cc9', 'groupName': 'default'}]}, 'privateIpAddressesSet': {'item': [{'privateIpAddress': '172.31.7.163', 'privateDnsName': 'ip-172-31-7-163.ec2.internal', 'primary': True}]}, 'ipv6AddressesSet': {}, 'tagSet': {}}}, 'requestID': 'a148a9fc-0def-4593-a580-43cf88fc2062', 'eventID': '6335e127-d05f-4f98-9619-1cdc847b3193', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:20,365 - INFO - create network_interface - [{'NetworkInterfaceId': 'eni-03cb776612d14e182', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.7.163', 'MacAddress': '12:e9:e3:cc:21:5f', 'GroupId': ['sg-fee06cc9'], 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/de002c3f-dae2-44ed-a079-6a05cda8e208', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-03cb776612d14e182'}]
2021-06-06 12:28:20,365 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03cb776612d14e182']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:28:24,069 - INFO - scanned resources: {}
2021-06-06 12:28:24,069 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03cb776612d14e182']}], 'retry': {'times': 5, 'sleep_interval': 500, 'data_to_check': ['NetworkInterfaces..*', 'NetworkInterfaceId']}}}}
2021-06-06 12:28:24,106 - INFO - Get previous translated snapshot with timestamp 1622971696644 took 0.04 seconds
2021-06-06 12:28:24,109 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {'network_interface': [{'NetworkInterfaceId': 'eni-03cb776612d14e182', 'VpcId': 'vpc-3a02dc47', 'AvailabilityZone': 'us-east-1a', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'PrivateIpAddress': '172.31.7.163', 'MacAddress': '12:e9:e3:cc:21:5f', 'GroupId': ['sg-fee06cc9'], 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/de002c3f-dae2-44ed-a079-6a05cda8e208', 'SourceDestCheck': True, 'InterfaceType': 'interface', 'resource_id': 'eni-03cb776612d14e182'}]}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971696644}
2021-06-06 12:28:24,167 - INFO - Calling modeler on-new-snapshot for timestamp 1622971704070 ...
2021-06-06 12:28:24,600 - INFO - Calling analyzer for timestamp 1622971704070 ...
2021-06-06 12:28:29,004 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:29,004 - INFO - Finished triggering everything for timestamp 1622971704070 after 4.89 seconds! times: [('store_sub_events', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('modeler', 0.43), ('analyzer', 4.38)]
2021-06-06 12:28:29,005 - INFO - Missing resource id eni-03cb776612d14e182 from previous event got added, retrying failed event (retry num 1) ...
2021-06-06 12:28:29,005 - INFO - User N/A (ecs.amazonaws.com) performed AttachNetworkInterface in us-east-1 at 2021-06-06T09:24:33Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:31Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:33Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'AttachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-03cb776612d14e182', 'instanceId': 'i-0de0fd033ca956c3f', 'deviceIndex': 1}, 'responseElements': {'requestId': '9b2daadd-6f74-4ca2-9616-0e33456cd9aa', 'attachmentId': 'eni-attach-025fdbb263e661b56'}, 'requestID': '9b2daadd-6f74-4ca2-9616-0e33456cd9aa', 'eventID': '0bd8f19d-4eeb-408e-a875-efd67148867d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:29,005 - INFO - modify network_interface - [{'NetworkInterfaceId': 'eni-03cb776612d14e182', 'InstanceId': 'i-0de0fd033ca956c3f', 'resource_id': 'eni-03cb776612d14e182'}]
2021-06-06 12:28:29,005 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03cb776612d14e182']}]}}}
2021-06-06 12:28:30,428 - INFO - scanned resources: {}
2021-06-06 12:28:30,428 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-03cb776612d14e182']}]}}}
2021-06-06 12:28:30,467 - INFO - Get previous translated snapshot with timestamp 1622971704070 took 0.04 seconds
2021-06-06 12:28:30,471 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'network_interface': [{'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/de002c3f-dae2-44ed-a079-6a05cda8e208', 'GroupId': ['sg-fee06cc9'], 'InterfaceType': 'interface', 'MacAddress': '12:e9:e3:cc:21:5f', 'NetworkInterfaceId': 'eni-03cb776612d14e182', 'PrivateIpAddress': '172.31.7.163', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'eni-03cb776612d14e182', 'InstanceId': 'i-0de0fd033ca956c3f'}]}, 'deleted': {}}}, 'previous_timestamp': 1622971704070}
2021-06-06 12:28:30,531 - INFO - Calling modeler on-new-snapshot for timestamp 1622971710429 ...
2021-06-06 12:28:31,078 - INFO - Calling analyzer for timestamp 1622971710429 ...
2021-06-06 12:28:34,772 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:34,772 - INFO - Finished triggering everything for timestamp 1622971710429 after 4.30 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.55), ('analyzer', 3.67)]
2021-06-06 12:28:38,135 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:37.618Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:28:38,334 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:24:33Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:33Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0c24281e12e370c44'}, 'responseElements': {'requestId': 'cdc21ef5-ba8f-4999-ac79-ca2ee185e3eb', '_return': True}, 'requestID': 'cdc21ef5-ba8f-4999-ac79-ca2ee185e3eb', 'eventID': 'be7079e8-5ff2-409f-94ad-e71549bacd3a', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:38,335 - INFO - delete subnet - ['subnet-0c24281e12e370c44']
2021-06-06 12:28:38,356 - INFO - Get previous translated snapshot with timestamp 1622971710429 took 0.02 seconds
2021-06-06 12:28:38,361 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1a', 'CidrBlock': '10.10.20.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0c24281e12e370c44', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-0c24281e12e370c44', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_alb_1', 'resource_id': 'subnet-0c24281e12e370c44..Name'}]}]}}}, 'previous_timestamp': 1622971710429}
2021-06-06 12:28:38,413 - INFO - Calling modeler on-new-snapshot for timestamp 1622971718335 ...
2021-06-06 12:28:38,431 - INFO - Calling analyzer for timestamp 1622971718335 ...
2021-06-06 12:28:41,245 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:41,245 - INFO - Finished triggering everything for timestamp 1622971718335 after 2.90 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.8)]
2021-06-06 12:28:41,400 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ReleaseAddress in us-east-1 at 2021-06-06T09:24:37Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:37Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ReleaseAddress', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'allocationId': 'eipalloc-035398b001106e9f9', 'networkBorderGroup': 'us-east-1'}, 'responseElements': {'requestId': 'c0607949-fdb7-4cd6-8c36-2b9f583a8446', '_return': True}, 'requestID': 'c0607949-fdb7-4cd6-8c36-2b9f583a8446', 'eventID': '6c4f95df-4ca3-4878-9229-20a255bb99a3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:41,608 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:43.464Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'elasticloadbalancing', 'resource-type': 'targetgroup', 'version': 1.0, 'tags': {}}
2021-06-06 12:28:41,757 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:47.410Z, account_id: N/A, extra:{'instance-id': 'i-076ebab6280bbba31', 'state': 'shutting-down'}
2021-06-06 12:28:41,917 - INFO - User N/A (ecs.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:04Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:56Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-06f56ed6ae2441c1a'}, 'responseElements': {'requestId': '9f46fdb9-4287-4136-a2fe-0ad2bf3084f7', '_return': True}, 'requestID': '9f46fdb9-4287-4136-a2fe-0ad2bf3084f7', 'eventID': '3ec8d81d-1efe-44cd-8be3-01f9c18b4068', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:41,917 - INFO - delete network_interface - ['eni-06f56ed6ae2441c1a']
2021-06-06 12:28:41,943 - INFO - Get previous translated snapshot with timestamp 1622971718335 took 0.03 seconds
2021-06-06 12:28:41,947 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:28:41,947 - WARNING - Failed to handle message: tried to remove an old resource eni-06f56ed6ae2441c1a, but it doesn't exist.
2021-06-06 12:28:41,947 - INFO - adding message to failed events queue for retry
2021-06-06 12:28:42,106 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:02.478Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'internet-gateway', 'version': 4.0, 'tags': {}}
2021-06-06 12:28:42,258 - INFO - Ignoring failed event - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:24:54Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PWKCFXY3QR:i-0de0fd033ca956c3f', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PTWJOV2HX', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PWKCFXY3QR', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:07:40Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:24:54Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '52.91.254.137', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'errorCode': 'AccessDenied', 'errorMessage': 'User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'requestParameters': None, 'responseElements': None, 'requestID': '99f833ce-a5c4-4768-a3c5-bbe52337b404', 'eventID': 'aa83452f-4dac-45a0-8af6-b6f208a0aeef', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: AccessDenied, message: User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster)
2021-06-06 12:28:42,407 - INFO - Ignoring failed event - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:24:51Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PWKCFXY3QR:i-0de0fd033ca956c3f', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PTWJOV2HX', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PWKCFXY3QR', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:07:40Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:24:51Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '52.91.254.137', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'errorCode': 'AccessDenied', 'errorMessage': 'User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'requestParameters': None, 'responseElements': None, 'requestID': 'a26c58af-0048-4162-89b3-538eed92dbb1', 'eventID': '11a393e8-3e7e-483d-ad8f-83318f65e1db', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: AccessDenied, message: User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster)
2021-06-06 12:28:42,566 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeregisterTaskDefinition in us-east-1 at 2021-06-06T09:24:56Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:56Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DeregisterTaskDefinition', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21'}, 'responseElements': {'taskDefinition': {'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'containerDefinitions': [{'name': 'test_ecs_service', 'image': 'httpd:2.4', 'cpu': 256, 'memory': 512, 'portMappings': [{'containerPort': 80, 'hostPort': 80, 'protocol': 'tcp'}], 'essential': True, 'entryPoint': ['sh', '-c'], 'command': ['/bin/sh -c httpd-foreground'], 'environment': [], 'mountPoints': [], 'volumesFrom': []}], 'family': 'test_ecs_task_definition_fargate', 'executionRoleArn': 'arn:aws:iam::139614369439:role/ecsTaskExecutionRole', 'networkMode': 'awsvpc', 'revision': 21, 'volumes': [], 'status': 'INACTIVE', 'requiresAttributes': [{'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'ecs.capability.task-eni'}], 'placementConstraints': [], 'compatibilities': ['EC2', 'FARGATE'], 'requiresCompatibilities': ['FARGATE'], 'cpu': '256', 'memory': '512', 'registeredAt': 'Jun 6, 2021 9:07:03 AM', 'registeredBy': 'arn:aws:iam::139614369439:root'}}, 'requestID': 'bd2e159a-e135-4ec6-bb7a-03ec2c1ab847', 'eventID': '3be1a6ce-8a61-4c0d-af4a-89c93cac5633', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:42,566 - INFO - delete task_definition - ['arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21']
2021-06-06 12:28:42,588 - INFO - Get previous translated snapshot with timestamp 1622971718335 took 0.02 seconds
2021-06-06 12:28:42,592 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'task_definition': [{'container_definition': [{'cpu': 256, 'image': 'httpd:2.4', 'memory': 512, 'name': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21..test_ecs_service'}], 'family': 'test_ecs_task_definition_fargate', 'networkMode': 'awsvpc', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'revision': 21, 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21'}]}}}, 'previous_timestamp': 1622971718335}
2021-06-06 12:28:42,649 - INFO - Calling modeler on-new-snapshot for timestamp 1622971722568 ...
2021-06-06 12:28:42,665 - INFO - Calling analyzer for timestamp 1622971722568 ...
2021-06-06 12:28:45,545 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:45,545 - INFO - Finished triggering everything for timestamp 1622971722568 after 2.97 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.86)]
2021-06-06 12:28:48,027 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:10.832Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'internet-gateway', 'version': 4.0, 'tags': {}}
2021-06-06 12:28:48,178 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:25:14.182Z, account_id: N/A, extra:{'instance-id': 'i-076ebab6280bbba31', 'state': 'terminated'}
2021-06-06 12:28:48,357 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:25:09Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:09Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0754334dae5682f73'}, 'responseElements': {'requestId': 'addddf0c-0c43-4aa9-b03e-d76b7905b8f0', '_return': True}, 'requestID': 'addddf0c-0c43-4aa9-b03e-d76b7905b8f0', 'eventID': '70e0301f-3371-4027-9c62-41dbbdc4c6d6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:48,357 - INFO - delete subnet - ['subnet-0754334dae5682f73']
2021-06-06 12:28:48,388 - INFO - Get previous translated snapshot with timestamp 1622971722568 took 0.03 seconds
2021-06-06 12:28:48,392 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1a', 'CidrBlock': '10.10.60.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0754334dae5682f73', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-0754334dae5682f73', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_glb_1', 'resource_id': 'subnet-0754334dae5682f73..Name'}]}]}}}, 'previous_timestamp': 1622971722568}
2021-06-06 12:28:48,451 - INFO - Calling modeler on-new-snapshot for timestamp 1622971728357 ...
2021-06-06 12:28:48,470 - INFO - Calling analyzer for timestamp 1622971728357 ...
2021-06-06 12:28:52,807 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:52,807 - INFO - Finished triggering everything for timestamp 1622971728357 after 4.43 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 4.32)]
2021-06-06 12:28:53,067 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:17.343Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:28:53,281 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteInternetGateway in us-east-1 at 2021-06-06T09:25:12Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:12Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-06702476ee8952114'}, 'responseElements': {'requestId': '77fdd9ec-be7d-4a3d-9449-9a6f7ce807ee', '_return': True}, 'requestID': '77fdd9ec-be7d-4a3d-9449-9a6f7ce807ee', 'eventID': '49e978c2-7c86-4bab-ab34-159e0c3d23af', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:53,281 - INFO - delete internet_gateway - ['igw-06702476ee8952114']
2021-06-06 12:28:53,304 - INFO - Get previous translated snapshot with timestamp 1622971728357 took 0.02 seconds
2021-06-06 12:28:53,307 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'internet_gateway': [{'InternetGatewayId': 'igw-06702476ee8952114', 'internet_gateway_attachment': [{'InternetGatewayId': 'igw-06702476ee8952114', 'State': 'available', 'VpcId': 'vpc-0073beecbc61fd56a', 'resource_id': 'igw-06702476ee8952114..vpc-0073beecbc61fd56a'}], 'resource_id': 'igw-06702476ee8952114', 'tag': [{'Key': 'Name', 'Value': 'test_gw_nat', 'resource_id': 'igw-06702476ee8952114..Name'}]}]}}}, 'previous_timestamp': 1622971728357}
2021-06-06 12:28:53,370 - INFO - Calling modeler on-new-snapshot for timestamp 1622971733282 ...
2021-06-06 12:28:53,385 - INFO - Calling analyzer for timestamp 1622971733282 ...
2021-06-06 12:28:56,331 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:56,331 - INFO - Finished triggering everything for timestamp 1622971733282 after 3.03 seconds! times: [('store_sub_events', 0.01), ('modeler', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('analyzer', 2.93)]
2021-06-06 12:28:56,558 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:25:14Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:14Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0d3d1a7eb7bc2053f'}, 'responseElements': {'requestId': '63558322-9e3a-4cf9-9734-1ef1a0c5fa28', '_return': True}, 'requestID': '63558322-9e3a-4cf9-9734-1ef1a0c5fa28', 'eventID': '453062dd-bb6e-4f80-be09-5504289f58b7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:56,558 - INFO - delete subnet - ['subnet-0d3d1a7eb7bc2053f']
2021-06-06 12:28:56,582 - INFO - Get previous translated snapshot with timestamp 1622971733282 took 0.02 seconds
2021-06-06 12:28:56,586 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1c', 'CidrBlock': '10.20.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0d3d1a7eb7bc2053f', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'subnet-0d3d1a7eb7bc2053f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_2', 'resource_id': 'subnet-0d3d1a7eb7bc2053f..Name'}]}]}}}, 'previous_timestamp': 1622971733282}
2021-06-06 12:28:56,642 - INFO - Calling modeler on-new-snapshot for timestamp 1622971736558 ...
2021-06-06 12:28:56,662 - INFO - Calling analyzer for timestamp 1622971736558 ...
2021-06-06 12:28:59,705 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:28:59,705 - INFO - Finished triggering everything for timestamp 1622971736558 after 3.12 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 3.02)]
2021-06-06 12:28:59,932 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpc in us-east-1 at 2021-06-06T09:25:15Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:15Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpc', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-00ee3246072e19077'}, 'responseElements': {'requestId': '2886a3cd-97b1-4f69-a5d5-c52ae25b9688', '_return': True}, 'requestID': '2886a3cd-97b1-4f69-a5d5-c52ae25b9688', 'eventID': '6db49bf0-d558-42cd-8c38-78f0750c3bbe', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:28:59,932 - INFO - delete vpc - ['vpc-00ee3246072e19077']
2021-06-06 12:28:59,978 - INFO - Get previous translated snapshot with timestamp 1622971736558 took 0.05 seconds
2021-06-06 12:28:59,998 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_acl': [{'IsDefault': True, 'NetworkAclId': 'acl-03ae48e91818d59ea', 'VpcId': 'vpc-00ee3246072e19077', 'acl_association': [{'AssociationId': 'aclassoc-d67abbf7', 'NetworkAclId': 'acl-03ae48e91818d59ea', 'SubnetId': 'subnet-0d3d1a7eb7bc2053f', 'resource_id': 'acl-03ae48e91818d59ea..aclassoc-d67abbf7'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-03ae48e91818d59ea..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-03ae48e91818d59ea..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-03ae48e91818d59ea..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-03ae48e91818d59ea..32767..False'}], 'resource_id': 'acl-03ae48e91818d59ea'}], 'route_table': [{'RouteTableId': 'rtb-03fcccaea3c63eeb1', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'rtb-03fcccaea3c63eeb1', 'route': [{'DestinationCidrBlock': '10.10.0.0/16', 'Origin': 'CreateRoute', 'State': 'active', 'VpcPeeringConnectionId': 'pcx-004eb005d80c4c983', 'resource_id': 'rtb-03fcccaea3c63eeb1..10.10.0.0/16'}, {'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-03fcccaea3c63eeb1..10.20.0.0/16'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0521e2055e4dcfe4b', 'Main': True, 'RouteTableId': 'rtb-03fcccaea3c63eeb1', 'resource_id': 'rtb-03fcccaea3c63eeb1..rtbassoc-0521e2055e4dcfe4b'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt_2', 'resource_id': 'rtb-03fcccaea3c63eeb1..Name'}]}], 'security_group': [{'GroupId': 'sg-075eaa8e584fb426d', 'GroupName': 'default', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'sg-075eaa8e584fb426d', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-075eaa8e584fb426d..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-075eaa8e584fb426d'], 'resource_id': 'sg-075eaa8e584fb426d..all__ingress_rule'}]}, {'GroupId': 'sg-0ab93aaa7a4f34f49', 'GroupName': 'test_security_group_2', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'sg-0ab93aaa7a4f34f49', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0ab93aaa7a4f34f49..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0ab93aaa7a4f34f49..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_2', 'resource_id': 'sg-0ab93aaa7a4f34f49..Name'}]}], 'vpc': [{'CidrBlock': '10.20.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-00ee3246072e19077', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-0604c13eefef7245f', 'CidrBlock': '10.20.0.0/16', 'VpcId': 'vpc-00ee3246072e19077', 'resource_id': 'vpc-00ee3246072e19077..10.20.0.0/16'}], 'resource_id': 'vpc-00ee3246072e19077', 'tag': [{'Key': 'Name', 'Value': 'test_vpc', 'resource_id': 'vpc-00ee3246072e19077..Name'}]}]}}}, 'previous_timestamp': 1622971736558}
2021-06-06 12:29:00,089 - INFO - Calling modeler on-new-snapshot for timestamp 1622971739932 ...
2021-06-06 12:29:00,153 - INFO - Calling analyzer for timestamp 1622971739932 ...
2021-06-06 12:29:03,378 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:03,378 - INFO - Finished triggering everything for timestamp 1622971739932 after 3.37 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.04), ('modeler', 0.06), ('analyzer', 3.2)]
2021-06-06 12:29:03,534 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:25:36.168Z, account_id: N/A, extra:{'instance-id': 'i-0de0fd033ca956c3f', 'state': 'terminated'}
2021-06-06 12:29:03,713 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:38Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:38Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-04abc10c3b5f8f558'}, 'responseElements': {'requestId': 'cb669ff8-3dea-4d64-80e1-4326008071e3', '_return': True}, 'requestID': 'cb669ff8-3dea-4d64-80e1-4326008071e3', 'eventID': '13e12370-f161-448a-9484-d574f4fbbcef', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:03,713 - INFO - delete network_interface - ['eni-04abc10c3b5f8f558']
2021-06-06 12:29:03,741 - INFO - Get previous translated snapshot with timestamp 1622971739932 took 0.03 seconds
2021-06-06 12:29:03,745 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:29:03,745 - WARNING - Failed to handle message: tried to remove an old resource eni-04abc10c3b5f8f558, but it doesn't exist.
2021-06-06 12:29:03,745 - INFO - adding message to failed events queue for retry
2021-06-06 12:29:03,929 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:41.216Z, account_id: N/A, extra:{'Origin': 'AutoScalingGroup', 'Destination': 'EC2', 'Description': 'Terminating EC2 instance: i-0de0fd033ca956c3f', 'EndTime': '2021-06-06T09:25:40.587Z', 'RequestId': 'f989a025-d4fe-442c-aa77-1c889777b799', 'ActivityId': 'f989a025-d4fe-442c-aa77-1c889777b799', 'StartTime': '2021-06-06T09:24:38.475Z', 'EC2InstanceId': 'i-0de0fd033ca956c3f', 'StatusCode': 'InProgress', 'StatusMessage': '', 'Details': {'Availability Zone': 'us-east-1a'}, 'Cause': 'At 2021-06-06T09:24:18Z a user request update of AutoScalingGroup constraints to min: 0, max: 0, desired: 0 changing the desired capacity from 2 to 0.  At 2021-06-06T09:24:38Z an instance was taken out of service in response to a difference between desired and actual capacity, shrinking the capacity from 2 to 0.  At 2021-06-06T09:24:38Z instance i-0bc9c6152477ce465 was selected for termination.  At 2021-06-06T09:24:38Z instance i-0de0fd033ca956c3f was selected for termination.', 'AutoScalingGroupName': 'test_autoscaling_group'}
2021-06-06 12:29:04,988 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:24:05Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:05Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-07600a9b4869cc2a2', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '93736187-4906-443b-9c7d-e29ec15b3ac8', '_return': True}, 'requestID': '93736187-4906-443b-9c7d-e29ec15b3ac8', 'eventID': '17893523-88e6-4f35-babc-898c46093371', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:04,989 - INFO - modify instance - [{'InstanceId': 'i-07600a9b4869cc2a2', 'resource_id': 'i-07600a9b4869cc2a2'}]
2021-06-06 12:29:05,024 - INFO - Get previous translated snapshot with timestamp 1622971739932 took 0.04 seconds
2021-06-06 12:29:05,033 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:29:05,033 - WARNING - Failed to handle message: tried to modify an old resource i-07600a9b4869cc2a2, but it doesn't exist.
2021-06-06 12:29:05,033 - INFO - adding message to failed events queue for retry
2021-06-06 12:29:05,223 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:13.302Z, account_id: N/A, extra:{'instance-id': 'i-098ca7ae34579341f', 'state': 'terminated'}
2021-06-06 12:29:05,377 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:18.470Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:29:05,531 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:28.567Z, account_id: N/A, extra:{'attachments': [{'id': 'de002c3f-dae2-44ed-a079-6a05cda8e208', 'type': 'eni', 'status': 'PRECREATED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17/5f88ada6-6f0f-4b44-9c4c-e52eb52222e4', 'lastStatus': 'PENDING', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17', 'networkInterfaces': [], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:24:27.599Z', 'desiredStatus': 'RUNNING', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'PROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'startedBy': 'ecs-svc/3384641070202511327', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:24:27.599Z', 'version': 1}
2021-06-06 12:29:05,689 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:35.318Z, account_id: N/A, extra:{'instance-id': 'i-0d9f92ed9e44352fb', 'state': 'terminated'}
2021-06-06 12:29:05,847 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:38.350Z, account_id: N/A, extra:{'agentConnected': False, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'ec2InstanceId': 'i-09e2d3e3d9fdb48cf', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'INACTIVE', 'version': 11, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:04.373Z', 'registeredAt': '2021-06-06T09:08:26.326Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:29:06,015 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:40.108Z, account_id: N/A, extra:{'instance-id': 'i-0de0fd033ca956c3f', 'state': 'shutting-down'}
2021-06-06 12:29:06,169 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:40.862Z, account_id: N/A, extra:{'instance-id': 'i-09e2d3e3d9fdb48cf', 'state': 'terminated'}
2021-06-06 12:29:06,338 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:42.638Z, account_id: N/A, extra:{'instance-id': 'i-036266a196e3f9d88', 'state': 'terminated'}
2021-06-06 12:29:06,493 - INFO - User N/A (autoscaling.amazonaws.com) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PRWAVJLVEN:AutoScaling', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForAutoScaling/AutoScaling', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PRWAVJLVEN', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForAutoScaling'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:39Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'autoscaling.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'autoscaling.amazonaws.com', 'userAgent': 'autoscaling.amazonaws.com', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-0bc9c6152477ce465'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-0bc9c6152477ce465', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '4ed01383-2a3c-4233-a8c5-b99fc8c75189', 'eventID': '92c96b56-9125-4f28-9e6e-f00735564415', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:06,493 - INFO - delete instance - ['i-0bc9c6152477ce465']
2021-06-06 12:29:06,524 - INFO - Get previous translated snapshot with timestamp 1622971739932 took 0.03 seconds
2021-06-06 12:29:06,539 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-0bc9c6152477ce465', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.6.85', 'PublicDnsName': 'ec2-3-84-18-184.compute-1.amazonaws.com', 'PublicIpAddress': '3.84.18.184', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-0bc9c6152477ce465', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0bc9c6152477ce465..aws:autoscaling:groupName'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0c0fda177c90706e3', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/37b6cac5-fc31-463f-89cc-3184f05413d5', 'DeviceIndex': 1, 'DnsName': 'ip-172-31-5-40.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bc9c6152477ce465', 'InterfaceType': 'interface', 'MacAddress': '12:5a:b8:61:34:4f', 'NetworkInterfaceId': 'eni-026ba384964109468', 'PrivateIpAddress': '172.31.5.40', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-026ba384964109468', 'PrivateIpAddress': '172.31.5.40', 'resource_id': 'eni-026ba384964109468..172.31.5.40'}], 'resource_id': 'eni-026ba384964109468'}, {'AttachmentId': 'eni-attach-0d9c65b057652e97f', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-172-31-6-85.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0bc9c6152477ce465', 'InterfaceType': 'interface', 'MacAddress': '12:d4:ff:14:ac:e3', 'NetworkInterfaceId': 'eni-03728b1e44082b46f', 'PrivateIpAddress': '172.31.6.85', 'PublicDnsName': 'ec2-3-84-18-184.compute-1.amazonaws.com', 'PublicIpAddress': '3.84.18.184', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-03728b1e44082b46f', 'PrivateIpAddress': '172.31.6.85', 'resource_id': 'eni-03728b1e44082b46f..172.31.6.85'}], 'resource_id': 'eni-03728b1e44082b46f'}]}}}, 'previous_timestamp': 1622971739932}
2021-06-06 12:29:06,616 - INFO - Calling modeler on-new-snapshot for timestamp 1622971746495 ...
2021-06-06 12:29:06,738 - INFO - Calling analyzer for timestamp 1622971746495 ...
2021-06-06 12:29:12,504 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:12,504 - INFO - Finished triggering everything for timestamp 1622971746495 after 5.95 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.12), ('analyzer', 5.74)]
2021-06-06 12:29:13,540 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:49.458Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:29:13,741 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRouteTable in us-east-1 at 2021-06-06T09:24:48Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:48Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteRouteTable', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-0304b06dc7ba9bb22'}, 'responseElements': {'requestId': '9e3cd9d5-6bce-49d7-a0c7-f795245752e7', '_return': True}, 'requestID': '9e3cd9d5-6bce-49d7-a0c7-f795245752e7', 'eventID': '2a507d26-5292-46e5-ba38-44973299be07', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:13,745 - INFO - delete route_table - ['rtb-0304b06dc7ba9bb22']
2021-06-06 12:29:13,794 - INFO - Get previous translated snapshot with timestamp 1622971746495 took 0.05 seconds
2021-06-06 12:29:13,797 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'route_table': [{'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'rtb-0304b06dc7ba9bb22', 'route': [{'DestinationCidrBlock': '0.0.0.0/0', 'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'resource_id': 'rtb-0304b06dc7ba9bb22..0.0.0.0/0'}], 'route_table_association': [{'AssociationId': 'rtbassoc-00f17634a9c8cce79', 'Main': True, 'RouteTableId': 'rtb-0304b06dc7ba9bb22', 'resource_id': 'rtb-0304b06dc7ba9bb22..rtbassoc-00f17634a9c8cce79'}], 'tag': [{'Key': 'Name', 'Value': 'test_rt', 'resource_id': 'rtb-0304b06dc7ba9bb22..Name'}]}]}}}, 'previous_timestamp': 1622971746495}
2021-06-06 12:29:13,852 - INFO - Calling modeler on-new-snapshot for timestamp 1622971753746 ...
2021-06-06 12:29:13,870 - INFO - Calling analyzer for timestamp 1622971753746 ...
2021-06-06 12:29:18,511 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:18,511 - INFO - Finished triggering everything for timestamp 1622971753746 after 4.72 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 4.62)]
2021-06-06 12:29:18,749 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:52Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:52Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:52Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-0a4442e92b841a8ca'}, 'responseElements': {'requestId': '79d56e78-8ef5-4c9b-8014-2fddc1f7f5fc', '_return': True}, 'requestID': '79d56e78-8ef5-4c9b-8014-2fddc1f7f5fc', 'eventID': '691508f0-7dd9-436f-8a63-522e829d7585', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:18,749 - INFO - delete network_interface - ['eni-0a4442e92b841a8ca']
2021-06-06 12:29:18,796 - INFO - Get previous translated snapshot with timestamp 1622971753746 took 0.05 seconds
2021-06-06 12:29:18,800 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-0dc81f1bdff6a5691', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'ELB gwy/test-glb/53d838234c69cdf6', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-60-231.ec2.internal', 'GroupId': [], 'InterfaceType': 'gateway_load_balancer', 'MacAddress': '12:33:81:89:ab:39', 'NetworkInterfaceId': 'eni-0a4442e92b841a8ca', 'PrivateIpAddress': '10.10.60.231', 'SourceDestCheck': False, 'SubnetId': 'subnet-0754334dae5682f73', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0a4442e92b841a8ca', 'PrivateIpAddress': '10.10.60.231', 'resource_id': 'eni-0a4442e92b841a8ca..10.10.60.231'}], 'resource_id': 'eni-0a4442e92b841a8ca'}]}}}, 'previous_timestamp': 1622971753746}
2021-06-06 12:29:18,861 - INFO - Calling modeler on-new-snapshot for timestamp 1622971758749 ...
2021-06-06 12:29:18,888 - INFO - Calling analyzer for timestamp 1622971758749 ...
2021-06-06 12:29:22,170 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:22,170 - INFO - Finished triggering everything for timestamp 1622971758749 after 3.38 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.26)]
2021-06-06 12:29:22,322 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:59.395Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'ecs', 'resource-type': 'task-definition', 'version': 1.0, 'tags': {}}
2021-06-06 12:29:22,477 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:01.189Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:29:22,631 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteInternetGateway in us-east-1 at 2021-06-06T09:25:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:00Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-03414e5caa8b42cbd'}, 'responseElements': {'requestId': 'f0261488-53f6-4fec-b6a8-c4f802353bd9', '_return': True}, 'requestID': 'f0261488-53f6-4fec-b6a8-c4f802353bd9', 'eventID': 'e3e709de-baff-4b48-a3c9-1deff519acb3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:22,631 - INFO - delete internet_gateway - ['igw-03414e5caa8b42cbd']
2021-06-06 12:29:22,666 - INFO - Get previous translated snapshot with timestamp 1622971758749 took 0.04 seconds
2021-06-06 12:29:22,669 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'internet_gateway': [{'InternetGatewayId': 'igw-03414e5caa8b42cbd', 'internet_gateway_attachment': [{'InternetGatewayId': 'igw-03414e5caa8b42cbd', 'State': 'available', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'igw-03414e5caa8b42cbd..vpc-05c66fc27c8de6f73'}], 'resource_id': 'igw-03414e5caa8b42cbd', 'tag': [{'Key': 'Name', 'Value': 'test_gw', 'resource_id': 'igw-03414e5caa8b42cbd..Name'}]}]}}}, 'previous_timestamp': 1622971758749}
2021-06-06 12:29:22,728 - INFO - Calling modeler on-new-snapshot for timestamp 1622971762631 ...
2021-06-06 12:29:22,743 - INFO - Calling analyzer for timestamp 1622971762631 ...
2021-06-06 12:29:26,105 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:26,105 - INFO - Finished triggering everything for timestamp 1622971762631 after 3.45 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 3.34)]
2021-06-06 12:29:26,269 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:02Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:02Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-084ffd9aa0295b237'}, 'responseElements': {'requestId': '8d43b693-86d4-46e7-aa76-f13001f9ff97', '_return': True}, 'requestID': '8d43b693-86d4-46e7-aa76-f13001f9ff97', 'eventID': '3e261b5e-742c-468a-af6e-d65f7434d7d4', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:26,270 - INFO - delete network_interface - ['eni-084ffd9aa0295b237']
2021-06-06 12:29:26,297 - INFO - Get previous translated snapshot with timestamp 1622971762631 took 0.03 seconds
2021-06-06 12:29:26,300 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:29:26,300 - WARNING - Failed to handle message: tried to remove an old resource eni-084ffd9aa0295b237, but it doesn't exist.
2021-06-06 12:29:26,300 - INFO - adding message to failed events queue for retry
2021-06-06 12:29:26,453 - INFO - Ignoring failed event - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:24:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PWKCFXY3QR:i-0de0fd033ca956c3f', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PTWJOV2HX', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PWKCFXY3QR', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:07:40Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:24:46Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '52.91.254.137', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'errorCode': 'AccessDenied', 'errorMessage': 'User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'requestParameters': None, 'responseElements': None, 'requestID': '7cc0eb0c-e99c-4fc9-b6c5-7a023c2e00db', 'eventID': 'd74a6692-efa8-4290-ad60-e3c0e4726312', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: AccessDenied, message: User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster)
2021-06-06 12:29:26,606 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpcPeeringConnection in us-east-1 at 2021-06-06T09:25:04Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:04Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpcPeeringConnection', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcPeeringConnectionId': 'pcx-004eb005d80c4c983'}, 'responseElements': {'requestId': '2179baf3-9017-42a3-a8b8-f37e88507fea', '_return': True}, 'requestID': '2179baf3-9017-42a3-a8b8-f37e88507fea', 'eventID': '8653ba1a-629a-470b-8777-ee0150c9e3fb', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:26,607 - INFO - delete vpc_peering_connection - ['pcx-004eb005d80c4c983']
2021-06-06 12:29:26,631 - INFO - Get previous translated snapshot with timestamp 1622971762631 took 0.02 seconds
2021-06-06 12:29:26,635 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'vpc_peering_connection': [{'AccepterCidrBlock': '10.20.0.0/16', 'AccepterOwnerId': '139614369439', 'AccepterRegion': 'us-east-1', 'AccepterVpcId': 'vpc-00ee3246072e19077', 'RequesterCidrBlock': '10.10.0.0/16', 'RequesterOwnerId': '139614369439', 'RequesterRegion': 'us-east-1', 'RequesterVpcId': 'vpc-05c66fc27c8de6f73', 'Status': 'provisioning', 'VpcPeeringConnectionId': 'pcx-004eb005d80c4c983', 'resource_id': 'pcx-004eb005d80c4c983', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_peering', 'resource_id': 'pcx-004eb005d80c4c983..Name'}]}]}}}, 'previous_timestamp': 1622971762631}
2021-06-06 12:29:26,706 - INFO - Calling modeler on-new-snapshot for timestamp 1622971766608 ...
2021-06-06 12:29:26,724 - INFO - Calling analyzer for timestamp 1622971766608 ...
2021-06-06 12:29:29,815 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:29,815 - INFO - Finished triggering everything for timestamp 1622971766608 after 3.18 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 3.07)]
2021-06-06 12:29:30,011 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:25:09.137Z, account_id: N/A, extra:{'instance-id': 'i-0167013933823206a', 'state': 'terminated'}
2021-06-06 12:29:30,620 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeregisterTaskDefinition in us-east-1 at 2021-06-06T09:25:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:53Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DeregisterTaskDefinition', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, 'responseElements': {'taskDefinition': {'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'containerDefinitions': [{'name': 'test_ecs_service', 'image': 'httpd:2.4', 'cpu': 256, 'memory': 512, 'portMappings': [{'containerPort': 80, 'hostPort': 80, 'protocol': 'tcp'}], 'essential': True, 'entryPoint': ['sh', '-c'], 'command': ['/bin/sh -c httpd-foreground'], 'environment': [], 'mountPoints': [], 'volumesFrom': []}], 'family': 'test_ecs_task_definition', 'executionRoleArn': 'arn:aws:iam::139614369439:role/ecsTaskExecutionRole', 'networkMode': 'awsvpc', 'revision': 273, 'volumes': [], 'status': 'INACTIVE', 'requiresAttributes': [{'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'ecs.capability.task-eni'}], 'placementConstraints': [], 'compatibilities': ['EC2', 'FARGATE'], 'requiresCompatibilities': ['EC2'], 'cpu': '256', 'memory': '512', 'registeredAt': 'Jun 6, 2021 9:07:03 AM', 'registeredBy': 'arn:aws:iam::139614369439:root'}}, 'requestID': 'a351cd41-e12f-443a-bfa7-10d71f8f4c7d', 'eventID': 'ae1dfa8c-187b-4c16-8a3a-10352a7db05b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:30,620 - INFO - delete task_definition - ['arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273']
2021-06-06 12:29:30,654 - INFO - Get previous translated snapshot with timestamp 1622971766608 took 0.03 seconds
2021-06-06 12:29:30,657 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'task_definition': [{'container_definition': [{'cpu': 256, 'image': 'httpd:2.4', 'memory': 512, 'name': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273..test_ecs_service'}], 'family': 'test_ecs_task_definition', 'networkMode': 'awsvpc', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'revision': 273, 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}]}}}, 'previous_timestamp': 1622971766608}
2021-06-06 12:29:30,709 - INFO - Calling modeler on-new-snapshot for timestamp 1622971770620 ...
2021-06-06 12:29:30,727 - INFO - Calling analyzer for timestamp 1622971770620 ...
2021-06-06 12:29:33,847 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:33,848 - INFO - Finished triggering everything for timestamp 1622971770620 after 3.20 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('set_complete', 0.02), ('validate_timestamp', 0.02), ('analyzer', 3.08)]
2021-06-06 12:29:34,108 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:26:32.165Z, account_id: N/A, extra:{'instance-id': 'i-07600a9b4869cc2a2', 'state': 'terminated'}
2021-06-06 12:29:34,275 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:45.249Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'security-group', 'version': 4.0, 'tags': {}}
2021-06-06 12:29:35,989 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:26:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:41Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0f126dcb2bfa10c61'}, 'responseElements': {'requestId': '15e2a06f-7912-4114-88d5-d105cce86e67', '_return': True}, 'requestID': '15e2a06f-7912-4114-88d5-d105cce86e67', 'eventID': '6c230e27-db14-42b0-8aa6-83517f3ed716', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:35,990 - INFO - delete subnet - ['subnet-0f126dcb2bfa10c61']
2021-06-06 12:29:36,024 - INFO - Get previous translated snapshot with timestamp 1622971770620 took 0.03 seconds
2021-06-06 12:29:36,027 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1b', 'CidrBlock': '10.20.110.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'subnet-0f126dcb2bfa10c61', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_vpce_2', 'resource_id': 'subnet-0f126dcb2bfa10c61..Name'}]}]}}}, 'previous_timestamp': 1622971770620}
2021-06-06 12:29:36,081 - INFO - Calling modeler on-new-snapshot for timestamp 1622971775992 ...
2021-06-06 12:29:36,102 - INFO - Calling analyzer for timestamp 1622971775992 ...
2021-06-06 12:29:39,185 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:39,185 - INFO - Finished triggering everything for timestamp 1622971775992 after 3.15 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('modeler', 0.02), ('analyzer', 3.06)]
2021-06-06 12:29:39,428 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:26:42Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:42Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-021a1875159060d7b'}, 'responseElements': {'requestId': '165d4da8-2eb7-4ab2-a5e3-1642a8653bd8', '_return': True}, 'requestID': '165d4da8-2eb7-4ab2-a5e3-1642a8653bd8', 'eventID': '51eba444-82be-4925-813b-52d21c908833', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:39,428 - INFO - delete subnet - ['subnet-021a1875159060d7b']
2021-06-06 12:29:39,471 - INFO - Get previous translated snapshot with timestamp 1622971775992 took 0.04 seconds
2021-06-06 12:29:39,475 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1d', 'CidrBlock': '10.10.90.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-021a1875159060d7b', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-021a1875159060d7b', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_rds_2', 'resource_id': 'subnet-021a1875159060d7b..Name'}]}]}}}, 'previous_timestamp': 1622971775992}
2021-06-06 12:29:39,532 - INFO - Calling modeler on-new-snapshot for timestamp 1622971779428 ...
2021-06-06 12:29:39,550 - INFO - Calling analyzer for timestamp 1622971779428 ...
2021-06-06 12:29:42,459 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:42,459 - INFO - Finished triggering everything for timestamp 1622971779428 after 3.00 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.89)]
2021-06-06 12:29:42,705 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpc in us-east-1 at 2021-06-06T09:26:43Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:43Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpc', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-05c66fc27c8de6f73'}, 'responseElements': {'requestId': '9ba87e6a-7446-4d51-8302-64e5427ade18', '_return': True}, 'requestID': '9ba87e6a-7446-4d51-8302-64e5427ade18', 'eventID': '3b4449ce-0bf2-4f39-9f0c-cadb451e9e5a', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:42,705 - INFO - delete vpc - ['vpc-05c66fc27c8de6f73']
2021-06-06 12:29:42,735 - INFO - Get previous translated snapshot with timestamp 1622971779428 took 0.03 seconds
2021-06-06 12:29:42,747 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_acl': [{'IsDefault': True, 'NetworkAclId': 'acl-0d9395481eac628f6', 'VpcId': 'vpc-05c66fc27c8de6f73', 'acl_association': [{'AssociationId': 'aclassoc-c61bdae7', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-0c24281e12e370c44', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-c61bdae7'}, {'AssociationId': 'aclassoc-c21fdee3', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-080bf67267388f92d', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-c21fdee3'}, {'AssociationId': 'aclassoc-3227e613', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-0427564926cbfc43f', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-3227e613'}, {'AssociationId': 'aclassoc-922feeb3', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-021a1875159060d7b', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-922feeb3'}, {'AssociationId': 'aclassoc-d55c9df4', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-0627eacfcbd2561b0', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-d55c9df4'}, {'AssociationId': 'aclassoc-7a0dcc5b', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-098c87b4a9a29cc5f', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-7a0dcc5b'}, {'AssociationId': 'aclassoc-7fb0705e', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-01c70bc44616f42d1', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-7fb0705e'}, {'AssociationId': 'aclassoc-8d12d3ac', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-0754334dae5682f73', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-8d12d3ac'}, {'AssociationId': 'aclassoc-f61adbd7', 'NetworkAclId': 'acl-0d9395481eac628f6', 'SubnetId': 'subnet-0a4f64f15f34bcc51', 'resource_id': 'acl-0d9395481eac628f6..aclassoc-f61adbd7'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0d9395481eac628f6..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0d9395481eac628f6..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0d9395481eac628f6..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0d9395481eac628f6..32767..False'}], 'resource_id': 'acl-0d9395481eac628f6'}], 'security_group': [{'GroupId': 'sg-05b2444258fd184e1', 'GroupName': 'default', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'sg-05b2444258fd184e1', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-05b2444258fd184e1..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-05b2444258fd184e1'], 'resource_id': 'sg-05b2444258fd184e1..all__ingress_rule'}]}, {'GroupId': 'sg-0aa68cd0fc33a9815', 'GroupName': 'test_security_group', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'sg-0aa68cd0fc33a9815', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0aa68cd0fc33a9815..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0aa68cd0fc33a9815..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group', 'resource_id': 'sg-0aa68cd0fc33a9815..Name'}]}], 'vpc': [{'CidrBlock': '10.10.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-05c66fc27c8de6f73', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-0f7b650b32092cbea', 'CidrBlock': '10.10.0.0/16', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'vpc-05c66fc27c8de6f73..10.10.0.0/16'}], 'resource_id': 'vpc-05c66fc27c8de6f73', 'tag': [{'Key': 'Name', 'Value': 'main', 'resource_id': 'vpc-05c66fc27c8de6f73..Name'}]}]}}}, 'previous_timestamp': 1622971779428}
2021-06-06 12:29:42,828 - INFO - Calling modeler on-new-snapshot for timestamp 1622971782705 ...
2021-06-06 12:29:42,876 - INFO - Calling analyzer for timestamp 1622971782705 ...
2021-06-06 12:29:46,188 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:46,189 - INFO - Finished triggering everything for timestamp 1622971782705 after 3.44 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.03), ('modeler', 0.05), ('analyzer', 3.29)]
2021-06-06 12:29:47,512 - INFO - User N/A (autoscaling.amazonaws.com) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PRWAVJLVEN:AutoScaling', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForAutoScaling/AutoScaling', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PRWAVJLVEN', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForAutoScaling'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:39Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'autoscaling.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'autoscaling.amazonaws.com', 'userAgent': 'autoscaling.amazonaws.com', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-0de0fd033ca956c3f'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-0de0fd033ca956c3f', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '635cc5e7-4152-4b27-b7fd-8dbcebde77c5', 'eventID': '100d644e-16a7-4b95-bfc2-72f96861cf9a', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:47,512 - INFO - delete instance - ['i-0de0fd033ca956c3f']
2021-06-06 12:29:47,539 - INFO - Get previous translated snapshot with timestamp 1622971782705 took 0.03 seconds
2021-06-06 12:29:47,543 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-0f06fc190dd71269e', 'InstanceId': 'i-0de0fd033ca956c3f', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'InstanceType': 't2.micro', 'PrivateIpAddress': '172.31.13.240', 'PublicDnsName': 'ec2-52-91-254-137.compute-1.amazonaws.com', 'PublicIpAddress': '52.91.254.137', 'SourceDestCheck': True, 'State': 'running', 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'i-0de0fd033ca956c3f', 'tag': [{'Key': 'aws:autoscaling:groupName', 'Value': 'test_autoscaling_group', 'resource_id': 'i-0de0fd033ca956c3f..aws:autoscaling:groupName'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-0ebf1e77c968de019', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'DeviceIndex': 0, 'DnsName': 'ip-172-31-13-240.ec2.internal', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0de0fd033ca956c3f', 'InterfaceType': 'interface', 'MacAddress': '12:07:2e:32:67:a3', 'NetworkInterfaceId': 'eni-0ae696ee5e3cdf0d8', 'PrivateIpAddress': '172.31.13.240', 'PublicDnsName': 'ec2-52-91-254-137.compute-1.amazonaws.com', 'PublicIpAddress': '52.91.254.137', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0ae696ee5e3cdf0d8', 'PrivateIpAddress': '172.31.13.240', 'resource_id': 'eni-0ae696ee5e3cdf0d8..172.31.13.240'}], 'resource_id': 'eni-0ae696ee5e3cdf0d8'}, {'AvailabilityZone': 'us-east-1a', 'Description': 'arn:aws:ecs:us-east-1:139614369439:attachment/de002c3f-dae2-44ed-a079-6a05cda8e208', 'GroupId': ['sg-fee06cc9'], 'InstanceId': 'i-0de0fd033ca956c3f', 'InterfaceType': 'interface', 'MacAddress': '12:e9:e3:cc:21:5f', 'NetworkInterfaceId': 'eni-03cb776612d14e182', 'PrivateIpAddress': '172.31.7.163', 'SourceDestCheck': True, 'SubnetId': 'subnet-0e7e54192b01b1ed0', 'VpcId': 'vpc-3a02dc47', 'resource_id': 'eni-03cb776612d14e182'}]}}}, 'previous_timestamp': 1622971782705}
2021-06-06 12:29:47,625 - INFO - Calling modeler on-new-snapshot for timestamp 1622971787512 ...
2021-06-06 12:29:47,756 - INFO - Calling analyzer for timestamp 1622971787512 ...
2021-06-06 12:29:52,486 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:52,486 - INFO - Finished triggering everything for timestamp 1622971787512 after 4.95 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_ct_event', 0.03), ('store_classified', 0.03), ('modeler', 0.13), ('analyzer', 4.71)]
2021-06-06 12:29:52,731 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-076ebab6280bbba31'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-076ebab6280bbba31', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '32c77822-bfd4-4311-ad9d-943dc23deb53', 'eventID': '0b05cdb7-6186-4520-af42-04e2b7d5bf8d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:52,732 - INFO - delete instance - ['i-076ebab6280bbba31']
2021-06-06 12:29:52,756 - INFO - Get previous translated snapshot with timestamp 1622971787512 took 0.02 seconds
2021-06-06 12:29:52,761 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-076ebab6280bbba31', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.30.10.63', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-08d77652f170b9861', 'VpcId': 'vpc-057a5616a3c33b91f', 'resource_id': 'i-076ebab6280bbba31', 'tag': [{'Key': 'Name', 'Value': 'test-instance_4', 'resource_id': 'i-076ebab6280bbba31..Name'}]}], 'network_interface': [{'AttachmentId': 'eni-attach-00a9e0cbd73508cf2', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'DeviceIndex': 0, 'DnsName': 'ip-10-30-10-63.ec2.internal', 'GroupId': ['sg-0b036ea9b885a99e4'], 'InstanceId': 'i-076ebab6280bbba31', 'InterfaceType': 'interface', 'MacAddress': '0a:30:2d:9b:9a:99', 'NetworkInterfaceId': 'eni-05dbee3e82c283b79', 'PrivateIpAddress': '10.30.10.63', 'PublicDnsName': 'ec2-34-197-220-43.compute-1.amazonaws.com', 'PublicIpAddress': '34.197.220.43', 'SourceDestCheck': True, 'SubnetId': 'subnet-08d77652f170b9861', 'VpcId': 'vpc-057a5616a3c33b91f', 'private_ip_address': [{'NetworkInterfaceId': 'eni-05dbee3e82c283b79', 'PrivateIpAddress': '10.30.10.63', 'resource_id': 'eni-05dbee3e82c283b79..10.30.10.63'}], 'resource_id': 'eni-05dbee3e82c283b79', 'tag': [{'Key': 'Name', 'Value': 'test_interface_4', 'resource_id': 'eni-05dbee3e82c283b79..Name'}]}]}}}, 'previous_timestamp': 1622971787512}
2021-06-06 12:29:52,843 - INFO - Calling modeler on-new-snapshot for timestamp 1622971792732 ...
2021-06-06 12:29:52,935 - INFO - Calling analyzer for timestamp 1622971792732 ...
2021-06-06 12:29:56,659 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:29:56,659 - INFO - Finished triggering everything for timestamp 1622971792732 after 3.90 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_ct_event', 0.03), ('store_classified', 0.03), ('modeler', 0.09), ('analyzer', 3.7)]
2021-06-06 12:29:56,822 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:24:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:46Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-076ebab6280bbba31', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '5708731a-32e1-402a-be90-8a09dfae697e', '_return': True}, 'requestID': '5708731a-32e1-402a-be90-8a09dfae697e', 'eventID': '23d19d98-9fc3-46d8-be6b-9191ab529cc7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:56,824 - INFO - modify instance - [{'InstanceId': 'i-076ebab6280bbba31', 'resource_id': 'i-076ebab6280bbba31'}]
2021-06-06 12:29:56,899 - INFO - Get previous translated snapshot with timestamp 1622971792732 took 0.08 seconds
2021-06-06 12:29:56,908 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:29:56,908 - WARNING - Failed to handle message: tried to modify an old resource i-076ebab6280bbba31, but it doesn't exist.
2021-06-06 12:29:56,908 - INFO - adding message to failed events queue for retry
2021-06-06 12:29:57,132 - INFO - User N/A (elasticloadbalancing.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PYGZPWGOXK:ElasticLoadBalancing', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForElasticLoadBalancing/ElasticLoadBalancing', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PYGZPWGOXK', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/elasticloadbalancing.amazonaws.com/AWSServiceRoleForElasticLoadBalancing', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForElasticLoadBalancing'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:52Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'elasticloadbalancing.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:53Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'elasticloadbalancing.amazonaws.com', 'userAgent': 'elasticloadbalancing.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-05bfc215245e2ccc4'}, 'responseElements': {'requestId': '19e0bd95-74f8-42b4-a9bd-f4074d093e24', '_return': True}, 'requestID': '19e0bd95-74f8-42b4-a9bd-f4074d093e24', 'eventID': 'e89228f3-6238-4eb0-9b4d-7df407bd5694', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:29:57,133 - INFO - delete network_interface - ['eni-05bfc215245e2ccc4']
2021-06-06 12:29:57,160 - INFO - Get previous translated snapshot with timestamp 1622971792732 took 0.03 seconds
2021-06-06 12:29:57,163 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-0d54acd8abc1426b8', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'Description': 'ELB gwy/test-glb/53d838234c69cdf6', 'DeviceIndex': 1, 'DnsName': 'ip-10-10-70-137.ec2.internal', 'GroupId': [], 'InterfaceType': 'gateway_load_balancer', 'MacAddress': '0a:f6:ff:ee:43:cd', 'NetworkInterfaceId': 'eni-05bfc215245e2ccc4', 'PrivateIpAddress': '10.10.70.137', 'SourceDestCheck': False, 'SubnetId': 'subnet-080bf67267388f92d', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-05bfc215245e2ccc4', 'PrivateIpAddress': '10.10.70.137', 'resource_id': 'eni-05bfc215245e2ccc4..10.10.70.137'}], 'resource_id': 'eni-05bfc215245e2ccc4'}]}}}, 'previous_timestamp': 1622971792732}
2021-06-06 12:29:57,246 - INFO - Calling modeler on-new-snapshot for timestamp 1622971797133 ...
2021-06-06 12:29:57,307 - INFO - Calling analyzer for timestamp 1622971797133 ...
2021-06-06 12:30:00,847 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:00,847 - INFO - Finished triggering everything for timestamp 1622971797133 after 3.67 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('validate_timestamp', 0.02), ('modeler', 0.06), ('analyzer', 3.51)]
2021-06-06 12:30:01,007 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:07.425Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:01,168 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:09.223Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:01,328 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:11.577Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:01,490 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:11.615Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:01,726 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachInternetGateway in us-east-1 at 2021-06-06T09:25:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:08Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-020d848d62f02cfc0', 'vpcId': 'vpc-057a5616a3c33b91f'}, 'responseElements': {'requestId': 'd7cb7016-625b-4b0b-b658-645fae54b86b', '_return': True}, 'requestID': 'd7cb7016-625b-4b0b-b658-645fae54b86b', 'eventID': '482a01fd-af20-466a-8235-5d5c9b921bbc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:01,726 - INFO - remove internet_gateway_attachment - ['igw-020d848d62f02cfc0..vpc-057a5616a3c33b91f']
2021-06-06 12:30:01,760 - INFO - Get previous translated snapshot with timestamp 1622971797133 took 0.03 seconds
2021-06-06 12:30:01,764 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {'internet_gateway': [{'InternetGatewayId': 'igw-020d848d62f02cfc0', 'internet_gateway_attachment': [], 'resource_id': 'igw-020d848d62f02cfc0', 'tag': [{'Key': 'Name', 'Value': 'test_gw_3', 'resource_id': 'igw-020d848d62f02cfc0..Name'}]}]}, 'deleted': {}}}, 'previous_timestamp': 1622971797133}
2021-06-06 12:30:01,832 - INFO - Calling modeler on-new-snapshot for timestamp 1622971801727 ...
2021-06-06 12:30:02,006 - INFO - Calling analyzer for timestamp 1622971801727 ...
2021-06-06 12:30:05,485 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:05,485 - INFO - Finished triggering everything for timestamp 1622971801727 after 3.73 seconds! times: [('store_sub_events', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('set_complete', 0.02), ('store_classified', 0.03), ('modeler', 0.17), ('analyzer', 3.45)]
2021-06-06 12:30:05,899 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:13.415Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:06,546 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:15.112Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:07,240 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpc in us-east-1 at 2021-06-06T09:25:13Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:13Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpc', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0073beecbc61fd56a'}, 'responseElements': {'requestId': 'c104646a-0b73-4d9a-b86c-7aaff92db454', '_return': True}, 'requestID': 'c104646a-0b73-4d9a-b86c-7aaff92db454', 'eventID': '60f92d8b-8488-4b37-af85-632bf4b7f680', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:07,240 - INFO - delete vpc - ['vpc-0073beecbc61fd56a']
2021-06-06 12:30:07,264 - INFO - Get previous translated snapshot with timestamp 1622971801727 took 0.02 seconds
2021-06-06 12:30:07,278 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_acl': [{'IsDefault': True, 'NetworkAclId': 'acl-001fecac5826dfd09', 'VpcId': 'vpc-0073beecbc61fd56a', 'acl_association': [{'AssociationId': 'aclassoc-7eea2a5f', 'NetworkAclId': 'acl-001fecac5826dfd09', 'SubnetId': 'subnet-08c5e41d5c820a59f', 'resource_id': 'acl-001fecac5826dfd09..aclassoc-7eea2a5f'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-001fecac5826dfd09..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-001fecac5826dfd09..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-001fecac5826dfd09..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-001fecac5826dfd09..32767..False'}], 'resource_id': 'acl-001fecac5826dfd09'}], 'route_table': [{'RouteTableId': 'rtb-0eb2c5d8679458386', 'VpcId': 'vpc-0073beecbc61fd56a', 'resource_id': 'rtb-0eb2c5d8679458386', 'route': [{'DestinationCidrBlock': '10.40.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0eb2c5d8679458386..10.40.0.0/16'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0c5eba2619eab5d38', 'Main': True, 'RouteTableId': 'rtb-0eb2c5d8679458386', 'resource_id': 'rtb-0eb2c5d8679458386..rtbassoc-0c5eba2619eab5d38'}]}], 'security_group': [{'GroupId': 'sg-0ebc99f21ce5f5e0c', 'GroupName': 'default', 'VpcId': 'vpc-0073beecbc61fd56a', 'resource_id': 'sg-0ebc99f21ce5f5e0c', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0ebc99f21ce5f5e0c..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-0ebc99f21ce5f5e0c'], 'resource_id': 'sg-0ebc99f21ce5f5e0c..all__ingress_rule'}]}], 'vpc': [{'CidrBlock': '10.40.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-0073beecbc61fd56a', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-09333950dd21cffdb', 'CidrBlock': '10.40.0.0/16', 'VpcId': 'vpc-0073beecbc61fd56a', 'resource_id': 'vpc-0073beecbc61fd56a..10.40.0.0/16'}], 'resource_id': 'vpc-0073beecbc61fd56a', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_nat', 'resource_id': 'vpc-0073beecbc61fd56a..Name'}]}]}}}, 'previous_timestamp': 1622971801727}
2021-06-06 12:30:07,363 - INFO - Calling modeler on-new-snapshot for timestamp 1622971807241 ...
2021-06-06 12:30:07,436 - INFO - Calling analyzer for timestamp 1622971807241 ...
2021-06-06 12:30:10,826 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:10,826 - INFO - Finished triggering everything for timestamp 1622971807241 after 3.53 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.04), ('modeler', 0.07), ('analyzer', 3.36)]
2021-06-06 12:30:10,985 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:25:32.142Z, account_id: N/A, extra:{'instance-id': 'i-0a695efad9fed3af9', 'state': 'terminated'}
2021-06-06 12:30:11,166 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:49.896Z, account_id: N/A, extra:{'agentConnected': False, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'ec2InstanceId': 'i-0bc9c6152477ce465', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'INACTIVE', 'version': 9, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:42.694Z', 'registeredAt': '2021-06-06T09:08:43.39Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:30:11,321 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:55.808Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'ecs', 'resource-type': 'task-definition', 'version': 1.0, 'tags': {}}
2021-06-06 12:30:11,560 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:41.480Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:11,702 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:43.235Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'iam', 'resource-type': 'instance-profile', 'version': 57.0, 'tags': {}}
2021-06-06 12:30:11,871 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:45.399Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:12,027 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteDBSubnetGroup in us-east-1 at 2021-06-06T09:26:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:41Z', 'eventSource': 'rds.amazonaws.com', 'eventName': 'DeleteDBSubnetGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'dBSubnetGroupName': 'test_db_subnet_group'}, 'responseElements': None, 'requestID': '9282025e-cc98-45bb-ba51-324579aba823', 'eventID': 'ae7b29b7-72b7-4075-be28-62ea86e8f678', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:12,184 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:26:54.798Z, account_id: N/A, extra:{'instance-id': 'i-0bc9c6152477ce465', 'state': 'terminated'}
2021-06-06 12:30:13,088 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:14.099Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': 'adc7663e-3a3d-48fc-804f-49b0a5987862'}
2021-06-06 12:30:13,288 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:25:23Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:23Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-08d77652f170b9861'}, 'responseElements': {'requestId': 'c9e22357-fbd7-477b-b139-f030d311282d', '_return': True}, 'requestID': 'c9e22357-fbd7-477b-b139-f030d311282d', 'eventID': '3b7a0be9-0003-4813-97bf-cf91d9e13d8e', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:13,288 - INFO - delete subnet - ['subnet-08d77652f170b9861']
2021-06-06 12:30:13,328 - INFO - Get previous translated snapshot with timestamp 1622971807241 took 0.04 seconds
2021-06-06 12:30:13,331 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1b', 'CidrBlock': '10.30.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-08d77652f170b9861', 'VpcId': 'vpc-057a5616a3c33b91f', 'resource_id': 'subnet-08d77652f170b9861', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_3', 'resource_id': 'subnet-08d77652f170b9861..Name'}]}]}}}, 'previous_timestamp': 1622971807241}
2021-06-06 12:30:13,383 - INFO - Calling modeler on-new-snapshot for timestamp 1622971813289 ...
2021-06-06 12:30:13,413 - INFO - Calling analyzer for timestamp 1622971813289 ...
2021-06-06 12:30:16,394 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:16,395 - INFO - Finished triggering everything for timestamp 1622971813289 after 3.07 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 2.96)]
2021-06-06 12:30:16,395 - ERROR - TTL crossed (285 seconds), trying to handle message from queue for last time before discarding it, retry num: 1
2021-06-06 12:30:16,395 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-0a695efad9fed3af9', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '26d32fa7-4200-4afc-bcaa-b4aa1a14db60', '_return': True}, 'requestID': '26d32fa7-4200-4afc-bcaa-b4aa1a14db60', 'eventID': '331154fa-cdb9-45a5-8ce4-f38d31ff56dc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:16,395 - INFO - modify instance - [{'InstanceId': 'i-0a695efad9fed3af9', 'resource_id': 'i-0a695efad9fed3af9'}]
2021-06-06 12:30:16,415 - INFO - Get previous translated snapshot with timestamp 1622971813289 took 0.02 seconds
2021-06-06 12:30:16,418 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:30:16,418 - ERROR - After trying 1 times, failed to handle waiting message for last time. time passed is 285 seconds. discarding message. err: tried to modify an old resource i-0a695efad9fed3af9, but it doesn't exist.
2021-06-06 12:30:16,418 - ERROR - TTL crossed (285 seconds), trying to handle message from queue for last time before discarding it, retry num: 1
2021-06-06 12:30:16,418 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-0d85e45ef5c46f62f', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '90fcb20c-d85a-412e-9ad2-5c443aaed9d5', '_return': True}, 'requestID': '90fcb20c-d85a-412e-9ad2-5c443aaed9d5', 'eventID': '1751167d-6676-434c-a021-09f47d8312af', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:16,419 - INFO - modify instance - [{'InstanceId': 'i-0d85e45ef5c46f62f', 'resource_id': 'i-0d85e45ef5c46f62f'}]
2021-06-06 12:30:16,438 - INFO - Get previous translated snapshot with timestamp 1622971813289 took 0.02 seconds
2021-06-06 12:30:16,441 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:30:16,441 - ERROR - After trying 1 times, failed to handle waiting message for last time. time passed is 285 seconds. discarding message. err: tried to modify an old resource i-0d85e45ef5c46f62f, but it doesn't exist.
2021-06-06 12:30:16,441 - ERROR - TTL crossed (271 seconds), trying to handle message from queue for last time before discarding it, retry num: 1
2021-06-06 12:30:16,441 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachInternetGateway in us-east-1 at 2021-06-06T09:24:00Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:00Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-0f610ccbce4fbec4f', 'vpcId': 'vpc-00ee3246072e19077'}, 'responseElements': {'requestId': '58197aa7-5428-4935-90de-ff5eee687e89', '_return': True}, 'requestID': '58197aa7-5428-4935-90de-ff5eee687e89', 'eventID': '4d583639-293e-4e98-ac8a-1ed45cfa5cb9', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:16,441 - INFO - remove internet_gateway_attachment - ['igw-0f610ccbce4fbec4f..vpc-00ee3246072e19077']
2021-06-06 12:30:16,460 - INFO - Get previous translated snapshot with timestamp 1622971813289 took 0.02 seconds
2021-06-06 12:30:16,463 - ERROR - After trying 1 times, failed to handle waiting message for last time. time passed is 271 seconds. discarding message. err: tried to get modify subresource of type internet_gateway_attachment but didn't find its parent igw-0f610ccbce4fbec4f
2021-06-06 12:30:16,463 - ERROR - TTL crossed (265 seconds), trying to handle message from queue for last time before discarding it, retry num: 1
2021-06-06 12:30:16,463 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed ModifyInstanceAttribute in us-east-1 at 2021-06-06T09:23:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'ModifyInstanceAttribute', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceId': 'i-027316ea5aa78f08b', 'disableApiTermination': {'value': False}}, 'responseElements': {'requestId': '23e46e95-d068-46b7-a113-70bd51ed0ce1', '_return': True}, 'requestID': '23e46e95-d068-46b7-a113-70bd51ed0ce1', 'eventID': '0bfa37d3-4f9e-40d4-8af4-b83c8494d5c7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:16,464 - INFO - modify instance - [{'InstanceId': 'i-027316ea5aa78f08b', 'resource_id': 'i-027316ea5aa78f08b'}]
2021-06-06 12:30:16,484 - INFO - Get previous translated snapshot with timestamp 1622971813289 took 0.02 seconds
2021-06-06 12:30:16,486 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:30:16,486 - ERROR - After trying 1 times, failed to handle waiting message for last time. time passed is 265 seconds. discarding message. err: tried to modify an old resource i-027316ea5aa78f08b, but it doesn't exist.
2021-06-06 12:30:16,678 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSecurityGroup in us-east-1 at 2021-06-06T09:25:23Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:23Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0b036ea9b885a99e4'}, 'responseElements': {'requestId': 'd897ab5b-c9dc-4d22-9671-4fbd5a690ef0', '_return': True}, 'requestID': 'd897ab5b-c9dc-4d22-9671-4fbd5a690ef0', 'eventID': '029f2378-96ec-4496-91ba-55f061b269af', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:16,679 - INFO - delete security_group - ['sg-0b036ea9b885a99e4']
2021-06-06 12:30:16,709 - INFO - Get previous translated snapshot with timestamp 1622971813289 took 0.03 seconds
2021-06-06 12:30:16,712 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'security_group': [{'GroupId': 'sg-0b036ea9b885a99e4', 'GroupName': 'test_security_group_3', 'VpcId': 'vpc-057a5616a3c33b91f', 'resource_id': 'sg-0b036ea9b885a99e4', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0b036ea9b885a99e4..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0b036ea9b885a99e4..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_3', 'resource_id': 'sg-0b036ea9b885a99e4..Name'}]}]}}}, 'previous_timestamp': 1622971813289}
2021-06-06 12:30:16,773 - INFO - Calling modeler on-new-snapshot for timestamp 1622971816680 ...
2021-06-06 12:30:16,792 - INFO - Calling analyzer for timestamp 1622971816680 ...
2021-06-06 12:30:19,766 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:19,766 - INFO - Finished triggering everything for timestamp 1622971816680 after 3.06 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.95)]
2021-06-06 12:30:20,053 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:21Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:21Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-05dbee3e82c283b79'}, 'responseElements': {'requestId': 'e4ab9fd1-0743-404d-9ebb-37c0da6b458f', '_return': True}, 'requestID': 'e4ab9fd1-0743-404d-9ebb-37c0da6b458f', 'eventID': '2ae55815-7e92-412d-883b-50490be7143a', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:20,054 - INFO - delete network_interface - ['eni-05dbee3e82c283b79']
2021-06-06 12:30:20,073 - INFO - Get previous translated snapshot with timestamp 1622971816680 took 0.02 seconds
2021-06-06 12:30:20,076 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:30:20,076 - WARNING - Failed to handle message: tried to remove an old resource eni-05dbee3e82c283b79, but it doesn't exist.
2021-06-06 12:30:20,076 - INFO - adding message to failed events queue for retry
2021-06-06 12:30:20,239 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:35.873Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '8df03e1f-1599-4a24-8fbd-e069d1ce029c'}
2021-06-06 12:30:20,465 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:55.595Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ecs', 'resource-type': 'cluster', 'version': 135.0, 'tags': {}}
2021-06-06 12:30:20,670 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteCluster in us-east-1 at 2021-06-06T09:25:53Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:53Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DeleteCluster', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'cluster': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster'}, 'responseElements': {'cluster': {'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'status': 'INACTIVE', 'registeredContainerInstancesCount': 0, 'runningTasksCount': 0, 'pendingTasksCount': 0, 'activeServicesCount': 0, 'statistics': [], 'tags': [], 'settings': [{'name': 'containerInsights', 'value': 'disabled'}], 'capacityProviders': [], 'defaultCapacityProviderStrategy': []}}, 'requestID': '36463f17-074d-4f7e-a36a-5e97738d9273', 'eventID': 'ec2e67a8-9021-4660-91a7-6702ce572bf6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:20,670 - INFO - delete ecs - ['arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster']
2021-06-06 12:30:20,691 - INFO - Get previous translated snapshot with timestamp 1622971816680 took 0.02 seconds
2021-06-06 12:30:20,695 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'ecs': [{'activeServicesCount': 2, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'clusterName': 'test_ecs_cluster', 'container_instance': [{'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'ec2InstanceId': 'i-0bc9c6152477ce465', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7'}, {'attributes': [{'name': 'ecs.capability.secrets.asm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.asm.environment-variables'}, {'name': 'ecs.capability.branch-cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.branch-cni-plugin-version', 'value': 'a21d3a41-'}, {'name': 'ecs.ami-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.ami-id', 'value': 'ami-0f06fc190dd71269e'}, {'name': 'ecs.capability.secrets.asm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.asm.bootstrap.log-driver'}, {'name': 'ecs.capability.task-eia.optimized-cpu', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eia.optimized-cpu'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.none', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.none'}, {'name': 'ecs.capability.ecr-endpoint', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.ecr-endpoint'}, {'name': 'ecs.capability.docker-plugin.local', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.docker-plugin.local'}, {'name': 'ecs.capability.task-cpu-mem-limit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-cpu-mem-limit'}, {'name': 'ecs.capability.secrets.ssm.bootstrap.log-driver', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.ssm.bootstrap.log-driver'}, {'name': 'ecs.capability.efsAuth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.efsAuth'}, {'name': 'ecs.capability.full-sync', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.full-sync'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.30', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.30'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.31', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.31'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.32', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.32'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.fluentd'}, {'name': 'ecs.capability.firelens.options.config.file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.options.config.file'}, {'name': 'ecs.availability-zone', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.availability-zone', 'value': 'us-east-1a'}, {'name': 'ecs.capability.aws-appmesh', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.aws-appmesh'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.awslogs'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.24', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.24'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.25', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.25'}, {'name': 'ecs.capability.task-eni-trunking', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni-trunking'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.26', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.26'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.27', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.27'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.28', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.28'}, {'name': 'com.amazonaws.ecs.capability.privileged-container', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.privileged-container'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.29', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.29'}, {'name': 'ecs.cpu-architecture', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.cpu-architecture', 'value': 'x86_64'}, {'name': 'ecs.capability.firelens.fluentbit', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.fluentbit'}, {'name': 'com.amazonaws.ecs.capability.ecr-auth', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.ecr-auth'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.20', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.20'}, {'name': 'ecs.os-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.os-type', 'value': 'linux'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.21', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.21'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.22', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.22'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.23', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.23'}, {'name': 'ecs.capability.private-registry-authentication.secretsmanager', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.private-registry-authentication.secretsmanager'}, {'name': 'ecs.capability.task-eia', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eia'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.syslog', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.syslog'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.awsfirelens', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.awsfirelens'}, {'name': 'ecs.capability.firelens.options.config.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.options.config.s3'}, {'name': 'com.amazonaws.ecs.capability.logging-driver.json-file', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.logging-driver.json-file'}, {'name': 'ecs.capability.execution-role-awslogs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.execution-role-awslogs'}, {'name': 'ecs.vpc-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.vpc-id', 'value': 'vpc-3a02dc47'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.17', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.17'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.18', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.18'}, {'name': 'com.amazonaws.ecs.capability.docker-remote-api.1.19', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.docker-remote-api.1.19'}, {'name': 'ecs.capability.docker-plugin.amazon-ecs-volume-plugin', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.docker-plugin.amazon-ecs-volume-plugin'}, {'name': 'ecs.capability.task-eni', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni'}, {'name': 'ecs.capability.firelens.fluentd', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.firelens.fluentd'}, {'name': 'ecs.capability.efs', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.efs'}, {'name': 'ecs.capability.execution-role-ecr-pull', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.execution-role-ecr-pull'}, {'name': 'ecs.capability.task-eni.ipv6', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.task-eni.ipv6'}, {'name': 'ecs.capability.container-health-check', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.container-health-check'}, {'name': 'ecs.subnet-id', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.subnet-id', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'ecs.instance-type', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.instance-type', 'value': 't2.micro'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role-network-host', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.task-iam-role-network-host'}, {'name': 'ecs.capability.container-ordering', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.container-ordering'}, {'name': 'ecs.capability.cni-plugin-version', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.cni-plugin-version', 'value': '55b2ae77-2020.09.0'}, {'name': 'ecs.capability.env-files.s3', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.env-files.s3'}, {'name': 'ecs.capability.pid-ipc-namespace-sharing', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.pid-ipc-namespace-sharing'}, {'name': 'ecs.capability.secrets.ssm.environment-variables', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..ecs.capability.secrets.ssm.environment-variables'}, {'name': 'com.amazonaws.ecs.capability.task-iam-role', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a..com.amazonaws.ecs.capability.task-iam-role'}], 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'ec2InstanceId': 'i-09e2d3e3d9fdb48cf', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a'}], 'pendingTasksCount': 0, 'registeredContainerInstancesCount': 3, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'runningTasksCount': 3, 'service': [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'deployment': [{'desiredCount': 2, 'failedTasks': 0, 'id': 'ecs-svc/3384641070202511327', 'launchType': 'EC2', 'pendingCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/3384641070202511327', 'rolloutState': 'COMPLETED', 'runningCount': 2, 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}], 'launchType': 'EC2', 'pendingTasksCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'runningTasksCount': 2, 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_service', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..Name'}]}], 'status': 'ACTIVE', 'tag': [{'Key': 'Name', 'Value': 'test_ecs_cluster', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..Name'}], 'task': [{'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-026ba384964109468', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..networkInterfaceId..eni-026ba384964109468'}, {'detailName': 'macAddress', 'detailValue': '12:5a:b8:61:34:4f', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..macAddress..12:5a:b8:61:34:4f'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-5-40.ec2.internal', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..privateDnsName..ip-172-31-5-40.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.5.40', 'resource_id': '37b6cac5-fc31-463f-89cc-3184f05413d5..privateIPv4Address..172.31.5.40'}], 'id': '37b6cac5-fc31-463f-89cc-3184f05413d5', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21..37b6cac5-fc31-463f-89cc-3184f05413d5', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-0ba19af047fb45c0c', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..networkInterfaceId..eni-0ba19af047fb45c0c'}, {'detailName': 'macAddress', 'detailValue': '12:80:55:19:0c:3f', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..macAddress..12:80:55:19:0c:3f'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-9-79.ec2.internal', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..privateDnsName..ip-172-31-9-79.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.9.79', 'resource_id': '05272592-c932-43c2-ba7f-60effa478cc1..privateIPv4Address..172.31.9.79'}], 'id': '05272592-c932-43c2-ba7f-60effa478cc1', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c..05272592-c932-43c2-ba7f-60effa478cc1', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a78b830f8d524715bcc4b1d3b3220c6a', 'cpu': '256', 'launchType': 'EC2', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/a9563278c05840f280ee5b023cdf641c', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273'}, {'attachment': [{'detail': [{'detailName': 'subnetId', 'detailValue': 'subnet-0e7e54192b01b1ed0', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..subnetId..subnet-0e7e54192b01b1ed0'}, {'detailName': 'networkInterfaceId', 'detailValue': 'eni-06f56ed6ae2441c1a', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..networkInterfaceId..eni-06f56ed6ae2441c1a'}, {'detailName': 'macAddress', 'detailValue': '12:05:3f:55:b9:67', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..macAddress..12:05:3f:55:b9:67'}, {'detailName': 'privateDnsName', 'detailValue': 'ip-172-31-10-216.ec2.internal', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..privateDnsName..ip-172-31-10-216.ec2.internal'}, {'detailName': 'privateIPv4Address', 'detailValue': '172.31.10.216', 'resource_id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c..privateIPv4Address..172.31.10.216'}], 'id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5..32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'type': 'ElasticNetworkInterface'}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'cpu': '256', 'launchType': 'FARGATE', 'memoryReservation': '512', 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21'}]}]}}}, 'previous_timestamp': 1622971816680}
2021-06-06 12:30:20,779 - INFO - Calling modeler on-new-snapshot for timestamp 1622971820671 ...
2021-06-06 12:30:20,796 - INFO - Calling analyzer for timestamp 1622971820671 ...
2021-06-06 12:30:23,761 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:23,761 - INFO - Finished triggering everything for timestamp 1622971820671 after 3.06 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('modeler', 0.02), ('store_classified', 0.03), ('analyzer', 2.94)]
2021-06-06 12:30:23,938 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:40.463Z, account_id: N/A, extra:{'EventCategories': ['deletion'], 'SourceType': 'DB_INSTANCE', 'SourceArn': 'arn:aws:rds:us-east-1:139614369439:db:terraform-20210606090936358700000008', 'Date': '2021-06-06T09:26:39.740Z', 'Message': 'DB instance deleted', 'SourceIdentifier': 'terraform-20210606090936358700000008', 'EventID': 'RDS-EVENT-0003'}
2021-06-06 12:30:24,150 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:42.464Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'rds', 'resource-type': 'subgrp', 'version': 40.0, 'tags': {}}
2021-06-06 12:30:24,355 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:26:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-064f1d287f7b216bd'}, 'responseElements': {'requestId': '3c0d11a3-8042-42cc-b50a-093855194b2a', '_return': True}, 'requestID': '3c0d11a3-8042-42cc-b50a-093855194b2a', 'eventID': '206861c4-2e83-4a2a-bd81-177937822860', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:24,357 - INFO - delete network_interface - ['eni-064f1d287f7b216bd']
2021-06-06 12:30:24,378 - INFO - Get previous translated snapshot with timestamp 1622971820671 took 0.02 seconds
2021-06-06 12:30:24,380 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:30:24,380 - WARNING - Failed to handle message: tried to remove an old resource eni-064f1d287f7b216bd, but it doesn't exist.
2021-06-06 12:30:24,380 - INFO - adding message to failed events queue for retry
2021-06-06 12:30:26,213 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeletePolicy in us-east-1 at 2021-06-06T09:24:25Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:25Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeletePolicy', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'policyArn': 'arn:aws:iam::139614369439:policy/test_iam_policy'}, 'responseElements': None, 'requestID': '723a1788-4ab6-4f6d-86e2-9e6be949dc40', 'eventID': 'fa31ed19-8352-4858-8c74-6d1364a35ee7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:26,214 - INFO - delete iam_policy - ['arn:aws:iam::139614369439:policy/test_iam_policy']
2021-06-06 12:30:26,235 - INFO - Get previous translated snapshot with timestamp 1622971820671 took 0.02 seconds
2021-06-06 12:30:26,237 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {'iam_policy': [{'Arn': 'arn:aws:iam::139614369439:policy/test_iam_policy', 'IsDefault': False, 'PolicyName': 'test_iam_policy', 'resource_id': 'arn:aws:iam::139614369439:policy/test_iam_policy', 'statement': [{'Action': ['s3:*', 'ec2:DescribeRegions', 'dynamodb:*', 'kinesis:*', 'sqs:*'], 'Effect': 'Allow', 'Resource': '*', 'resource_id': 'arn:aws:iam::139614369439:policy/test_iam_policy'}]}]}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971820671}
2021-06-06 12:30:26,298 - INFO - Calling modeler on-new-snapshot for timestamp 1622971826214 ...
2021-06-06 12:30:26,328 - INFO - Calling analyzer for timestamp 1622971826214 ...
2021-06-06 12:30:29,363 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:29,363 - INFO - Finished triggering everything for timestamp 1622971826214 after 3.13 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.01)]
2021-06-06 12:30:29,575 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:33.865Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 768}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 471}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'ACTIVE', 'version': 5, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:27.604Z', 'registeredAt': '2021-06-06T09:08:47.166Z', 'pendingTasksCount': 1, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:30:29,775 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:34.094Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:29,979 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:42.672Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '95670d04-d926-40ca-aef5-4b3e4105083b'}
2021-06-06 12:30:30,145 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:47.265Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:30,304 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:51.483Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '901cdca5-729b-48b5-9f79-5f1537f170aa'}
2021-06-06 12:30:30,500 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed UpdateService in us-east-1 at 2021-06-06T09:24:46Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:46Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'UpdateService', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'cluster': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'desiredCount': 0, 'forceNewDeployment': False, 'service': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}, 'responseElements': {'service': {'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'loadBalancers': [], 'serviceRegistries': [], 'status': 'ACTIVE', 'desiredCount': 0, 'runningCount': 0, 'pendingCount': 0, 'launchType': 'EC2', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'deploymentConfiguration': {'deploymentCircuitBreaker': {'enable': False, 'rollback': False}, 'maximumPercent': 200, 'minimumHealthyPercent': 100}, 'deployments': [{'id': 'ecs-svc/3384641070202511327', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'desiredCount': 0, 'pendingCount': 0, 'runningCount': 0, 'failedTasks': 0, 'createdAt': 'Jun 6, 2021 9:07:20 AM', 'updatedAt': 'Jun 6, 2021 9:24:27 AM', 'launchType': 'EC2', 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'DISABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'rolloutState': 'COMPLETED', 'rolloutStateReason': 'ECS deployment ecs-svc/3384641070202511327 completed.'}], 'roleArn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'version': 0, 'events': [{'id': 'd13f22b7-494d-4580-a470-481cdf56029c', 'createdAt': 'Jun 6, 2021 9:24:27 AM', 'message': '(service test_ecs_service) has started 1 tasks: (task 5aada34b31564518b7ebe9d94905ba17).'}, {'id': '6c9988e5-8392-412b-9999-feee811c79f9', 'createdAt': 'Jun 6, 2021 9:09:14 AM', 'message': '(service test_ecs_service) has reached a steady state.'}, {'id': '431719b0-f8d0-4f29-9383-2f8187d0bf17', 'createdAt': 'Jun 6, 2021 9:09:14 AM', 'message': '(service test_ecs_service) (deployment ecs-svc/3384641070202511327) deployment completed.'}, {'id': '5907dddc-5239-4f0d-8c6a-3ab7e30e043e', 'createdAt': 'Jun 6, 2021 9:08:43 AM', 'message': '(service test_ecs_service) has started 1 tasks: (task 06b184bb6d7b4e33bd34ffec0bca0d21).'}, {'id': '6fc921c2-0552-46d2-8003-f3dbfc31f22d', 'createdAt': 'Jun 6, 2021 9:08:32 AM', 'message': '(service test_ecs_service) has started 1 tasks: (task a9563278c05840f280ee5b023cdf641c).'}, {'id': 'fe9dd208-586b-421f-87db-8bf820485b29', 'createdAt': 'Jun 6, 2021 9:07:28 AM', 'message': '(service test_ecs_service) was unable to place a task because no container instance met all of its requirements. Reason: No Container Instances were found in your cluster. For more information, see the Troubleshooting section of the Amazon ECS Developer Guide.'}], 'createdAt': 'Jun 6, 2021 9:07:20 AM', 'placementConstraints': [], 'placementStrategy': [], 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'DISABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'schedulingStrategy': 'REPLICA', 'createdBy': 'arn:aws:iam::139614369439:root', 'enableECSManagedTags': False, 'propagateTags': 'NONE', 'enableExecuteCommand': False}}, 'requestID': '48b91ba7-7e52-493a-bf95-28b0b27e2454', 'eventID': '6d03c49b-8b75-4a60-b796-f40c96ed30ef', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:30,507 - INFO - modify service - [{'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'launchType': 'EC2', 'deployment': [{'launchType': 'EC2', 'id': 'ecs-svc/3384641070202511327', 'rolloutState': 'COMPLETED', 'failedTasks': 0, 'status': 'PRIMARY', 'desiredCount': 0, 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'pendingCount': 0, 'runningCount': 0, 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service..ecs-svc/3384641070202511327'}], 'resource_id': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}]
2021-06-06 12:30:30,526 - INFO - Get previous translated snapshot with timestamp 1622971826214 took 0.02 seconds
2021-06-06 12:30:30,528 - WARNING - Failed to handle message: tried to get modify subresource of type service but didn't find its parent arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster
2021-06-06 12:30:30,528 - INFO - adding message to failed events queue for retry
2021-06-06 12:30:30,814 - INFO - Ignoring failed event - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:24:45Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PWKCFXY3QR:i-0de0fd033ca956c3f', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PTWJOV2HX', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PWKCFXY3QR', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:07:40Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:24:45Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '52.91.254.137', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'errorCode': 'AccessDenied', 'errorMessage': 'User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'requestParameters': None, 'responseElements': None, 'requestID': '960c5385-b134-45e1-ad51-d719aa0e5001', 'eventID': '910b20bb-5957-4cdf-afb4-7d45635b51eb', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: AccessDenied, message: User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster)
2021-06-06 12:30:31,011 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:04.759Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:31,208 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteInternetGateway in us-east-1 at 2021-06-06T09:25:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:08Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-020d848d62f02cfc0'}, 'responseElements': {'requestId': '12b3c57a-0340-4cba-b09e-719e0385fa2f', '_return': True}, 'requestID': '12b3c57a-0340-4cba-b09e-719e0385fa2f', 'eventID': '42fbc9c9-df8b-4f93-a3ab-af2cc84749e0', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:31,208 - INFO - delete internet_gateway - ['igw-020d848d62f02cfc0']
2021-06-06 12:30:31,228 - INFO - Get previous translated snapshot with timestamp 1622971826214 took 0.02 seconds
2021-06-06 12:30:31,231 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'internet_gateway': [{'InternetGatewayId': 'igw-020d848d62f02cfc0', 'internet_gateway_attachment': [], 'resource_id': 'igw-020d848d62f02cfc0', 'tag': [{'Key': 'Name', 'Value': 'test_gw_3', 'resource_id': 'igw-020d848d62f02cfc0..Name'}]}]}}}, 'previous_timestamp': 1622971826214}
2021-06-06 12:30:31,291 - INFO - Calling modeler on-new-snapshot for timestamp 1622971831208 ...
2021-06-06 12:30:31,322 - INFO - Calling analyzer for timestamp 1622971831208 ...
2021-06-06 12:30:34,255 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:34,255 - INFO - Finished triggering everything for timestamp 1622971831208 after 3.03 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 2.91)]
2021-06-06 12:30:35,765 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:46.340Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:35,933 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpc in us-east-1 at 2021-06-06T09:26:42Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:42Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpc', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-0e42ef83fc1c69dba'}, 'responseElements': {'requestId': '13842fd0-5ac0-42ef-8be2-09c21ca04ba1', '_return': True}, 'requestID': '13842fd0-5ac0-42ef-8be2-09c21ca04ba1', 'eventID': 'b3a782b1-4ecf-494d-8599-91ab5a23ff0d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:35,934 - INFO - delete vpc - ['vpc-0e42ef83fc1c69dba']
2021-06-06 12:30:35,955 - INFO - Get previous translated snapshot with timestamp 1622971831208 took 0.02 seconds
2021-06-06 12:30:35,964 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_acl': [{'IsDefault': True, 'NetworkAclId': 'acl-0de9c497790765bf7', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'acl_association': [{'AssociationId': 'aclassoc-26854507', 'NetworkAclId': 'acl-0de9c497790765bf7', 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'resource_id': 'acl-0de9c497790765bf7..aclassoc-26854507'}, {'AssociationId': 'aclassoc-2426e705', 'NetworkAclId': 'acl-0de9c497790765bf7', 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'resource_id': 'acl-0de9c497790765bf7..aclassoc-2426e705'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0de9c497790765bf7..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0de9c497790765bf7..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0de9c497790765bf7..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0de9c497790765bf7..32767..False'}], 'resource_id': 'acl-0de9c497790765bf7'}], 'route_table': [{'RouteTableId': 'rtb-0674b00afe56d1ab8', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'rtb-0674b00afe56d1ab8', 'route': [{'DestinationCidrBlock': '10.20.0.0/16', 'GatewayId': 'local', 'Origin': 'CreateRouteTable', 'State': 'active', 'resource_id': 'rtb-0674b00afe56d1ab8..10.20.0.0/16'}, {'DestinationPrefixListId': 'pl-02cd2c6b', 'GatewayId': 'vpce-07f2a8fb449c88337', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0674b00afe56d1ab8'}, {'DestinationPrefixListId': 'pl-63a5400a', 'GatewayId': 'vpce-0771eec70504795e8', 'Origin': 'CreateRoute', 'State': 'active', 'resource_id': 'rtb-0674b00afe56d1ab8'}], 'route_table_association': [{'AssociationId': 'rtbassoc-0ccae4759922dc60c', 'Main': True, 'RouteTableId': 'rtb-0674b00afe56d1ab8', 'resource_id': 'rtb-0674b00afe56d1ab8..rtbassoc-0ccae4759922dc60c'}]}], 'security_group': [{'GroupId': 'sg-054bffda9ef94c861', 'GroupName': 'default', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'sg-054bffda9ef94c861', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-054bffda9ef94c861..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-054bffda9ef94c861'], 'resource_id': 'sg-054bffda9ef94c861..all__ingress_rule'}]}, {'GroupId': 'sg-0bf342c26b99f93f2', 'GroupName': 'test_security_group_vpce', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'sg-0bf342c26b99f93f2', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0bf342c26b99f93f2..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': ['0.0.0.0/0'], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': [], 'resource_id': 'sg-0bf342c26b99f93f2..all..0.0.0.0/0__ingress_rule'}], 'tag': [{'Key': 'Name', 'Value': 'test_security_group_vpce', 'resource_id': 'sg-0bf342c26b99f93f2..Name'}]}], 'vpc': [{'CidrBlock': '10.20.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-079b1392898af6cde', 'CidrBlock': '10.20.0.0/16', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'vpc-0e42ef83fc1c69dba..10.20.0.0/16'}], 'resource_id': 'vpc-0e42ef83fc1c69dba', 'tag': [{'Key': 'Name', 'Value': 'vpc_for_endpoints', 'resource_id': 'vpc-0e42ef83fc1c69dba..Name'}]}]}}}, 'previous_timestamp': 1622971831208}
2021-06-06 12:30:36,050 - INFO - Calling modeler on-new-snapshot for timestamp 1622971835935 ...
2021-06-06 12:30:36,104 - INFO - Calling analyzer for timestamp 1622971835935 ...
2021-06-06 12:30:39,228 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:39,228 - INFO - Finished triggering everything for timestamp 1622971835935 after 3.26 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.03), ('store_classified', 0.04), ('modeler', 0.05), ('analyzer', 3.1)]
2021-06-06 12:30:42,365 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteAutoScalingGroup in us-east-1 at 2021-06-06T09:27:16Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:27:16Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'DeleteAutoScalingGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'forceDelete': False, 'autoScalingGroupName': 'test_autoscaling_group'}, 'responseElements': None, 'requestID': '30f31330-8a8c-441f-834e-a0d3888f4093', 'eventID': '174d4649-7bd2-4a66-90fb-87ba78c306a7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:42,366 - INFO - delete auto_scaling_group - []
2021-06-06 12:30:42,433 - INFO - Get previous translated snapshot with timestamp 1622971835935 took 0.07 seconds
2021-06-06 12:30:42,435 - INFO - delete auto_scaling_group: arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group (deleted by key: AutoScalingGroupName, value: test_autoscaling_group)
2021-06-06 12:30:42,436 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'auto_scaling_group': [{'AutoScalingGroupARN': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group', 'AutoScalingGroupName': 'test_autoscaling_group', 'DefaultCooldown': 300, 'DesiredCapacity': 0, 'HealthCheckGracePeriod': 300, 'HealthCheckType': 'EC2', 'LaunchConfigurationName': 'terraform-20210606090725817600000006', 'MaxSize': 0, 'MinSize': 0, 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group', 'tag': [{'Key': 'AmazonECSManaged', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:autoScalingGroup:8e1e3d69-475b-4bdc-b2db-ac309de192cb:autoScalingGroupName/test_autoscaling_group..AmazonECSManaged'}]}]}}}, 'previous_timestamp': 1622971835935}
2021-06-06 12:30:42,491 - INFO - Calling modeler on-new-snapshot for timestamp 1622971842367 ...
2021-06-06 12:30:42,509 - INFO - Calling analyzer for timestamp 1622971842367 ...
2021-06-06 12:30:45,443 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:45,443 - INFO - Finished triggering everything for timestamp 1622971842367 after 3.01 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.91)]
2021-06-06 12:30:45,639 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:27:46.407Z, account_id: N/A, extra:{'changed-tag-keys': [], 'service': 'iam', 'resource-type': 'instance-profile', 'version': 53.0, 'tags': {}}
2021-06-06 12:30:46,746 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:13.834Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'internet-gateway', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:46,969 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:14.471Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:47,172 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:18.334Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'security-group', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:47,333 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSecurityGroup in us-east-1 at 2021-06-06T09:25:14Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:14Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0ab93aaa7a4f34f49'}, 'responseElements': {'requestId': 'dc1f5a72-1164-4f79-9bcc-0f782bd54bce', '_return': True}, 'requestID': 'dc1f5a72-1164-4f79-9bcc-0f782bd54bce', 'eventID': '577c233f-d41a-4141-b628-524db9fd27d7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:47,334 - INFO - delete security_group - ['sg-0ab93aaa7a4f34f49']
2021-06-06 12:30:47,377 - INFO - Get previous translated snapshot with timestamp 1622971842367 took 0.04 seconds
2021-06-06 12:30:47,379 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:30:47,379 - WARNING - Failed to handle message: tried to remove an old resource sg-0ab93aaa7a4f34f49, but it doesn't exist.
2021-06-06 12:30:47,379 - INFO - adding message to failed events queue for retry
2021-06-06 12:30:47,545 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:23.518Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:30:47,787 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:26.931Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:47,971 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:27.913Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc', 'version': 4.0, 'tags': {}}
2021-06-06 12:30:48,127 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:40.446Z, account_id: N/A, extra:{'agentConnected': True, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'ec2InstanceId': 'i-0de0fd033ca956c3f', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'INACTIVE', 'version': 7, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:43.551Z', 'registeredAt': '2021-06-06T09:08:47.166Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:30:48,358 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:40.956Z, account_id: N/A, extra:{'attachments': [{'id': 'de002c3f-dae2-44ed-a079-6a05cda8e208', 'type': 'eni', 'status': 'DELETED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-03cb776612d14e182'}, {'name': 'macAddress', 'value': '12:e9:e3:cc:21:5f'}, {'name': 'privateDnsName', 'value': 'ip-172-31-7-163.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.7.163'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:24:27.599Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/a5ceabe93826456fa0af136c71dedbf7', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17/5f88ada6-6f0f-4b44-9c4c-e52eb52222e4', 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17', 'networkInterfaces': [{'attachmentId': 'de002c3f-dae2-44ed-a079-6a05cda8e208', 'privateIpv4Address': '172.31.7.163'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:24:27.599Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'STOPPED', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'startedBy': 'ecs-svc/3384641070202511327', 'stoppingAt': '2021-06-06T09:24:43.551Z', 'stoppedAt': '2021-06-06T09:25:40.601Z', 'stoppedReason': 'Host EC2 (instance i-0de0fd033ca956c3f) terminated.', 'stopCode': 'TerminationNotice', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/5aada34b31564518b7ebe9d94905ba17', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:25:40.601Z', 'version': 3}
2021-06-06 12:30:48,606 - INFO - User N/A (ecs.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:49Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:46Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:25:49Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-026ba384964109468'}, 'responseElements': {'requestId': '6cd5a6fd-3bc2-4f74-bb2f-ca087cd88104', '_return': True}, 'requestID': '6cd5a6fd-3bc2-4f74-bb2f-ca087cd88104', 'eventID': '760ed34b-e40d-4a1f-ab4f-77c3d747a762', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:48,606 - INFO - delete network_interface - ['eni-026ba384964109468']
2021-06-06 12:30:48,653 - INFO - Get previous translated snapshot with timestamp 1622971842367 took 0.05 seconds
2021-06-06 12:30:48,655 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:30:48,655 - WARNING - Failed to handle message: tried to remove an old resource eni-026ba384964109468, but it doesn't exist.
2021-06-06 12:30:48,655 - INFO - adding message to failed events queue for retry
2021-06-06 12:30:50,088 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteLaunchConfiguration in us-east-1 at 2021-06-06T09:27:42Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:27:42Z', 'eventSource': 'autoscaling.amazonaws.com', 'eventName': 'DeleteLaunchConfiguration', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'launchConfigurationName': 'terraform-20210606090725817600000006'}, 'responseElements': None, 'requestID': 'de055912-ffd6-4302-ba5c-b64b1452ee05', 'eventID': 'bba81aed-5c4d-4b02-a6c7-a792b885f5e9', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:50,088 - INFO - delete launch_configuration - []
2021-06-06 12:30:50,107 - INFO - Get previous translated snapshot with timestamp 1622971842367 took 0.02 seconds
2021-06-06 12:30:50,109 - INFO - delete launch_configuration: arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:afdfdc9a-bdf2-46af-a2fd-362f016a3acf:launchConfigurationName/terraform-20210606090725817600000006 (deleted by key: LaunchConfigurationName, value: terraform-20210606090725817600000006)
2021-06-06 12:30:50,110 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'launch_configuration': [{'ImageId': 'ami-0f06fc190dd71269e', 'InstanceType': 't2.micro', 'LaunchConfigurationARN': 'arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:afdfdc9a-bdf2-46af-a2fd-362f016a3acf:launchConfigurationName/terraform-20210606090725817600000006', 'LaunchConfigurationName': 'terraform-20210606090725817600000006', 'resource_id': 'arn:aws:autoscaling:us-east-1:139614369439:launchConfiguration:afdfdc9a-bdf2-46af-a2fd-362f016a3acf:launchConfigurationName/terraform-20210606090725817600000006'}]}}}, 'previous_timestamp': 1622971842367}
2021-06-06 12:30:50,168 - INFO - Calling modeler on-new-snapshot for timestamp 1622971850088 ...
2021-06-06 12:30:50,184 - INFO - Calling analyzer for timestamp 1622971850088 ...
2021-06-06 12:30:53,157 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:53,157 - INFO - Finished triggering everything for timestamp 1622971850088 after 3.06 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.95)]
2021-06-06 12:30:54,644 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRole in us-east-1 at 2021-06-06T09:24:55Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:55Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeleteRole', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role_lambda'}, 'responseElements': None, 'requestID': '7f1112a2-3638-4d3b-9864-e1b563b32f2a', 'eventID': 'f1c272cc-6402-4a61-a6cf-5b031a5246c7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:54,645 - INFO - delete iam_role - ['arn:aws:iam::139614369439:role/test_role_lambda']
2021-06-06 12:30:54,645 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_lambda']}]}}}
2021-06-06 12:30:56,498 - INFO - scanned resources: {}
2021-06-06 12:30:56,498 - WARNING - no resources returned by scan 139614369439/Global: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_lambda']}]}}}
2021-06-06 12:30:56,528 - INFO - Get previous translated snapshot with timestamp 1622971850088 took 0.03 seconds
2021-06-06 12:30:56,530 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {'iam_role': [{'Arn': 'arn:aws:iam::139614369439:role/test_role_lambda', 'RoleName': 'test_role_lambda', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_lambda'}]}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971850088}
2021-06-06 12:30:56,582 - INFO - Calling modeler on-new-snapshot for timestamp 1622971856499 ...
2021-06-06 12:30:56,605 - INFO - Calling analyzer for timestamp 1622971856499 ...
2021-06-06 12:30:59,626 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:30:59,626 - INFO - Finished triggering everything for timestamp 1622971856499 after 3.10 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('store_classified', 0.01), ('store_ct_event', 0.02), ('modeler', 0.02), ('set_complete', 0.02), ('validate_timestamp', 0.02), ('analyzer', 2.99)]
2021-06-06 12:30:59,858 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteService in us-east-1 at 2021-06-06T09:24:47Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:47Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'DeleteService', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'cluster': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'service': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service'}, 'responseElements': {'service': {'serviceArn': 'arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service', 'serviceName': 'test_ecs_service', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'loadBalancers': [], 'serviceRegistries': [], 'status': 'DRAINING', 'desiredCount': 0, 'runningCount': 0, 'pendingCount': 0, 'launchType': 'EC2', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'deploymentConfiguration': {'deploymentCircuitBreaker': {'enable': False, 'rollback': False}, 'maximumPercent': 200, 'minimumHealthyPercent': 100}, 'deployments': [{'id': 'ecs-svc/3384641070202511327', 'status': 'PRIMARY', 'taskDefinition': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'desiredCount': 0, 'pendingCount': 0, 'runningCount': 0, 'failedTasks': 0, 'createdAt': 'Jun 6, 2021 9:07:20 AM', 'updatedAt': 'Jun 6, 2021 9:24:46 AM', 'launchType': 'EC2', 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'DISABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'rolloutState': 'COMPLETED', 'rolloutStateReason': 'ECS deployment ecs-svc/3384641070202511327 completed.'}], 'roleArn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'version': 0, 'events': [{'id': 'd13f22b7-494d-4580-a470-481cdf56029c', 'createdAt': 'Jun 6, 2021 9:24:27 AM', 'message': '(service test_ecs_service) has started 1 tasks: (task 5aada34b31564518b7ebe9d94905ba17).'}, {'id': '6c9988e5-8392-412b-9999-feee811c79f9', 'createdAt': 'Jun 6, 2021 9:09:14 AM', 'message': '(service test_ecs_service) has reached a steady state.'}, {'id': '431719b0-f8d0-4f29-9383-2f8187d0bf17', 'createdAt': 'Jun 6, 2021 9:09:14 AM', 'message': '(service test_ecs_service) (deployment ecs-svc/3384641070202511327) deployment completed.'}, {'id': '5907dddc-5239-4f0d-8c6a-3ab7e30e043e', 'createdAt': 'Jun 6, 2021 9:08:43 AM', 'message': '(service test_ecs_service) has started 1 tasks: (task 06b184bb6d7b4e33bd34ffec0bca0d21).'}, {'id': '6fc921c2-0552-46d2-8003-f3dbfc31f22d', 'createdAt': 'Jun 6, 2021 9:08:32 AM', 'message': '(service test_ecs_service) has started 1 tasks: (task a9563278c05840f280ee5b023cdf641c).'}, {'id': 'fe9dd208-586b-421f-87db-8bf820485b29', 'createdAt': 'Jun 6, 2021 9:07:28 AM', 'message': '(service test_ecs_service) was unable to place a task because no container instance met all of its requirements. Reason: No Container Instances were found in your cluster. For more information, see the Troubleshooting section of the Amazon ECS Developer Guide.'}], 'createdAt': 'Jun 6, 2021 9:07:20 AM', 'placementConstraints': [], 'placementStrategy': [], 'networkConfiguration': {'awsvpcConfiguration': {'assignPublicIp': 'DISABLED', 'securityGroups': [], 'subnets': ['subnet-0e7e54192b01b1ed0']}}, 'schedulingStrategy': 'REPLICA', 'createdBy': 'arn:aws:iam::139614369439:root', 'enableECSManagedTags': False, 'propagateTags': 'NONE', 'enableExecuteCommand': False}}, 'requestID': 'b873d191-0acf-4773-86ac-ca473795b877', 'eventID': '51d89c6e-7b34-4b49-aae0-b4cf62e509e8', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:30:59,866 - INFO - remove service - ['arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster..arn:aws:ecs:us-east-1:139614369439:service/test_ecs_cluster/test_ecs_service']
2021-06-06 12:30:59,890 - INFO - Get previous translated snapshot with timestamp 1622971856499 took 0.02 seconds
2021-06-06 12:30:59,890 - WARNING - Failed to handle message: tried to get modify subresource of type service but didn't find its parent arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster
2021-06-06 12:30:59,890 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:00,055 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachInternetGateway in us-east-1 at 2021-06-06T09:24:59Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:59Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-03414e5caa8b42cbd', 'vpcId': 'vpc-05c66fc27c8de6f73'}, 'responseElements': {'requestId': '4db25ecb-9f8c-4847-8ef2-30e0afb15a02', '_return': True}, 'requestID': '4db25ecb-9f8c-4847-8ef2-30e0afb15a02', 'eventID': '7b71b962-814c-48b4-9d23-26adef8f3b54', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:00,055 - INFO - remove internet_gateway_attachment - ['igw-03414e5caa8b42cbd..vpc-05c66fc27c8de6f73']
2021-06-06 12:31:00,091 - INFO - Get previous translated snapshot with timestamp 1622971856499 took 0.04 seconds
2021-06-06 12:31:00,094 - WARNING - Failed to handle message: tried to get modify subresource of type internet_gateway_attachment but didn't find its parent igw-03414e5caa8b42cbd
2021-06-06 12:31:00,094 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:00,245 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:03Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:03Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-0a706f920632fbcb6'}, 'responseElements': {'requestId': 'e2b5812e-b7b4-4fc7-a124-33f66779a0a4', '_return': True}, 'requestID': 'e2b5812e-b7b4-4fc7-a124-33f66779a0a4', 'eventID': 'a103fdc5-9637-4529-97d6-567ba3b26db8', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:00,245 - INFO - delete network_interface - ['eni-0a706f920632fbcb6']
2021-06-06 12:31:00,273 - INFO - Get previous translated snapshot with timestamp 1622971856499 took 0.03 seconds
2021-06-06 12:31:00,277 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'eni-attach-056fac750e28eb500', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1f', 'DeviceIndex': 0, 'DnsName': 'ip-10-10-10-230.ec2.internal', 'GroupId': ['sg-0aa68cd0fc33a9815'], 'InstanceId': 'i-036266a196e3f9d88', 'InterfaceType': 'interface', 'MacAddress': '16:2e:9e:7b:ea:45', 'NetworkInterfaceId': 'eni-0a706f920632fbcb6', 'PrivateIpAddress': '10.10.10.230', 'SourceDestCheck': True, 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0a706f920632fbcb6', 'PrivateIpAddress': '10.10.10.230', 'resource_id': 'eni-0a706f920632fbcb6..10.10.10.230'}], 'resource_id': 'eni-0a706f920632fbcb6', 'tag': [{'Key': 'Name', 'Value': 'test_interface_1', 'resource_id': 'eni-0a706f920632fbcb6..Name'}]}]}}}, 'previous_timestamp': 1622971856499}
2021-06-06 12:31:00,370 - INFO - Calling modeler on-new-snapshot for timestamp 1622971860245 ...
2021-06-06 12:31:00,419 - INFO - Calling analyzer for timestamp 1622971860245 ...
2021-06-06 12:31:04,200 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:04,201 - INFO - Finished triggering everything for timestamp 1622971860245 after 3.92 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_sub_events', 0.02), ('store_classified', 0.02), ('store_trans', 0.03), ('modeler', 0.05), ('analyzer', 3.76)]
2021-06-06 12:31:04,365 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:08Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:08Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-0de590e5164d4e8b3'}, 'responseElements': {'requestId': '97c8db72-f190-464a-88dc-929a0a727f54', '_return': True}, 'requestID': '97c8db72-f190-464a-88dc-929a0a727f54', 'eventID': '6f38d8d7-ee43-4976-8d5b-a813d56882bc', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:04,365 - INFO - delete network_interface - ['eni-0de590e5164d4e8b3']
2021-06-06 12:31:04,407 - INFO - Get previous translated snapshot with timestamp 1622971860245 took 0.04 seconds
2021-06-06 12:31:04,409 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:04,409 - WARNING - Failed to handle message: tried to remove an old resource eni-0de590e5164d4e8b3, but it doesn't exist.
2021-06-06 12:31:04,409 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:04,568 - INFO - Invalid event id - User N/A (N/A) performed SERVICE_STEADY_STATE in N/A at 2021-06-06T09:25:13.524Z, account_id: N/A, extra:{'eventType': 'INFO', 'eventName': 'SERVICE_STEADY_STATE', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'createdAt': '2021-06-06T09:25:12.394Z'}
2021-06-06 12:31:04,759 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:14.856Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:04,979 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:26.610Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'security-group', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:06,002 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:40.240Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'network-interface', 'version': 2.0, 'tags': {}}
2021-06-06 12:31:06,152 - INFO - User N/A (ecs.amazonaws.com) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:47Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:25:40Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'networkInterfaceId': 'eni-03cb776612d14e182'}, 'responseElements': {'requestId': 'bfefe406-09fd-41a5-8a48-f6ece84c9949', '_return': True}, 'requestID': 'bfefe406-09fd-41a5-8a48-f6ece84c9949', 'eventID': 'cb3d2ca0-21bf-4b74-9571-d5720e392915', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:06,152 - INFO - delete network_interface - ['eni-03cb776612d14e182']
2021-06-06 12:31:06,172 - INFO - Get previous translated snapshot with timestamp 1622971860245 took 0.02 seconds
2021-06-06 12:31:06,174 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:06,174 - WARNING - Failed to handle message: tried to remove an old resource eni-03cb776612d14e182, but it doesn't exist.
2021-06-06 12:31:06,175 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:07,026 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteInstanceProfile in us-east-1 at 2021-06-06T09:26:40Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:40Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeleteInstanceProfile', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceProfileName': 'test_profile'}, 'responseElements': None, 'requestID': 'e30a3fb2-e092-44d0-8ca2-6d007ce0d549', 'eventID': 'c8b1f40a-6280-4afe-85d8-be4debc3488b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:07,027 - INFO - delete instance_profile - ['arn:aws:iam::139614369439:instance-profile/test_profile']
2021-06-06 12:31:07,052 - INFO - Get previous translated snapshot with timestamp 1622971860245 took 0.03 seconds
2021-06-06 12:31:07,054 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {'instance_profile': [{'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'Name': 'test_profile', 'RoleName': 'test_role', 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile'}]}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971860245}
2021-06-06 12:31:07,107 - INFO - Calling modeler on-new-snapshot for timestamp 1622971867027 ...
2021-06-06 12:31:07,133 - INFO - Calling analyzer for timestamp 1622971867027 ...
2021-06-06 12:31:10,136 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:10,136 - INFO - Finished triggering everything for timestamp 1622971867027 after 3.07 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('modeler', 0.02), ('analyzer', 2.98)]
2021-06-06 12:31:10,403 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSecurityGroup in us-east-1 at 2021-06-06T09:26:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:41Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0bf342c26b99f93f2'}, 'responseElements': {'requestId': '4fb75d01-e094-4e1d-8a96-ff3e81b97e73', '_return': True}, 'requestID': '4fb75d01-e094-4e1d-8a96-ff3e81b97e73', 'eventID': 'd49c311f-d612-4e7f-b7af-70307e730fde', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:10,403 - INFO - delete security_group - ['sg-0bf342c26b99f93f2']
2021-06-06 12:31:10,445 - INFO - Get previous translated snapshot with timestamp 1622971867027 took 0.04 seconds
2021-06-06 12:31:10,447 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:10,447 - WARNING - Failed to handle message: tried to remove an old resource sg-0bf342c26b99f93f2, but it doesn't exist.
2021-06-06 12:31:10,447 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:10,615 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRole in us-east-1 at 2021-06-06T09:26:42Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:42Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeleteRole', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role'}, 'responseElements': None, 'requestID': '4c7a06c3-9a33-4aee-87cb-b63922f834fc', 'eventID': '35c41a1b-b0ae-4618-86e6-eca9f7e2456b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:10,616 - INFO - delete iam_role - ['arn:aws:iam::139614369439:role/test_role']
2021-06-06 12:31:10,616 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role']}]}}}
2021-06-06 12:31:11,675 - INFO - scanned resources: {}
2021-06-06 12:31:11,675 - WARNING - no resources returned by scan 139614369439/Global: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role']}]}}}
2021-06-06 12:31:11,696 - INFO - Get previous translated snapshot with timestamp 1622971867027 took 0.02 seconds
2021-06-06 12:31:11,699 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {'iam_role': [{'Arn': 'arn:aws:iam::139614369439:role/test_role', 'Path': '/', 'RoleId': 'AROASBANKG2P3IMZGGK33', 'RoleName': 'test_role', 'resource_id': 'arn:aws:iam::139614369439:role/test_role'}]}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971867027}
2021-06-06 12:31:11,758 - INFO - Calling modeler on-new-snapshot for timestamp 1622971871676 ...
2021-06-06 12:31:11,782 - INFO - Calling analyzer for timestamp 1622971871676 ...
2021-06-06 12:31:14,881 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:14,882 - INFO - Finished triggering everything for timestamp 1622971871676 after 3.18 seconds! times: [('store_sub_events', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('modeler', 0.02), ('analyzer', 3.08)]
2021-06-06 12:31:15,100 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:45.966Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:15,261 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:27:01.348Z, account_id: N/A, extra:{'Origin': 'AutoScalingGroup', 'Destination': 'EC2', 'Description': 'Terminating EC2 instance: i-0bc9c6152477ce465', 'EndTime': '2021-06-06T09:27:00.934Z', 'RequestId': '85ac2ba0-3ae2-44d9-a7f9-d8c65235de24', 'ActivityId': '85ac2ba0-3ae2-44d9-a7f9-d8c65235de24', 'StartTime': '2021-06-06T09:24:38.332Z', 'EC2InstanceId': 'i-0bc9c6152477ce465', 'StatusCode': 'InProgress', 'StatusMessage': '', 'Details': {'Availability Zone': 'us-east-1a'}, 'Cause': 'At 2021-06-06T09:24:18Z a user request update of AutoScalingGroup constraints to min: 0, max: 0, desired: 0 changing the desired capacity from 2 to 0.  At 2021-06-06T09:24:38Z an instance was taken out of service in response to a difference between desired and actual capacity, shrinking the capacity from 2 to 0.  At 2021-06-06T09:24:38Z instance i-0bc9c6152477ce465 was selected for termination.  At 2021-06-06T09:24:38Z instance i-0de0fd033ca956c3f was selected for termination.', 'AutoScalingGroupName': 'test_autoscaling_group'}
2021-06-06 12:31:15,415 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteInstanceProfile in us-east-1 at 2021-06-06T09:27:44Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:27:44Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeleteInstanceProfile', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceProfileName': 'test_profile_ecs'}, 'responseElements': None, 'requestID': 'fb2002f0-a26e-43d3-bd7c-157aa9c54b35', 'eventID': '45eb18b2-8c4d-447f-87a4-5674df82003b', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:15,418 - INFO - delete instance_profile - ['arn:aws:iam::139614369439:instance-profile/test_profile_ecs']
2021-06-06 12:31:15,441 - INFO - Get previous translated snapshot with timestamp 1622971871676 took 0.02 seconds
2021-06-06 12:31:15,444 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {'instance_profile': [{'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'Name': 'test_profile_ecs', 'RoleName': 'test_role_ecs', 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs'}]}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971871676}
2021-06-06 12:31:15,500 - INFO - Calling modeler on-new-snapshot for timestamp 1622971875419 ...
2021-06-06 12:31:15,526 - INFO - Calling analyzer for timestamp 1622971875419 ...
2021-06-06 12:31:18,692 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:18,692 - INFO - Finished triggering everything for timestamp 1622971875419 after 3.25 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('modeler', 0.03), ('analyzer', 3.15)]
2021-06-06 12:31:19,239 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:32.174Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': 'f34d07e2-45f5-496e-ae22-188884dd12fc'}
2021-06-06 12:31:19,524 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:44.384Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:19,725 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSecurityGroup in us-east-1 at 2021-06-06T09:26:41Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:41Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSecurityGroup', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'groupId': 'sg-0aa68cd0fc33a9815'}, 'responseElements': {'requestId': 'e3461b0d-4ebd-4004-a516-66be86790230', '_return': True}, 'requestID': 'e3461b0d-4ebd-4004-a516-66be86790230', 'eventID': 'd3587fd7-d034-45c8-a823-d0a16ab4cc61', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:19,725 - INFO - delete security_group - ['sg-0aa68cd0fc33a9815']
2021-06-06 12:31:19,776 - INFO - Get previous translated snapshot with timestamp 1622971875419 took 0.05 seconds
2021-06-06 12:31:19,778 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:19,778 - WARNING - Failed to handle message: tried to remove an old resource sg-0aa68cd0fc33a9815, but it doesn't exist.
2021-06-06 12:31:19,778 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:19,926 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:54.587Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': 'aa251a94-ab4d-4c8f-8336-fb2230cf1444'}
2021-06-06 12:31:20,840 - INFO - Ignoring failed event - User N/A ([APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]) performed DeleteBucket in us-east-1 at 2021-06-06T09:23:57Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:57Z', 'eventSource': 's3.amazonaws.com', 'eventName': 'DeleteBucket', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': '[APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)]', 'errorCode': 'BucketNotEmpty', 'errorMessage': 'The bucket you tried to delete is not empty', 'requestParameters': {'bucketName': 'll-test-bucket-2796885', 'Host': 'll-test-bucket-2796885.s3.amazonaws.com'}, 'responseElements': None, 'additionalEventData': {'SignatureVersion': 'SigV4', 'CipherSuite': 'ECDHE-RSA-AES128-GCM-SHA256', 'bytesTransferredIn': 0, 'AuthenticationMethod': 'AuthHeader', 'x-amz-id-2': 'cZCxdj0QE/t4hRhG11bDgvc41sz6nmPnsECJr9KTQyA7r4o5CulUiJ4uQN52u8q9WjYQq6TXMg0=', 'bytesTransferredOut': 322}, 'requestID': '4D15F9DVBYHE0C18', 'eventID': 'c4b65283-5ee6-4307-a572-c4fbbe3d9249', 'readOnly': False, 'resources': [{'accountId': '139614369439', 'type': 'AWS::S3::Bucket', 'ARN': 'arn:aws:s3:::ll-test-bucket-2796885'}], 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: BucketNotEmpty, message: The bucket you tried to delete is not empty)
2021-06-06 12:31:20,986 - INFO - Invalid event id - User N/A (N/A) performed ResourceStateChange in N/A at 2021-06-06T09:24:02.978Z, account_id: N/A, extra:{'instance-id': 'i-09e2d3e3d9fdb48cf', 'state': 'shutting-down'}
2021-06-06 12:31:21,260 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpcEndpoints in us-east-1 at 2021-06-06T09:23:59Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:23:59Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpcEndpoints', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'DeleteVpcEndpointsRequest': {'VpcEndpointId': {'tag': 1, 'content': 'vpce-0d1d518d7409fbde1'}}}, 'responseElements': {'DeleteVpcEndpointsResponse': {'xmlns': 'http://ec2.amazonaws.com/doc/2016-11-15/', 'requestId': 'ccc4337d-e271-4841-9acc-599f040639e8', 'unsuccessful': ''}}, 'requestID': 'ccc4337d-e271-4841-9acc-599f040639e8', 'eventID': 'a5626604-b76c-458f-905f-0f827fe9ad80', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:21,260 - INFO - delete vpc_endpoint - ['vpce-0d1d518d7409fbde1']
2021-06-06 12:31:21,280 - INFO - Get previous translated snapshot with timestamp 1622971875419 took 0.02 seconds
2021-06-06 12:31:21,284 - INFO - delete network_interface: eni-0da63c24f4daac6c6 (deleted by key: Description, value: VPC Endpoint Interface vpce-0d1d518d7409fbde1)
2021-06-06 12:31:21,284 - INFO - delete network_interface: eni-087028d62811d2370 (deleted by key: Description, value: VPC Endpoint Interface vpce-0d1d518d7409fbde1)
2021-06-06 12:31:21,284 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_interface': [{'AttachmentId': 'ela-attach-0b6f0641414c776fe', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1b', 'Description': 'VPC Endpoint Interface vpce-0d1d518d7409fbde1', 'DeviceIndex': 1, 'DnsName': 'ip-10-20-110-89.ec2.internal', 'GroupId': ['sg-054bffda9ef94c861'], 'InterfaceType': 'vpc_endpoint', 'MacAddress': '0a:5c:79:12:6b:1f', 'NetworkInterfaceId': 'eni-0da63c24f4daac6c6', 'PrivateIpAddress': '10.20.110.89', 'SourceDestCheck': True, 'SubnetId': 'subnet-0f126dcb2bfa10c61', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-0da63c24f4daac6c6', 'PrivateIpAddress': '10.20.110.89', 'resource_id': 'eni-0da63c24f4daac6c6..10.20.110.89'}], 'resource_id': 'eni-0da63c24f4daac6c6'}, {'AttachmentId': 'ela-attach-03387ce6bc5e88d60', 'AttachmentStatus': 'attached', 'AvailabilityZone': 'us-east-1a', 'Description': 'VPC Endpoint Interface vpce-0d1d518d7409fbde1', 'DeviceIndex': 1, 'DnsName': 'ip-10-20-100-222.ec2.internal', 'GroupId': ['sg-054bffda9ef94c861'], 'InterfaceType': 'vpc_endpoint', 'MacAddress': '12:d9:0a:bf:ae:df', 'NetworkInterfaceId': 'eni-087028d62811d2370', 'PrivateIpAddress': '10.20.100.222', 'SourceDestCheck': True, 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'private_ip_address': [{'NetworkInterfaceId': 'eni-087028d62811d2370', 'PrivateIpAddress': '10.20.100.222', 'resource_id': 'eni-087028d62811d2370..10.20.100.222'}], 'resource_id': 'eni-087028d62811d2370'}], 'vpc_endpoint': [{'NetworkInterfaceIds': ['eni-087028d62811d2370', 'eni-0da63c24f4daac6c6'], 'RouteTableIds': [], 'ServiceName': 'com.amazonaws.us-east-1.sqs', 'VpcEndpointId': 'vpce-0d1d518d7409fbde1', 'VpcEndpointType': 'Interface', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'vpce-0d1d518d7409fbde1', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_endpoint_sqs', 'resource_id': 'vpce-0d1d518d7409fbde1..Name'}]}]}}}, 'previous_timestamp': 1622971875419}
2021-06-06 12:31:21,352 - INFO - Calling modeler on-new-snapshot for timestamp 1622971881261 ...
2021-06-06 12:31:21,462 - INFO - Calling analyzer for timestamp 1622971881261 ...
2021-06-06 12:31:24,537 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:24,537 - INFO - Finished triggering everything for timestamp 1622971881261 after 3.25 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.03), ('modeler', 0.11), ('analyzer', 3.05)]
2021-06-06 12:31:24,731 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:16Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:16Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-04dc995f4339a463c'}, 'responseElements': {'requestId': '678d060b-dcc6-4199-9104-f446f3affba2', '_return': True}, 'requestID': '678d060b-dcc6-4199-9104-f446f3affba2', 'eventID': 'ec9189ae-5c03-4363-82d9-93475fd3105c', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:24,731 - INFO - delete network_interface - ['eni-04dc995f4339a463c']
2021-06-06 12:31:24,750 - INFO - Get previous translated snapshot with timestamp 1622971881261 took 0.02 seconds
2021-06-06 12:31:24,751 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:24,752 - WARNING - Failed to handle message: tried to remove an old resource eni-04dc995f4339a463c, but it doesn't exist.
2021-06-06 12:31:24,752 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:24,906 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed TerminateInstances in us-east-1 at 2021-06-06T09:24:13Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:13Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'TerminateInstances', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instancesSet': {'items': [{'instanceId': 'i-036266a196e3f9d88'}]}}, 'responseElements': {'instancesSet': {'items': [{'instanceId': 'i-036266a196e3f9d88', 'currentState': {'code': 32, 'name': 'shutting-down'}, 'previousState': {'code': 16, 'name': 'running'}}]}}, 'requestID': '5ee307f7-3c74-4918-863d-977211783eef', 'eventID': '4274c738-4aa0-41e7-a41e-00149f0565e3', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:24,906 - INFO - delete instance - ['i-036266a196e3f9d88']
2021-06-06 12:31:24,931 - INFO - Get previous translated snapshot with timestamp 1622971881261 took 0.02 seconds
2021-06-06 12:31:24,938 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'instance': [{'ImageId': 'ami-00ddb0e5626798373', 'InstanceId': 'i-036266a196e3f9d88', 'InstanceProfile': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'InstanceType': 't2.micro', 'PrivateIpAddress': '10.10.10.230', 'SourceDestCheck': True, 'State': 'pending', 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'i-036266a196e3f9d88', 'tag': [{'Key': 'Name', 'Value': 'test-instance_1', 'resource_id': 'i-036266a196e3f9d88..Name'}]}]}}}, 'previous_timestamp': 1622971881261}
2021-06-06 12:31:24,998 - INFO - Calling modeler on-new-snapshot for timestamp 1622971884907 ...
2021-06-06 12:31:25,025 - INFO - Calling analyzer for timestamp 1622971884907 ...
2021-06-06 12:31:28,193 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:28,193 - INFO - Finished triggering everything for timestamp 1622971884907 after 3.26 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.02), ('modeler', 0.03), ('analyzer', 3.15)]
2021-06-06 12:31:28,516 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRouteTable in us-east-1 at 2021-06-06T09:24:29Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:29Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteRouteTable', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'routeTableId': 'rtb-03fcccaea3c63eeb1'}, 'responseElements': {'requestId': 'fbf87746-b468-4e47-9213-a0757fba24a4', '_return': True}, 'requestID': 'fbf87746-b468-4e47-9213-a0757fba24a4', 'eventID': '64238bd2-8444-4e29-97f4-02ef67143161', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:28,516 - INFO - delete route_table - ['rtb-03fcccaea3c63eeb1']
2021-06-06 12:31:28,546 - INFO - Get previous translated snapshot with timestamp 1622971884907 took 0.03 seconds
2021-06-06 12:31:28,547 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:28,548 - WARNING - Failed to handle message: tried to remove an old resource rtb-03fcccaea3c63eeb1, but it doesn't exist.
2021-06-06 12:31:28,548 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:28,710 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:31Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:31Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-0f71530a3fcf6e27a'}, 'responseElements': {'requestId': '6d9cc3b5-26c5-4082-a42a-b13e45997a29', '_return': True}, 'requestID': '6d9cc3b5-26c5-4082-a42a-b13e45997a29', 'eventID': '6b21b141-6c1c-4e0a-846d-dc0434bfaa33', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:28,710 - INFO - delete network_interface - ['eni-0f71530a3fcf6e27a']
2021-06-06 12:31:28,736 - INFO - Get previous translated snapshot with timestamp 1622971884907 took 0.03 seconds
2021-06-06 12:31:28,738 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:28,738 - WARNING - Failed to handle message: tried to remove an old resource eni-0f71530a3fcf6e27a, but it doesn't exist.
2021-06-06 12:31:28,738 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:28,888 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:35.426Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': '516d9894-e74c-4396-9c2a-7612ef4bfb3d'}
2021-06-06 12:31:29,029 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:35.790Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:29,187 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:41.370Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:30,869 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:43.149Z, account_id: N/A, extra:{'agentConnected': False, 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'ec2InstanceId': 'i-0bc9c6152477ce465', 'registeredResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'remainingResources': [{'name': 'CPU', 'type': 'INTEGER', 'integerValue': 1024}, {'name': 'MEMORY', 'type': 'INTEGER', 'integerValue': 983}, {'name': 'PORTS', 'type': 'STRINGSET', 'stringSetValue': ['22', '2376', '2375', '51678', '51679']}, {'name': 'PORTS_UDP', 'type': 'STRINGSET', 'stringSetValue': []}], 'status': 'INACTIVE', 'version': 8, 'versionInfo': {'agentHash': 'e9b600d2', 'agentVersion': '1.48.1', 'dockerVersion': 'DockerVersion: 19.03.13-ce'}, 'updatedAt': '2021-06-06T09:24:42.694Z', 'registeredAt': '2021-06-06T09:08:43.39Z', 'pendingTasksCount': 0, 'runningTasksCount': 0, 'attachments': []}
2021-06-06 12:31:31,028 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:43.243Z, account_id: N/A, extra:{'attachments': [], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:08:44.536Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21/27d2b2e4-ed14-4822-8cc5-529b494b587a', 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': '9edb0f3e1345735cae6434c32e7f7e7fcfcc5a01ef2a2b7805e3c553a04fe968', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'networkInterfaces': [], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:08:43.958Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'DEPROVISIONING', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'pullStartedAt': '2021-06-06T09:09:06.37Z', 'pullStoppedAt': '2021-06-06T09:09:11.37Z', 'startedAt': '2021-06-06T09:09:12.37Z', 'startedBy': 'ecs-svc/3384641070202511327', 'stoppingAt': '2021-06-06T09:24:42.694Z', 'stoppedReason': 'Host EC2 (instance i-0bc9c6152477ce465) terminated.', 'stopCode': 'TerminationNotice', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:24:42.694Z', 'version': 4}
2021-06-06 12:31:31,279 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:24:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:39Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-08c5e41d5c820a59f'}, 'responseElements': {'requestId': '33a898b4-674f-4622-9710-6c847012ec02', '_return': True}, 'requestID': '33a898b4-674f-4622-9710-6c847012ec02', 'eventID': '86681ec2-2539-488c-960a-a7bfaf6985eb', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:31,280 - INFO - delete subnet - ['subnet-08c5e41d5c820a59f']
2021-06-06 12:31:31,301 - INFO - Get previous translated snapshot with timestamp 1622971884907 took 0.02 seconds
2021-06-06 12:31:31,303 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1c', 'CidrBlock': '10.40.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-08c5e41d5c820a59f', 'VpcId': 'vpc-0073beecbc61fd56a', 'resource_id': 'subnet-08c5e41d5c820a59f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_nat', 'resource_id': 'subnet-08c5e41d5c820a59f..Name'}]}]}}}, 'previous_timestamp': 1622971884907}
2021-06-06 12:31:31,359 - INFO - Calling modeler on-new-snapshot for timestamp 1622971891280 ...
2021-06-06 12:31:31,417 - INFO - Calling analyzer for timestamp 1622971891280 ...
2021-06-06 12:31:34,238 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:34,238 - INFO - Finished triggering everything for timestamp 1622971891280 after 2.95 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.06), ('analyzer', 2.8)]
2021-06-06 12:31:34,387 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:50.241Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'route-table', 'version': 2.0, 'tags': {}}
2021-06-06 12:31:34,544 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:50.674Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ecs', 'resource-type': 'service', 'version': 135.0, 'tags': {}}
2021-06-06 12:31:34,750 - INFO - User N/A (ecs.amazonaws.com) performed DetachNetworkInterface in us-east-1 at 2021-06-06T09:24:47Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2P3LUH6H3SH:ecs-eni-provisioning', 'arn': 'arn:aws:sts::139614369439:assumed-role/AWSServiceRoleForECS/ecs-eni-provisioning', 'accountId': '139614369439', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2P3LUH6H3SH', 'arn': 'arn:aws:iam::139614369439:role/aws-service-role/ecs.amazonaws.com/AWSServiceRoleForECS', 'accountId': '139614369439', 'userName': 'AWSServiceRoleForECS'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:24:46Z', 'mfaAuthenticated': 'false'}}, 'invokedBy': 'ecs.amazonaws.com'}, 'eventTime': '2021-06-06T09:24:47Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': 'ecs.amazonaws.com', 'userAgent': 'ecs.amazonaws.com', 'requestParameters': {'attachmentId': 'eni-attach-0c0fda177c90706e3', 'force': True}, 'responseElements': {'requestId': 'f21284b7-a225-4dd0-aefc-9e7f71998288', '_return': True}, 'requestID': 'f21284b7-a225-4dd0-aefc-9e7f71998288', 'eventID': 'cce9aeb7-b5c5-4025-8fe8-6c98d31fd666', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:34,750 - INFO - hard-modify network_interface - 
2021-06-06 12:31:34,786 - INFO - Got 1 inventory resources for type network_interface and attributes [{'key': 'AttachmentId', 'value': '^eni-attach-0c0fda177c90706e3$'}]
2021-06-06 12:31:34,786 - INFO - Scanning account/region 139614369439/us-east-1, filter: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-026ba384964109468']}]}}}
2021-06-06 12:31:35,813 - INFO - scanned resources: {}
2021-06-06 12:31:35,813 - WARNING - no resources returned by scan 139614369439/us-east-1: {'resources': {'network_interface': {'filters': [{'name': 'NetworkInterfaceId', 'values': ['eni-026ba384964109468']}]}}}
2021-06-06 12:31:35,835 - INFO - Get previous translated snapshot with timestamp 1622971891280 took 0.02 seconds
2021-06-06 12:31:35,837 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971891280}
2021-06-06 12:31:35,999 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:24:57.108Z, account_id: N/A, extra:{'attachments': [{'id': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'type': 'eni', 'status': 'DELETED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-06f56ed6ae2441c1a'}, {'name': 'macAddress', 'value': '12:05:3f:55:b9:67'}, {'name': 'privateDnsName', 'value': 'ip-172-31-10-216.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.10.216'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:07:31.704Z', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5/26f42af7-c017-41dd-ba39-990bb7251ee0', 'exitCode': 137, 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': 'd1e1021ba7f94e1ebc65385be8ed26c5-1576263027', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'networkInterfaces': [{'attachmentId': '32e3336b-1256-4b9f-ab2d-3ad0cebd5b8c', 'privateIpv4Address': '172.31.10.216'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:07:22.969Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'ephemeralStorage': {'sizeInGiB': 20}, 'executionStoppedAt': '2021-06-06T09:23:52.293Z', 'group': 'service:test_ecs_service_fargate', 'launchType': 'FARGATE', 'lastStatus': 'STOPPED', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'platformVersion': '1.4.0', 'pullStartedAt': '2021-06-06T09:07:54.432Z', 'pullStoppedAt': '2021-06-06T09:07:58.959Z', 'startedAt': '2021-06-06T09:08:01.314Z', 'startedBy': 'ecs-svc/8114543020074586516', 'stoppingAt': '2021-06-06T09:23:21.009Z', 'stoppedAt': '2021-06-06T09:24:56.885Z', 'stoppedReason': 'Scaling activity initiated by (deployment ecs-svc/8114543020074586516)', 'stopCode': 'ServiceSchedulerInitiated', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/d1e1021ba7f94e1ebc65385be8ed26c5', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition_fargate:21', 'updatedAt': '2021-06-06T09:24:56.885Z', 'version': 6}
2021-06-06 12:31:36,190 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:24:57Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:24:57Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-0e3f3fb9dcdfac2b0'}, 'responseElements': {'requestId': 'e18c7e17-595c-4503-a385-9b06f59b6db4', '_return': True}, 'requestID': 'e18c7e17-595c-4503-a385-9b06f59b6db4', 'eventID': 'f803f610-56fb-426c-a0cc-6e872059147d', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:36,191 - INFO - delete network_interface - ['eni-0e3f3fb9dcdfac2b0']
2021-06-06 12:31:36,228 - INFO - Get previous translated snapshot with timestamp 1622971891280 took 0.04 seconds
2021-06-06 12:31:36,231 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:36,231 - WARNING - Failed to handle message: tried to remove an old resource eni-0e3f3fb9dcdfac2b0, but it doesn't exist.
2021-06-06 12:31:36,231 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:36,497 - INFO - Ignoring failed event - User N/A (Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)) performed SubmitTaskStateChange in us-east-1 at 2021-06-06T09:24:44Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'AssumedRole', 'principalId': 'AROASBANKG2PWKCFXY3QR:i-0de0fd033ca956c3f', 'arn': 'arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f', 'accountId': '139614369439', 'accessKeyId': 'ASIASBANKG2PTWJOV2HX', 'sessionContext': {'sessionIssuer': {'type': 'Role', 'principalId': 'AROASBANKG2PWKCFXY3QR', 'arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'accountId': '139614369439', 'userName': 'test_role_ecs'}, 'webIdFederationData': {}, 'attributes': {'creationDate': '2021-06-06T09:07:40Z', 'mfaAuthenticated': 'false'}, 'ec2RoleDelivery': '2.0'}}, 'eventTime': '2021-06-06T09:24:44Z', 'eventSource': 'ecs.amazonaws.com', 'eventName': 'SubmitTaskStateChange', 'awsRegion': 'us-east-1', 'sourceIPAddress': '52.91.254.137', 'userAgent': 'Amazon ECS Agent - v1.48.1 (e9b600d2) (linux) (+http://aws.amazon.com/ecs/)', 'errorCode': 'AccessDenied', 'errorMessage': 'User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'requestParameters': None, 'responseElements': None, 'requestID': '5527ef33-8198-4979-b925-d09ea862206e', 'eventID': 'b5f818b9-473a-4e58-ae68-b8bca213144a', 'readOnly': True, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'} (code: AccessDenied, message: User: arn:aws:sts::139614369439:assumed-role/test_role_ecs/i-0de0fd033ca956c3f is not authorized to perform: ecs:SubmitTaskStateChange on resource: arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster)
2021-06-06 12:31:36,704 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:09.315Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': 'f05b5027-f91c-43fb-a52c-9554f4304a77'}
2021-06-06 12:31:37,472 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:25:07Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:07Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-080bf67267388f92d'}, 'responseElements': {'requestId': '50a7fb34-23c0-4bef-8e7f-a9aa54ceef64', '_return': True}, 'requestID': '50a7fb34-23c0-4bef-8e7f-a9aa54ceef64', 'eventID': '133f3436-d8b2-49af-a5db-4e46c0b7f957', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:37,472 - INFO - delete subnet - ['subnet-080bf67267388f92d']
2021-06-06 12:31:37,517 - INFO - Get previous translated snapshot with timestamp 1622971891280 took 0.04 seconds
2021-06-06 12:31:37,519 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1b', 'CidrBlock': '10.10.70.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-080bf67267388f92d', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-080bf67267388f92d', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_glb_2', 'resource_id': 'subnet-080bf67267388f92d..Name'}]}]}}}, 'previous_timestamp': 1622971891280}
2021-06-06 12:31:37,619 - INFO - Calling modeler on-new-snapshot for timestamp 1622971897473 ...
2021-06-06 12:31:37,650 - INFO - Calling analyzer for timestamp 1622971897473 ...
2021-06-06 12:31:40,867 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:40,867 - INFO - Finished triggering everything for timestamp 1622971897473 after 3.34 seconds! times: [('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_sub_events', 0.02), ('store_trans', 0.02), ('store_ct_event', 0.03), ('store_classified', 0.03), ('modeler', 0.03), ('analyzer', 3.19)]
2021-06-06 12:31:41,026 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:25:10Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:10Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0627eacfcbd2561b0'}, 'responseElements': {'requestId': '4cc66178-b2ac-435f-9a8b-a98477e7f83e', '_return': True}, 'requestID': '4cc66178-b2ac-435f-9a8b-a98477e7f83e', 'eventID': 'a2abd52b-ffd7-4607-826b-536fda3f66e2', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:41,027 - INFO - delete subnet - ['subnet-0627eacfcbd2561b0']
2021-06-06 12:31:41,067 - INFO - Get previous translated snapshot with timestamp 1622971897473 took 0.04 seconds
2021-06-06 12:31:41,070 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1f', 'CidrBlock': '10.10.10.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0627eacfcbd2561b0', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-0627eacfcbd2561b0', 'tag': [{'Key': 'Name', 'Value': 'test_subnet', 'resource_id': 'subnet-0627eacfcbd2561b0..Name'}]}]}}}, 'previous_timestamp': 1622971897473}
2021-06-06 12:31:41,128 - INFO - Calling modeler on-new-snapshot for timestamp 1622971901027 ...
2021-06-06 12:31:41,149 - INFO - Calling analyzer for timestamp 1622971901027 ...
2021-06-06 12:31:44,141 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:44,141 - INFO - Finished triggering everything for timestamp 1622971901027 after 3.08 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.97)]
2021-06-06 12:31:44,293 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DetachInternetGateway in us-east-1 at 2021-06-06T09:25:11Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:11Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DetachInternetGateway', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'internetGatewayId': 'igw-06702476ee8952114', 'vpcId': 'vpc-0073beecbc61fd56a'}, 'responseElements': {'requestId': '6760e319-5f25-43bc-84e0-9da714cbf40e', '_return': True}, 'requestID': '6760e319-5f25-43bc-84e0-9da714cbf40e', 'eventID': '8eb048c8-906f-4f61-ab4e-9b802521b2b7', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:44,293 - INFO - remove internet_gateway_attachment - ['igw-06702476ee8952114..vpc-0073beecbc61fd56a']
2021-06-06 12:31:44,336 - INFO - Get previous translated snapshot with timestamp 1622971901027 took 0.04 seconds
2021-06-06 12:31:44,338 - WARNING - Failed to handle message: tried to get modify subresource of type internet_gateway_attachment but didn't find its parent igw-06702476ee8952114
2021-06-06 12:31:44,338 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:44,494 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:25:11Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:11Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0807e0e2713d7c0ba'}, 'responseElements': {'requestId': '022c0653-6632-4f45-850c-6a4d551e1c13', '_return': True}, 'requestID': '022c0653-6632-4f45-850c-6a4d551e1c13', 'eventID': '73a706f6-766c-456d-8132-01568a373344', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:44,494 - INFO - delete subnet - ['subnet-0807e0e2713d7c0ba']
2021-06-06 12:31:44,520 - INFO - Get previous translated snapshot with timestamp 1622971901027 took 0.03 seconds
2021-06-06 12:31:44,523 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1a', 'CidrBlock': '10.20.100.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0807e0e2713d7c0ba', 'VpcId': 'vpc-0e42ef83fc1c69dba', 'resource_id': 'subnet-0807e0e2713d7c0ba', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_vpce_1', 'resource_id': 'subnet-0807e0e2713d7c0ba..Name'}]}]}}}, 'previous_timestamp': 1622971901027}
2021-06-06 12:31:44,580 - INFO - Calling modeler on-new-snapshot for timestamp 1622971904494 ...
2021-06-06 12:31:44,597 - INFO - Calling analyzer for timestamp 1622971904494 ...
2021-06-06 12:31:47,593 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:47,593 - INFO - Finished triggering everything for timestamp 1622971904494 after 3.07 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.97)]
2021-06-06 12:31:47,745 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteNetworkInterface in us-east-1 at 2021-06-06T09:25:13Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:13Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteNetworkInterface', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'networkInterfaceId': 'eni-04f12fbe3d839a33c'}, 'responseElements': {'requestId': 'f44eb535-f4a4-497a-b5fb-fdea1201ea66', '_return': True}, 'requestID': 'f44eb535-f4a4-497a-b5fb-fdea1201ea66', 'eventID': 'dc1f5c3b-0cd1-4f54-9429-2ba91d4894ff', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:47,745 - INFO - delete network_interface - ['eni-04f12fbe3d839a33c']
2021-06-06 12:31:47,781 - INFO - Get previous translated snapshot with timestamp 1622971904494 took 0.04 seconds
2021-06-06 12:31:47,782 - WARNING - BUG - tried to remove an old resource, but it doesn't exist! most likely the resource has some composite key with data that doesn't exist
2021-06-06 12:31:47,783 - WARNING - Failed to handle message: tried to remove an old resource eni-04f12fbe3d839a33c, but it doesn't exist.
2021-06-06 12:31:47,783 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:47,941 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:18.570Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'vpc', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:48,150 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteVpc in us-east-1 at 2021-06-06T09:25:24Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:25:24Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteVpc', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'vpcId': 'vpc-057a5616a3c33b91f'}, 'responseElements': {'requestId': 'b6a4e028-1056-4fb5-b491-7685934a265e', '_return': True}, 'requestID': 'b6a4e028-1056-4fb5-b491-7685934a265e', 'eventID': 'b01db8b8-a31d-405e-a4df-8ed120b3c017', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:48,150 - INFO - delete vpc - ['vpc-057a5616a3c33b91f']
2021-06-06 12:31:48,182 - INFO - Get previous translated snapshot with timestamp 1622971904494 took 0.03 seconds
2021-06-06 12:31:48,189 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'network_acl': [{'IsDefault': True, 'NetworkAclId': 'acl-0a3d5a8ebda221e6d', 'VpcId': 'vpc-057a5616a3c33b91f', 'acl_association': [{'AssociationId': 'aclassoc-4e89496f', 'NetworkAclId': 'acl-0a3d5a8ebda221e6d', 'SubnetId': 'subnet-08d77652f170b9861', 'resource_id': 'acl-0a3d5a8ebda221e6d..aclassoc-4e89496f'}], 'acl_entry': [{'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0a3d5a8ebda221e6d..100..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': True, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0a3d5a8ebda221e6d..32767..True'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'allow', 'RuleNumber': 100, 'resource_id': 'acl-0a3d5a8ebda221e6d..100..False'}, {'CidrBlock': '0.0.0.0/0', 'Egress': False, 'Protocol': '-1', 'RuleAction': 'deny', 'RuleNumber': 32767, 'resource_id': 'acl-0a3d5a8ebda221e6d..32767..False'}], 'resource_id': 'acl-0a3d5a8ebda221e6d'}], 'security_group': [{'GroupId': 'sg-0ed400d3d4511c44c', 'GroupName': 'default', 'VpcId': 'vpc-057a5616a3c33b91f', 'resource_id': 'sg-0ed400d3d4511c44c', 'security_egress_rule': [{'CidrIp': ['0.0.0.0/0'], 'DestinationGroupId': [], 'IpProtocol': '-1', 'PrefixListId': [], 'resource_id': 'sg-0ed400d3d4511c44c..all..0.0.0.0/0__egress_rule'}], 'security_ingress_rule': [{'CidrIp': [], 'IpProtocol': '-1', 'PrefixListId': [], 'SourceGroupId': ['sg-0ed400d3d4511c44c'], 'resource_id': 'sg-0ed400d3d4511c44c..all__ingress_rule'}]}], 'vpc': [{'CidrBlock': '10.30.0.0/16', 'IsDefault': False, 'State': 'pending', 'VpcId': 'vpc-057a5616a3c33b91f', 'cidr_association': [{'AssociationId': 'vpc-cidr-assoc-0301c2362da42a2be', 'CidrBlock': '10.30.0.0/16', 'VpcId': 'vpc-057a5616a3c33b91f', 'resource_id': 'vpc-057a5616a3c33b91f..10.30.0.0/16'}], 'resource_id': 'vpc-057a5616a3c33b91f', 'tag': [{'Key': 'Name', 'Value': 'test_vpc_2', 'resource_id': 'vpc-057a5616a3c33b91f..Name'}]}]}}}, 'previous_timestamp': 1622971904494}
2021-06-06 12:31:48,261 - INFO - Calling modeler on-new-snapshot for timestamp 1622971908150 ...
2021-06-06 12:31:48,305 - INFO - Calling analyzer for timestamp 1622971908150 ...
2021-06-06 12:31:51,358 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:51,358 - INFO - Finished triggering everything for timestamp 1622971908150 after 3.16 seconds! times: [('store_sub_events', 0.01), ('store_trans', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_classified', 0.03), ('modeler', 0.04), ('analyzer', 3.03)]
2021-06-06 12:31:51,535 - INFO - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:32.087Z, account_id: N/A, extra:{'result': 'deleted', 'cause': '', 'event': 'deleteVolume', 'request-id': 'e0e7b664-a5ed-4fef-9cac-a30b707b4536'}
2021-06-06 12:31:51,740 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:25:49.670Z, account_id: N/A, extra:{'attachments': [{'id': '37b6cac5-fc31-463f-89cc-3184f05413d5', 'type': 'eni', 'status': 'DELETED', 'details': [{'name': 'subnetId', 'value': 'subnet-0e7e54192b01b1ed0'}, {'name': 'networkInterfaceId', 'value': 'eni-026ba384964109468'}, {'name': 'macAddress', 'value': '12:5a:b8:61:34:4f'}, {'name': 'privateDnsName', 'value': 'ip-172-31-5-40.ec2.internal'}, {'name': 'privateIPv4Address', 'value': '172.31.5.40'}]}], 'availabilityZone': 'us-east-1a', 'clusterArn': 'arn:aws:ecs:us-east-1:139614369439:cluster/test_ecs_cluster', 'connectivity': 'CONNECTED', 'connectivityAt': '2021-06-06T09:08:44.536Z', 'containerInstanceArn': 'arn:aws:ecs:us-east-1:139614369439:container-instance/test_ecs_cluster/23af9275bf5741bbbf19266a1a198823', 'containers': [{'containerArn': 'arn:aws:ecs:us-east-1:139614369439:container/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21/27d2b2e4-ed14-4822-8cc5-529b494b587a', 'lastStatus': 'STOPPED', 'name': 'test_ecs_service', 'image': 'httpd:2.4', 'runtimeId': '9edb0f3e1345735cae6434c32e7f7e7fcfcc5a01ef2a2b7805e3c553a04fe968', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'networkInterfaces': [{'attachmentId': '37b6cac5-fc31-463f-89cc-3184f05413d5', 'privateIpv4Address': '172.31.5.40'}], 'cpu': '256', 'memory': '512'}], 'cpu': '256', 'createdAt': '2021-06-06T09:08:43.958Z', 'desiredStatus': 'STOPPED', 'enableExecuteCommand': False, 'group': 'service:test_ecs_service', 'launchType': 'EC2', 'lastStatus': 'STOPPED', 'memory': '512', 'overrides': {'containerOverrides': [{'name': 'test_ecs_service'}]}, 'pullStartedAt': '2021-06-06T09:09:06.37Z', 'pullStoppedAt': '2021-06-06T09:09:11.37Z', 'startedAt': '2021-06-06T09:09:12.37Z', 'startedBy': 'ecs-svc/3384641070202511327', 'stoppingAt': '2021-06-06T09:24:42.694Z', 'stoppedAt': '2021-06-06T09:25:49.463Z', 'stoppedReason': 'Host EC2 (instance i-0bc9c6152477ce465) terminated.', 'stopCode': 'TerminationNotice', 'taskArn': 'arn:aws:ecs:us-east-1:139614369439:task/test_ecs_cluster/06b184bb6d7b4e33bd34ffec0bca0d21', 'taskDefinitionArn': 'arn:aws:ecs:us-east-1:139614369439:task-definition/test_ecs_task_definition:273', 'updatedAt': '2021-06-06T09:25:49.463Z', 'version': 5}
2021-06-06 12:31:51,913 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RemoveRoleFromInstanceProfile in us-east-1 at 2021-06-06T09:26:39Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:39Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'RemoveRoleFromInstanceProfile', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceProfileName': 'test_profile', 'roleName': 'test_role'}, 'responseElements': None, 'requestID': '4655917c-99b0-47bc-bbdd-b897c4907659', 'eventID': 'd441424c-5b6d-4ef0-98c5-82befbc29cd6', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:51,913 - INFO - modify instance_profile - [{'Name': 'test_profile', 'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile', 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile'}]
2021-06-06 12:31:51,913 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'instance_profile': {'filters': [{'name': 'Arn', 'values': ['arn:aws:iam::139614369439:instance-profile/test_profile']}]}}}
2021-06-06 12:31:53,591 - INFO - scanned resources: {}
2021-06-06 12:31:53,591 - WARNING - no resources returned by scan 139614369439/Global: {'resources': {'instance_profile': {'filters': [{'name': 'Arn', 'values': ['arn:aws:iam::139614369439:instance-profile/test_profile']}]}}}
2021-06-06 12:31:53,638 - INFO - Get previous translated snapshot with timestamp 1622971908150 took 0.05 seconds
2021-06-06 12:31:53,640 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:31:53,640 - WARNING - Failed to handle message: tried to modify an old resource arn:aws:iam::139614369439:instance-profile/test_profile, but it doesn't exist.
2021-06-06 12:31:53,640 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:54,311 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:44.894Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'security-group', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:54,503 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:46.180Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'ec2', 'resource-type': 'subnet', 'version': 4.0, 'tags': {}}
2021-06-06 12:31:54,712 - INFO - Invalid event id - User N/A (N/A) performed N/A in N/A at 2021-06-06T09:26:46.370Z, account_id: N/A, extra:{'changed-tag-keys': ['Name'], 'service': 'rds', 'resource-type': 'db', 'version': 2.0, 'tags': {}}
2021-06-06 12:31:54,867 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteSubnet in us-east-1 at 2021-06-06T09:26:42Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:26:42Z', 'eventSource': 'ec2.amazonaws.com', 'eventName': 'DeleteSubnet', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'subnetId': 'subnet-0427564926cbfc43f'}, 'responseElements': {'requestId': '54acb114-6645-4393-b6b1-9078c97c3ebe', '_return': True}, 'requestID': '54acb114-6645-4393-b6b1-9078c97c3ebe', 'eventID': 'a89d5465-6ddd-469e-af33-751a7d2cac82', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:54,867 - INFO - delete subnet - ['subnet-0427564926cbfc43f']
2021-06-06 12:31:54,897 - INFO - Get previous translated snapshot with timestamp 1622971908150 took 0.03 seconds
2021-06-06 12:31:54,899 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {'subnet': [{'AvailabilityZone': 'us-east-1c', 'CidrBlock': '10.10.80.0/24', 'MapPublicIpOnLaunch': False, 'State': 'available', 'SubnetId': 'subnet-0427564926cbfc43f', 'VpcId': 'vpc-05c66fc27c8de6f73', 'resource_id': 'subnet-0427564926cbfc43f', 'tag': [{'Key': 'Name', 'Value': 'test_subnet_rds_1', 'resource_id': 'subnet-0427564926cbfc43f..Name'}]}]}}}, 'previous_timestamp': 1622971908150}
2021-06-06 12:31:54,955 - INFO - Calling modeler on-new-snapshot for timestamp 1622971914867 ...
2021-06-06 12:31:54,971 - INFO - Calling analyzer for timestamp 1622971914867 ...
2021-06-06 12:31:57,813 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:31:57,813 - INFO - Finished triggering everything for timestamp 1622971914867 after 2.93 seconds! times: [('store_sub_events', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('store_ct_event', 0.02), ('store_trans', 0.02), ('store_classified', 0.02), ('modeler', 0.02), ('analyzer', 2.82)]
2021-06-06 12:31:57,981 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed RemoveRoleFromInstanceProfile in us-east-1 at 2021-06-06T09:27:43Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:27:43Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'RemoveRoleFromInstanceProfile', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'instanceProfileName': 'test_profile_ecs', 'roleName': 'test_role_ecs'}, 'responseElements': None, 'requestID': '90e06c6c-6a16-4ac9-9c5a-b3bdbd62f887', 'eventID': '44a54279-6a32-4396-a3ec-713be940e5bf', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:57,981 - INFO - modify instance_profile - [{'Name': 'test_profile_ecs', 'Arn': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs', 'resource_id': 'arn:aws:iam::139614369439:instance-profile/test_profile_ecs'}]
2021-06-06 12:31:57,981 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'instance_profile': {'filters': [{'name': 'Arn', 'values': ['arn:aws:iam::139614369439:instance-profile/test_profile_ecs']}]}}}
2021-06-06 12:31:58,765 - INFO - scanned resources: {}
2021-06-06 12:31:58,765 - WARNING - no resources returned by scan 139614369439/Global: {'resources': {'instance_profile': {'filters': [{'name': 'Arn', 'values': ['arn:aws:iam::139614369439:instance-profile/test_profile_ecs']}]}}}
2021-06-06 12:31:58,791 - INFO - Get previous translated snapshot with timestamp 1622971914867 took 0.03 seconds
2021-06-06 12:31:58,793 - WARNING - BUG - tried to modify an old resource, but it doesn't exist! most likely you should map this event as an ADD to a sub-resource instead of MODIFY to a parent-resource
2021-06-06 12:31:58,793 - WARNING - Failed to handle message: tried to modify an old resource arn:aws:iam::139614369439:instance-profile/test_profile_ecs, but it doesn't exist.
2021-06-06 12:31:58,793 - INFO - adding message to failed events queue for retry
2021-06-06 12:31:59,012 - INFO - User N/A (APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)) performed DeleteRole in us-east-1 at 2021-06-06T09:27:47Z, account_id: 139614369439, extra:{'eventVersion': '1.08', 'userIdentity': {'type': 'Root', 'principalId': '139614369439', 'arn': 'arn:aws:iam::139614369439:root', 'accountId': '139614369439', 'accessKeyId': 'AKIAJJEVIV4HXY2LBE7Q'}, 'eventTime': '2021-06-06T09:27:47Z', 'eventSource': 'iam.amazonaws.com', 'eventName': 'DeleteRole', 'awsRegion': 'us-east-1', 'sourceIPAddress': '82.114.46.103', 'userAgent': 'APN/1.0 HashiCorp/1.0 Terraform/0.14.2 (+https://www.terraform.io) terraform-provider-aws/dev (+https://registry.terraform.io/providers/hashicorp/aws) aws-sdk-go/1.38.29 (go1.16; windows; amd64)', 'requestParameters': {'roleName': 'test_role_ecs'}, 'responseElements': None, 'requestID': '265627c9-961c-45d4-8b45-a51cae36d2cd', 'eventID': '64688c05-ead1-48c9-b3c3-65a00b8d0b42', 'readOnly': False, 'eventType': 'AwsApiCall', 'managementEvent': True, 'recipientAccountId': '139614369439', 'eventCategory': 'Management'}
2021-06-06 12:31:59,013 - INFO - delete iam_role - ['arn:aws:iam::139614369439:role/test_role_ecs']
2021-06-06 12:31:59,013 - INFO - Scanning account/region 139614369439/Global, filter: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_ecs']}]}}}
2021-06-06 12:32:00,114 - INFO - scanned resources: {}
2021-06-06 12:32:00,114 - WARNING - no resources returned by scan 139614369439/Global: {'resources': {'iam_role': {'filters': [{'name': 'RoleName', 'values': ['test_role_ecs']}]}}}
2021-06-06 12:32:00,136 - INFO - Get previous translated snapshot with timestamp 1622971914867 took 0.02 seconds
2021-06-06 12:32:00,138 - INFO - Classified snapshot: {'139614369439': {'Global': {'created': {}, 'modified': {}, 'deleted': {'iam_role': [{'Arn': 'arn:aws:iam::139614369439:role/test_role_ecs', 'Path': '/', 'RoleId': 'AROASBANKG2PWKCFXY3QR', 'RoleName': 'test_role_ecs', 'resource_id': 'arn:aws:iam::139614369439:role/test_role_ecs'}]}}, 'us-east-1': {'created': {}, 'modified': {}, 'deleted': {}}}, 'previous_timestamp': 1622971914867}
2021-06-06 12:32:00,187 - INFO - Calling modeler on-new-snapshot for timestamp 1622971920114 ...
2021-06-06 12:32:00,237 - INFO - Calling analyzer for timestamp 1622971920114 ...
2021-06-06 12:32:03,122 - INFO - timestamp updated successfully in db after 1 tries, with 150 milliseconds sleep interval
2021-06-06 12:32:03,122 - INFO - Finished triggering everything for timestamp 1622971920114 after 2.97 seconds! times: [('store_ct_event', 0.01), ('store_sub_events', 0.01), ('store_trans', 0.01), ('store_classified', 0.01), ('set_complete', 0.01), ('validate_timestamp', 0.01), ('modeler', 0.05), ('analyzer', 2.86)]